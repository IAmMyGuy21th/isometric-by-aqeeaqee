{"entries":[{"timestamp":1762280799681,"editorVersion":"2.0.61","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":250,"length1":1667,"diffs":[[1,"const tm = tiles.createTilemap(hex`1000100003040506070102010201020102010201010201020102010201020102010201020201020102010201020102010201020101020102010201020102010201020102020102010201020102010201020102010102010201020102010201020102010202010201020102010201020102010201010201020102010201020102010201020201020102010201020102010201020101020102010201020102010201020102020102010201020102010201020102010102010201020102010201020102010202010201020102010201020102010201010201020102010201020102010201020201020102010201020102010201020101020102010201020102010201020102`, img`\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . 2 2 2 2 . . 2 2 2 2 . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . 2 2 2 2 . . 2 2 2 2 . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n"]]},{"start1":1888,"length1":50,"diffs":[[1,"// effects.blizzard.startScreenEffect(99999999, 99)\n"]]}]},{"type":"edited","filename":"tilemap.g.jres","patch":[{"start1":1611,"length1":327,"diffs":[[1,""]]},{"start1":1699,"length1":2084,"diffs":[[1,"        \"data\": \"MTAxMDAwMTAwMDAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwOTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwOTA5MDEwMTA5MDUwMjAyMDIwMjA0MDQwMjAyMDIwMjA2MDkwMTAxMDkwMzA5MDkwOTA5MDMwMzA5MDkwOTA5MDMwOTAxMDEwOTAzMDkwMTAxMDEwMzAzMDEwMTAxMDkwMzA5MDEwMTA5MDMwOTAxMDkwOTAzMDMwOTA5MDEwOTAzMDkwMTAxMDkwMzA5MDEwOTA5MDMwMzA5MDkwMTA5MDMwOTAxMDEwOTA4MDIwMjAyMDIwNzA4MDIwMjAyMDIwNzA5MDEwMTA5MDUwMjAyMDIwMjA2MDUwMjAyMDIwMjA2MDkwMTAxMDkwMzA5MDEwOTA5MDMwMzA5MDkwMTA5MDMwOTAxMDEwOTAzMDkwMTA5MDkwMzAzMDkwOTAxMDkwMzA5MDEwMTA5MDMwOTAxMDEwMTAzMDMwMTAxMDEwOTAzMDkwMTAxMDkwMzA5MDkwOTA5MDMwMzA5MDkwOTA5MDMwOTAxMDEwOTA4MDIwMjAyMDIwNzA4MDIwMjAyMDIwNzA5MDEwMTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMjIyMjIyMjIyMjIyMjIyMjAyMDAwMDAwMDAwMDAwMjAwMjAwMDAwMDAwMDAwMDIwMDIwMDAwMDAwMDAwMDAyMDAyMDAyMjAyMjAyMjAwMjAwMjAwMDIwMDAwMjAwMDIwMDIwMDAyMDAwMDIwMDAyMDAyMDAwMDAwMDAwMDAwMjAwMjAwMDAwMDAwMDAwMDIwMDIwMDAyMDAwMDIwMDAyMDAyMDAwMjAwMDAyMDAwMjAwMjAwMjIwMjIwMjIwMDIwMDIwMDAwMDAwMDAwMDAyMDAyMDAwMDAwMDAwMDAwMjAwMjAwMDAwMDAwMDAwMDIwMjIyMjIyMjIyMjIyMjIyMg==\",\n"]]},{"start1":3158,"length1":109,"diffs":[[1,"            \"sprites.castle.tileDarkGrass3\"\n"]]}]},{"type":"edited","filename":"tilemap.g.ts","patch":[{"start1":576,"length1":102,"diffs":[[1,""]]},{"start1":712,"length1":1959,"diffs":[[1,"            case \"level1\":return tiles.createTilemap(hex`1000100001010101010101010101010101010101010909090909090909090909090909010109050202020204040202020206090101090309090909030309090909030901010903090101010303010101090309010109030901090903030909010903090101090309010909030309090109030901010908020202020708020202020709010109050202020206050202020206090101090309010909030309090109030901010903090109090303090901090309010109030901010103030101010903090101090309090909030309090909030901010908020202020708020202020709010109090909090909090909090909090101010101010101010101010101010101`, img`\n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . 2 2 2 . . 2 2 2 . . . 2 \n2 . . . 2 . . . . . . 2 . . . 2 \n2 . . . 2 . . . . . . 2 . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . 2 . . . . . . 2 . . . 2 \n2 . . . 2 . . . . . . 2 . . . 2 \n2 . . . 2 2 2 . . 2 2 2 . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n`, [myTiles.transparency16,sprites.builtin.brick,sprites.vehicle.roadHorizontal,sprites.vehicle.roadVertical,sprites.vehicle.roadIntersection3,sprites.vehicle.roadTurn1,sprites.vehicle.roadTurn2,sprites.vehicle.roadTurn4,sprites.vehicle.roadTurn3,sprites.castle.tileDarkGrass3], TileScale.Sixteen);\n"]]},{"start1":2592,"length1":67,"diffs":[[1,""]]}]}]},{"timestamp":1762281398332,"editorVersion":"2.0.61","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":2350,"length1":26,"diffs":[[1,""]]},{"start1":2467,"length1":8,"diffs":[[1,""]]}]}]},{"timestamp":1762281990238,"editorVersion":"2.0.61","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":2493,"length1":0,"diffs":[[1,"scene.\n\n"]]}]}]},{"timestamp":1762282893702,"editorVersion":"2.0.61","changes":[{"type":"edited","filename":"pxt.json","patch":[{"start1":1062,"length1":65,"diffs":[[1,"        \"docs/set-sprite-attribute.md\"\n"]]}]},{"type":"added","filename":"main.blocks.ts","value":""}]},{"timestamp":1762282895353,"editorVersion":"2.0.61","changes":[{"type":"edited","filename":"pxt.json","patch":[{"start1":1062,"length1":39,"diffs":[[1,"        \"docs/set-sprite-attribute.md\",\n        \"main.blocks.ts\"\n"]]},{"start1":1247,"length1":41,"diffs":[[1,"        \"images.g.ts\"\n"]]}]},{"type":"removed","filename":"main.blocks.ts","value":""},{"type":"added","filename":"test.ts","value":"// tests go here; this will not be compiled when this package is used as an extension.\n"},{"type":"added","filename":"main.blocks","value":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <variables></variables>\n  <block type=\"pxt-on-start\" x=\"0\" y=\"0\"></block>\n</xml>"}]}],"snapshots":[{"timestamp":1762280614623,"editorVersion":"2.0.61","text":{"README.md":"(Discuss on Makecode Arcade forum at: \n[Raycasting 3D render with directional animation sprites](https://forum.makecode.com/t/raycasting-3d-render-blocks-edition/12921/) )\n\n## Brief:\nAn extension for Makecode Arcade, render a tilemap into 2.5D view, a kind of less calculation consuming 3D perspective view, with directional animations of sprites, \nbased on mmoskal's [3d map](https://forum.makecode.com/t/3d-raycasting-in-arcade/474)\n\n## Quick Start\n* Basically, this render just draw a traditional tilemap game into \"3D view\"\n* setTilemap(), walk around with arrow keys\n* Do your game as usual\n    * sprites, suggest sprite.setScale(0.5) for each, set directional animations with provided animation block.\n    * work together with most of Arcade blocks and extensions, sprite, projectile, overlap,...\n    * except these drawing screen directly, sprite effects ...\n* Operate view pos and collision size with provided \"myself sprite\", and view direction with \"setViewAngle\" block\n* Switch view mode with block \"setViewMode to tilemap(2D)/raycasting(3D)\"\n* Zoom in/out by set fov\n\n## Features:\n* Switch Tilemap(original 2D)/Raycasting(3D by default) view mode with provided \"set mode\" block\n    * The Tilemap mode, basically rendered all stuff via original Arcade functions, so should works as usual\n* Work together with most exsiting Arcade blocks:\n    * Tilemap: Tilemap designer, all blocks: Place sprite on a specific/random tile, ...\n    * Sprite: Manipulate sprite the same way in other tilemap prj before, with almost all blocks:\n        * set image,position,speed, acceleration, scale, kind, follow, detroy, ... \n        * note, one-tile size sprite and wall are disproportionate in 3D view, so suggest shrink to 0.5 or less by setScale(), or set small images for sprites.\n        * except z (diff from 3D world)\n        * except funtions drawing screen directly(effects, say)\n    * Projectile: all, except creating from side(side in 3D is diff from 2D)\n    * Arcade physical engine: wall, bounce, overlap events, ... (see known issues)\n* Predefined \"myself\" Sprite, for physical events in your code, kind=player, camera followed by default. Operate it as of an ordinary sprits, except can't see it in 3D view.\n* Porvide a block for set directional animations of sprite, with the Arcade out-of-box animation editor. Max 4 directions by now, but can be any count, let me know if you need more.\n* Porvide a event handler block running codes when direction between myself and sprite changed, can work together with out-of-box Animation blocks and richard Character Animation extension.\n* FOV(field of view), zoom in/out, by change \"fov\" property value\n* Mimimap, removed, cause we have real-size and real-time tilemap already. Let me know if you need.\n* The offsetZ for sprite, for floating effect, only worked when rendering in 3D view, so collisions could happen even they are far away at Z axis in 3D view\n* Porvide jump/move with height&duration parameters for sprites, calculate velocity and acceleration value auto.\n* Support original Spirte.sayText(), scaled with sprites together\n* Other incompatible: splash/showLongText, they can work, but transparent part is empty, which should be rendered 3D view.\n\n## Known issues:\n* Performing: To compactible with existing blocks, many codes are added in, the perf goes down significantly, need tuning later.\n* The Arcade phyical engine worked fine if sprite image is square. But if not, say a tall tree, collision will occured before hit the wall at y axis. \n    * Reason: The physical engine working in 2D mode, that consider sprite image as its size(x&y direction). But 3D render consider the image width as size for both x & y axises, height as sprite Z-axis size. This could be fix by override the physical engine, in future, if needed.\n\n## Todo:\n* Particles Effects\n* Override physic engine. Any one need?\n* Pose depended animations, stand, walk, attack. Any one need?\n* Perf tuning, Fx8\n* Tutorial\n\n\n----\n> Open this page at [https://aqeeaqee.github.io/pxt-raycasting/](https://aqeeaqee.github.io/pxt-raycasting/)\n\n## Use as Extension\n\nThis repository can be added as an **extension** in MakeCode.\n\n* open [https://arcade.makecode.com/](https://arcade.makecode.com/)\n* click on **New Project**\n* click on **Extensions** under the gearwheel menu\n* search for **https://github.com/aqeeaqee/pxt-raycasting** and import\n\n## Edit this project ![Build status badge](https://github.com/aqeeaqee/pxt-raycasting/workflows/MakeCode/badge.svg)\n\nTo edit this repository in MakeCode.\n\n* open [https://arcade.makecode.com/](https://arcade.makecode.com/)\n* click on **Import** then click on **Import URL**\n* paste **https://github.com/aqeeaqee/pxt-raycasting** and click import\n\n## Blocks preview\n\nThis image shows the blocks code from the last commit in master.\nThis image may take a few minutes to refresh.\n\n\\![A rendered view of the blocks](https://github.com/aqeeaqee/pxt-raycasting/raw/master/.github/makecode/blocks.png)\n\n#### Metadata (used for search, rendering)\n\n* for PXT/arcade\n<script src=\"https://makecode.com/gh-pages-embed.js\"></script><script>makeCodeRender(\"{{ site.makecode.home_url }}\", \"{{ site.github.owner_name }}/{{ site.github.repository_name }}\");</script>\n","render_raycasting.ts":"namespace userconfig {\n    export const ARCADE_SCREEN_WIDTH =  320\n    export const ARCADE_SCREEN_HEIGHT = 240\n}\n\n//% shim=pxt::updateScreen\nfunction updateScreen(img: Image) { }\n\nenum ViewMode {\n    //% block=\"TileMap Mode\"\n    tilemapView,\n    //% block=\"Isometric Mode\"\n    isometricView,\n}\n\n\n\nnamespace Render {\n    const SH = screen.height, SHHalf = SH / 2\n    const SW = screen.width, SWHalf = SW / 2\n    export const fpx = 8\n    const fpx2=fpx*2\n    const fpx2_4 = fpx2 - 4\n    const fpx_scale = 2 ** fpx\n    export function tofpx(n: number) { return (n * fpx_scale) | 0 }\n    const one = 1 << fpx\n    const one2 = 1 << (fpx + fpx)\n    const FPX_MAX = (1 << fpx) - 1\n\n    //for Isometric\n    const ScreenCenterX = screen.width >> 1, ScreenCenterY = screen.height * 3 >> 2\n    const TileMapScale = 4, TileSize = 1 << TileMapScale, HalfTileSize = TileSize >> 1\n    let TileImgScale = 4, HalfTileImgScale = TileImgScale / 2 ///>> 1\n    let TileImgScaleX = TileImgScale, TileImgScaleY = 2 //16x16 Rotate&Scale to 64x64, then shrink to 64x32\n    const IsConsole = control.ramSize() < 1024 * 1024, Max_TileImgScaleX = 4, Max_TileImgScaleY = IsConsole ? 2 : 4\n    let Scale = TileImgScale / Math.SQRT2, Scale_Square = TileImgScale ** 2 / 2 // = Scale**2 //8 // =\n    let WallScale = HalfTileImgScale, WallHeight = TileSize * WallScale\n    const X0 = TileSize >> 1, Y0 = X0\n    let H = X0 - TileSize * HalfTileImgScale, V = Y0 - TileSize * HalfTileImgScale\n    let AD_BC_Fpx2 = (one2 / Scale_Square) | 0 //= (Math.SQRT1_2/2)**2 == (A * D - B * C)\n    let A_Fpx = 0\n    let B_Fpx = 0\n\n    export function changeScale(delta: number){\n        setScale(TileImgScale + delta * 0.5)\n    }\n\n    function setScale(value: number){\n        const ratio = TileImgScale / TileImgScaleY\n        TileImgScale = Math.clamp(1, 4, value)\n        setScaleY(TileImgScale / ratio)\n\n        info.player3.setScore(TileImgScale*100)\n        HalfTileImgScale = TileImgScale / 2 ///>> 1\n        TileImgScaleX = TileImgScale\n        Scale = TileImgScale / Math.SQRT2, Scale_Square = TileImgScale ** 2 / 2\n        WallHeight = TileSize * HalfTileImgScale\n        H = X0 - TileSize * HalfTileImgScale, V = Y0 - TileSize * HalfTileImgScale\n        AD_BC_Fpx2 = (one2 / Scale_Square) | 0\n        raycastingRender.lastRenderAngle=-1 // force refresh\n    }\n\n    export function changeScaleY(delta:number){\n        setScaleY(TileImgScaleY + delta /8)\n    }\n    \n    function setScaleY(value: number){\n        TileImgScaleY = Math.clamp(1 / 8, TileImgScaleX / (IsConsole && TileImgScaleX > 2 ? 2 : 1), value)\n        info.player4.setScore(TileImgScaleY*100)\n        raycastingRender.lastRenderAngle = -1 // force refresh\n    }\n\n    function rotatePoint(xIn: number, yIn: number, A_Fpx:number, B_Fpx:number) {\n        const D_Fpx = A_Fpx, C_Fpx = -B_Fpx\n        let xOut = ((D_Fpx * (xIn - X0) - B_Fpx * (yIn - Y0)) << fpx) / AD_BC_Fpx2 - (H - X0)\n        let yOut = -((C_Fpx * (xIn - X0) - A_Fpx * (yIn - Y0)) << fpx) / AD_BC_Fpx2 - (V - Y0)\n        return { x: (xOut | 0), y: yOut / (TileImgScaleX / TileImgScaleY) }\n    }\n\n    class MotionSet1D {\n        p: number\n        v: number = 0\n        a: number = 0\n        constructor(public offset: number) {\n            this.p = offset\n        }\n    }\n\n    export const defaultFov = SW / SH / 2  //Wall just fill screen height when standing 1 tile away\n\n    export class RayCastingRender{\n\n        private tempScreen: Image = screen // image.create(SW, SH)\n        private tempBackground: scene.BackgroundLayer //for \"see through\" when scene popped out\n\n        velocityAngle: number = 2\n        velocity: number = 3\n        protected _viewMode=ViewMode.isometricView\n        protected dirXFpx: number\n        protected dirYFpx: number\n        protected planeX: number\n        protected planeY: number\n        protected _angle: number\n        protected _fov: number\n        protected _wallZScale: number = 1\n        cameraSway = 0\n        protected isWalking=false\n        protected cameraOffsetX = 0\n        protected cameraOffsetZ_fpx = 0\n\n        //sprites & accessories\n        sprSelf: Sprite\n        sprites: Sprite[] = []\n        sprites2D: Sprite[] = []\n        spriteParticles: particles.ParticleSource[] = []\n        spriteLikes: SpriteLike[] = []\n        spriteAnimations: Animations[] = []\n        protected spriteMotionZ: MotionSet1D[] = []\n        protected sayRederers: sprites.BaseSpriteSayRenderer[] = []\n        protected sayEndTimes: number[] = []\n\n        //reference\n        protected tilemapScale = TileScale.Sixteen\n        protected tilemapScaleSize = 1 << TileScale.Sixteen\n        map: tiles.TileMapData\n        mapData:Array<number>\n        bg: Image\n        textures: Image[]\n        protected oldRender: scene.Renderable\n        protected myRender: scene.Renderable\n\n        //render\n\n        //render perf const\n        viewZPos:number\n        viewXFpx:number\n        viewYFpx:number\n\n        //for drawing sprites\n        protected invDet: number //required for correct matrix multiplication\n        camera: scene.Camera\n        tempSprite: Sprite = sprites.create(img`0`)\n        protected transformX: number[] = []\n        protected transformY: number[] = []\n        protected angleSelfToSpr: number[] = []\n\n        onSpriteDirectionUpdateHandler: (spr: Sprite, dir: number) => void\n\n        get xFpx(): number {\n            return Fx.add(this.sprSelf._x, Fx.div(this.sprSelf._width, Fx.twoFx8)) as any as number / this.tilemapScaleSize\n        }\n\n        // set xFpx(v: number) {\n        //     this.sprSelf._x = v * this.tilemapScaleSize as any as Fx8\n        // }\n\n        get yFpx(): number {\n            return Fx.add(this.sprSelf._y, Fx.div(this.sprSelf._height, Fx.twoFx8)) as any as number / this.tilemapScaleSize\n        }\n\n        // set yFpx(v: number) {\n        //     this.sprSelf._y = v * this.tilemapScaleSize as any as Fx8\n        // }\n\n        get dirX(): number {\n            return this.dirXFpx / fpx_scale\n        }\n\n        get dirY(): number {\n            return this.dirYFpx / fpx_scale\n        }\n\n        set dirX(v: number) {\n            this.dirXFpx = v * fpx_scale\n        }\n\n        set dirY(v: number) {\n            this.dirYFpx = v * fpx_scale\n        }\n\n        sprXFx8(spr: Sprite) {\n            return Fx.add(spr._x, Fx.div(spr._width, Fx.twoFx8)) as any as number / this.tilemapScaleSize\n        }\n\n        sprYFx8(spr: Sprite) {\n            return Fx.add(spr._y, Fx.div(spr._height, Fx.twoFx8)) as any as number / this.tilemapScaleSize\n        }\n\n        get fov(): number {\n            return this._fov\n        }\n\n        set fov(fov: number) {\n            this._fov = fov\n            this.setVectors()\n        }\n\n        get viewAngle(): number {\n            return this._angle\n        }\n        set viewAngle(angle: number) {\n            this._angle = angle\n            this.setVectors()\n            // this.updateSelfImage()\n        }\n\n        get wallZScale(): number {\n            return this._wallZScale\n        }\n        set wallZScale(v: number) {\n            this._wallZScale = v\n        }\n\n        getMotionZ(spr: Sprite, offsetZ: number = 0) {\n            let motionZ = this.spriteMotionZ[spr.id]\n            if (!motionZ) {\n                motionZ = new MotionSet1D(tofpx(offsetZ))\n                this.spriteMotionZ[spr.id] = motionZ\n            }\n            return motionZ\n        }\n\n        getZOffset(spr: Sprite) {\n            return this.getMotionZ(spr).offset / fpx_scale\n        }\n\n        setZOffset(spr: Sprite, offsetZ: number, duration: number = 500) {\n            const motionZ = this.getMotionZ(spr, offsetZ)\n\n            motionZ.offset = tofpx(offsetZ)\n            if (motionZ.p != motionZ.offset) {\n                if (duration === 0)\n                    motionZ.p = motionZ.offset\n                else if(motionZ.v==0)\n                    this.move(spr, (motionZ.offset - motionZ.p) / fpx_scale * 1000 / duration, 0)\n            }\n        }\n\n        getMotionZPosition(spr: Sprite) {\n            return this.getMotionZ(spr).p / fpx_scale\n        }\n\n        //todo, use ZHeight(set from sprite.Height when takeover, then sprite.Height will be replace with width)\n        isOverlapZ(sprite1: Sprite, sprite2: Sprite): boolean {\n            const p1 = this.getMotionZPosition(sprite1)\n            const p2 = this.getMotionZPosition(sprite2)\n            if (p1 < p2) {\n                if (p1 + sprite1.height > p2) return true\n            } else {\n                if (p2 + sprite2.height > p1) return true\n            }\n            return false\n        }\n\n        move(spr: Sprite, v: number, a: number) {\n            const motionZ = this.getMotionZ(spr)\n\n            motionZ.v = tofpx(v)\n            motionZ.a = tofpx(a)\n        }\n\n        jump(spr: Sprite, v: number, a: number) {\n            const motionZ = this.getMotionZ(spr)\n            let floorHeight = motionZ.offset\n            if (tiles.tileAtLocationIsWall(spr.tilemapLocation()))\n                floorHeight += TileSize << fpx\n\n            if (motionZ.p != floorHeight)\n                return\n\n            motionZ.v = tofpx(v)\n            motionZ.a = tofpx(a)\n        }\n\n        jumpWithHeightAndDuration(spr: Sprite, height: number, duration: number) {\n            const motionZ = this.getMotionZ(spr)\n            let floorHeight = motionZ.offset\n            if (tiles.tileAtLocationIsWall(spr.tilemapLocation()))\n                floorHeight += TileSize << fpx\n\n            if (motionZ.p != floorHeight)\n                return\n\n            // height= -v*v/a/2\n            // duration = -v/a*2 *1000\n            const v = height * 4000 / duration\n            const a = -v * 2000 / duration\n            motionZ.v = tofpx(v)\n            motionZ.a = tofpx(a)\n        }\n\n        get viewMode(): ViewMode {\n            return this._viewMode\n        }\n\n        set viewMode(v: ViewMode) {\n            this._viewMode = v\n        }\n\n        updateViewZPos() {\n            this.viewZPos = this.spriteMotionZ[this.sprSelf.id].p + (this.sprSelf._height as any as number) - (2 << fpx)\n        }\n\n        takeoverSceneSprites() {\n            const sc_allSprites = game.currentScene().allSprites\n            for (let i=0;i<sc_allSprites.length;) {\n                const spr=sc_allSprites[i]\n                if (spr instanceof Sprite) {\n                    const sprList = (spr.flags & sprites.Flag.RelativeToCamera) ? this.sprites2D:this.sprites\n                    if (sprList.indexOf(spr) < 0) {\n                        sprList.push(spr as Sprite)\n                        this.getMotionZ(spr, 0)\n                        spr.onDestroyed(() => {\n                            this.sprites.removeElement(spr as Sprite)   //can be in one of 2 lists\n                            this.sprites2D.removeElement(spr as Sprite) //can be in one of 2 lists\n                            const sayRenderer = this.sayRederers[spr.id]\n                            if (sayRenderer) {\n                                this.sayRederers.removeElement(sayRenderer)\n                                sayRenderer.destroy()\n                            }\n                        })\n                    }\n                } else if(spr instanceof particles.ParticleSource){\n                    const particle = (spr as particles.ParticleSource)\n                    if (this.spriteParticles.indexOf(particle) < 0 && particle.anchor instanceof Sprite) {\n                        const spr = (particle.anchor as Sprite)\n                        if(this.sprites.indexOf(spr)>=0){\n                            this.spriteParticles[spr.id]=particle\n                            particle.anchor= {x:0,y:0}\n                        }\n                    }\n                } else {\n                    if (this.spriteLikes.indexOf(spr) < 0)\n                        this.spriteLikes.push(spr)\n                }\n                sc_allSprites.removeElement(spr)\n            }\n            this.sprites.forEach((spr) => {\n                if (spr)\n                    this.takeoverSayRenderOfSprite(spr)\n            })\n        }\n        takeoverSayRenderOfSprite(sprite: Sprite) {\n            const sprite_as_any = (sprite as any)\n            if (sprite_as_any.sayRenderer) {\n                this.sayRederers[sprite.id] = sprite_as_any.sayRenderer\n                this.sayEndTimes[sprite.id] = sprite_as_any.sayEndTime;\n                sprite_as_any.sayRenderer = undefined\n                sprite_as_any.sayEndTime = undefined\n            }\n        }\n\n        tilemapLoaded() {\n            const sc = game.currentScene()\n            this.map = sc.tileMap.data\n            this.mapData = ((this.map as any).data as Buffer).toArray(NumberFormat.Int8LE)\n            this.tilemapScaleSize = 1 << sc.tileMap.data.scale\n            this.textures = sc.tileMap.data.getTileset()\n            this.oldRender = sc.tileMap.renderable\n            this.spriteLikes.removeElement(this.oldRender)\n            sc.allSprites.removeElement(this.oldRender)\n\n            let frameCallback_update = sc.eventContext.registerFrameHandler(scene.PRE_RENDER_UPDATE_PRIORITY + 1, () => {\n                const dt = sc.eventContext.deltaTime;\n                // sc.camera.update();  // already did in scene\n                for (const s of this.sprites)\n                    s.__update(sc.camera, dt);\n                this.sprSelf.__update(sc.camera, dt)\n            })\n\n            let frameCallback_draw = sc.eventContext.registerFrameHandler(scene.RENDER_SPRITES_PRIORITY + 1, () => {\n                if (this._viewMode == ViewMode.isometricView) {\n                    if (!this.tempBackground) {\n                        this.tempScreen.drawImage(game.currentScene().background.image, 0, 0)\n                        this.render()\n                        // screen.fill(0)\n                        this.sprites2D.forEach(spr => spr.__draw(sc.camera))\n                        this.spriteLikes.forEach(spr => spr.__draw(sc.camera))\n                        // this.tempScreen.drawTransparentImage(screen, 0, 0)\n                    }\n                } else {\n                    screen.drawImage(game.currentScene().background.image, 0, 0)\n                    this.oldRender.__drawCore(sc.camera)\n                    this.sprites.forEach(spr => spr.__draw(sc.camera))\n                    this.sprSelf.__draw(sc.camera)\n                    this.sprites2D.forEach(spr => spr.__draw(sc.camera))\n                    this.spriteLikes.forEach(spr => spr.__draw(sc.camera))\n                }\n            })\n\n            sc.tileMap.addEventListener(tiles.TileMapEvent.Unloaded, data => {\n                sc.eventContext.unregisterFrameHandler(frameCallback_update)\n                sc.eventContext.unregisterFrameHandler(frameCallback_draw)\n            })\n        }\n\n        constructor() {\n            this._angle = Math.PI/4\n            this.fov = defaultFov\n            this.camera = new scene.Camera()\n\n            const sc = game.currentScene()\n            if (!sc.tileMap) {\n                sc.tileMap = new tiles.TileMap();\n            } else {\n                this.tilemapLoaded()\n            }\n            game.currentScene().tileMap.addEventListener(tiles.TileMapEvent.Loaded, data => this.tilemapLoaded())\n\n            //self sprite\n            this.sprSelf = sprites.create(image.create(this.tilemapScaleSize >> 1, this.tilemapScaleSize >> 1), SpriteKind.Player)\n            this.sprSelf.setImage(sprites.castle.heroWalkBack1)\n            this.sprSelf.scale=0.5\n            this.takeoverSceneSprites()\n            // this.sprites.removeElement(this.sprSelf)\n            this.updateViewZPos()\n            scene.cameraFollowSprite(this.sprSelf) //prevent projectiles from AutoDestroy \n            // this.updateSelfImage()\n\n            game.onUpdate(function () {\n                this.updateControls()\n                this.updateSprite()\n            })\n\n            game.onUpdateInterval(400, ()=>{\n                for (let i = 0; i < this.sprites.length;) {\n                    const spr = this.sprites[i]\n                    if (spr.flags & sprites.Flag.RelativeToCamera) {\n                        this.sprites.removeElement(spr)\n                        this.sprites2D.push(spr)\n                    } else {i++}\n                }\n                for (let i = 0; i < this.sprites2D.length;) {\n                    const spr = this.sprites2D[i]\n                    if (!(spr.flags & sprites.Flag.RelativeToCamera)) {\n                        this.sprites2D.removeElement(spr)\n                        this.sprites.push(spr)\n                    } else {i++}\n                }\n                this.takeoverSceneSprites() // in case some one new\n            })\n\n\n//            game.onUpdateInterval(25, () => {\n//                if(this.cameraSway&&this.isWalking){\n//                    this.cameraOffsetX = (Math.sin(control.millis() / 150) * this.cameraSway * 3)|0\n//                    this.cameraOffsetZ_fpx = tofpx(Math.cos(control.millis() / 75) * this.cameraSway)|0\n//                }\n//            });\n\n//            control.__screen.setupUpdate(() => {\n//                if(this.viewMode==ViewMode.isometricView)\n//                    updateScreen(this.tempScreen)\n//                else\n//                    updateScreen(screen)\n//            })\n\n            game.addScenePushHandler((oldScene) => {\n                this.tempBackground = oldScene.background.addLayer(this.tempScreen, 0, BackgroundAlignment.Center)\n                control.__screen.setupUpdate(() => { updateScreen(screen) })\n            })\n            game.addScenePopHandler((oldScene) => {\n                ((oldScene.background as any)._layers as scene.BackgroundLayer[]).removeElement(this.tempBackground)\n                this.tempBackground=undefined\n                control.__screen.setupUpdate(() => {\n                    if (this.viewMode == ViewMode.isometricView)\n                        updateScreen(this.tempScreen)\n                    else\n                        updateScreen(screen)\n                })\n            })\n        }\n\n        private setVectors() {\n            const sin = Math.sin(this._angle)\n            const cos = Math.cos(this._angle)\n            this.dirXFpx = tofpx(cos)\n            this.dirYFpx = tofpx(sin)\n            this.planeX = tofpx(sin * this._fov)\n            this.planeY = tofpx(cos * -this._fov)\n        }\n\n        //todo, pre-drawn dirctional image\n        public updateSelfImage() {\n            const img = this.sprSelf.image\n            img.fill(6)\n            const arrowLength = img.width / 2\n            img.drawLine(arrowLength, arrowLength, arrowLength + this.dirX * arrowLength, arrowLength + this.dirY * arrowLength, 2)\n            img.fillRect(arrowLength - 1, arrowLength - 1, 2, 2, 2)\n        }\n\n        updateControls() {\n            if (this.velocityAngle !== 0) {\n                const dx = controller.dx(this.velocityAngle)\n                if (dx) {\n                    this.viewAngle += dx\n                }\n            }\n            if (this.velocity !== 0) {\n                this.isWalking=true\n                const dy = controller.dy(this.velocity)\n                if (dy) {\n                    const nx = this.xFpx - Math.round(this.dirXFpx * dy)\n                    const ny = this.yFpx - Math.round(this.dirYFpx * dy)\n                    this.sprSelf.setPosition((nx * this.tilemapScaleSize / fpx_scale), (ny * this.tilemapScaleSize / fpx_scale))\n                }else{\n                    this.isWalking =false\n                }\n            }\n        }\n\n        updateSprite(){\n            const dt = game.eventContext().deltaTime\n            for (const spr of this.sprites) {\n                this.updateMotionZ(spr, dt)\n            }\n            this.updateMotionZ(this.sprSelf, dt)\n        }\n\n        updateMotionZ(spr:Sprite, dt:number){\n            const motionZ = this.spriteMotionZ[spr.id]\n            //if (!motionZ) continue\n\n            let floorHeight = motionZ.offset\n            if(tiles.tileAtLocationIsWall(spr.tilemapLocation()))\n                floorHeight += TileSize <<fpx\n            if (motionZ.v != 0 || motionZ.p != floorHeight) {\n                motionZ.v += motionZ.a * dt, motionZ.p += motionZ.v * dt\n                //landing\n                if ((motionZ.a >= 0 && motionZ.v > 0 && motionZ.p >= floorHeight) ||\n                    (motionZ.a <= 0 && motionZ.v < 0 && motionZ.p <= floorHeight)) { motionZ.p = floorHeight, motionZ.v = 0 }\n                if(spr===this.sprSelf)\n                    this.updateViewZPos()\n            }\n            if (spr === this.sprSelf){\n                const isLevel2 = motionZ.p >= (TileSize << fpx)\n                spr.setFlag(SpriteFlag.Ghost, isLevel2)\n                spr.layer = isLevel2 ? 2 : 1\n            }\n        }\n\n        rotateAll(inImgs: Image[], A_Fpx: number, B_Fpx: number) {\n            // let ms=0\n\n            // this.corners[0].x = 999\n            // this.corners[2].x = -999\n            // this.corners[1].y = -999\n\n            let D_Fpx =  A_Fpx\n            let C_Fpx = -B_Fpx\n            let xIn0_FX = (A_Fpx * (H - X0)) + (B_Fpx * (V - Y0)) + (X0 << fpx)\n            let yIn0_FX = (C_Fpx * (H - X0)) + (D_Fpx * (V - Y0)) + (Y0 << fpx)\n            // B_Fpx <<= 1 // skip 1 every 1, shrink to 64x32\n            // D_Fpx <<= 1 // ...\n            B_Fpx *= (TileImgScaleX/TileImgScaleY) // skip 1 every 1, shrink to 64x32\n            D_Fpx *= (TileImgScaleX/TileImgScaleY) // ...\n            const TileSize_Fpx = TileSize << fpx\n\n            for (let xOut = 0; xOut < TileSize * TileImgScaleX; xOut++) {\n                let xIn_FX = xIn0_FX\n                let yIn_FX = yIn0_FX\n                for (let yOut = 0; yOut < TileSize * TileImgScaleY; yOut++) {\n                    if (0 <= xIn_FX && xIn_FX < TileSize_Fpx && 0 <= yIn_FX && yIn_FX < TileSize_Fpx) {\n                        const xIn = xIn_FX >> fpx\n                        const yIn = yIn_FX >> fpx\n                        for (let i = 1; i < inImgs.length; i++) {\n                            const c = inImgs[i].getPixel(xIn, yIn)\n                            this.rotatedTiles[i].setPixel(xOut, yOut, c)\n                        }\n\n                        // ms+=control.benchmark(()=>{ //<3ms totally on Meowbit\n                        if (false && (0 === xIn || xIn === TileSize - 1) && (0 === yIn || yIn === TileSize - 1)){\n                            // console.log([xIn, yIn, xOut, yOut].join())\n                            if (xOut < this.corners[0].x) { this.corners[0].x = xOut; this.corners[0].y = yOut; }\n                            else if (xOut === this.corners[0].x && yOut > this.corners[0].y) { this.corners[0].y = yOut; }\n                            else if (xOut+1 > this.corners[2].x) {this.corners[2].x = xOut +1; this.corners[2].y = yOut; }\n                            else if (xOut+1 === this.corners[2].x && yOut > this.corners[2].y) { this.corners[2].y = yOut; }\n                            if (yOut > this.corners[1].y) { this.corners[1].x = xOut; this.corners[1].y = yOut; }\n                        }\n                        // }); \n                    }\n                    xIn_FX += B_Fpx \n                    yIn_FX += D_Fpx \n                }\n                xIn0_FX += A_Fpx\n                yIn0_FX += C_Fpx\n            }\n            // info.player2.setScore(ms)\n        }\n\n        shearDoubleX(inImg: Image, degree: number, i = 0){\n            //fix 45Â°\n            const size = Math.max(inImg.width, inImg.height)\n            const outImg = image.create(size << 2, size << 1)\n            \n            // outImg.fill(i+1)\n            for (let x = 0; x < inImg.width; x++) {\n                for (let y = 0; y < inImg.height; y++) {\n                    const xo =  (x+y)*2, yo=15 - x + y\n                    outImg.drawLine(xo,yo, xo+3,yo, inImg.getPixel(x,y))\n                }\n            }\n            return outImg\n        }\n\n        drawWallSide_Solid(offsetX: number, offsetY:number){\n                    const p0x = offsetX + this.corners[0].x, p0y = offsetY + this.corners[0].y\n                    const p1x = offsetX + this.corners[1].x, p1y = offsetY + this.corners[1].y\n                    const p3x = offsetX + this.corners[2].x, p3y = offsetY + this.corners[2].y\n\n                    this.tempScreen.fillPolygon4(\n                        p0x, p0y,\n                        p0x, p0y - WallHeight,\n                        p1x, p1y - WallHeight,\n                        p1x, p1y,\n                        12)\n\n                    this.tempScreen.fillPolygon4(\n                        p3x, p3y,\n                        p3x, p3y - WallHeight,\n                        p1x, p1y - WallHeight,\n                        p1x, p1y,\n                        12)\n        }\n\n        drawWallSide_Tex(targetImg: Image, offsetX: number, offsetY: number, tex: Image, startCornerIndex: number) {\n            const p0x = offsetX + this.corners[startCornerIndex].x, p0y = offsetY + this.corners[startCornerIndex].y\n            const p1x = offsetX + this.corners[startCornerIndex + 1].x, p1y = offsetY + this.corners[startCornerIndex + 1].y\n            let y = (p0y - WallHeight + 1) << fpx\n            const diffX0_1 = p1x - p0x\n            let texX = 0\n            const texXStep = Math.idiv((TileSize << fpx), diffX0_1)\n            const yStep = Math.idiv((p1y - p0y) << fpx, diffX0_1)\n            for (let x = 0; x <= diffX0_1; x++) {\n                // this.tempScreen.print(y+\"\", 100,60+x*10)\n                helpers.imageBlitRow(targetImg, x + p0x, y >> fpx,\n                    tex, texX >> fpx, WallHeight)\n                texX += texXStep\n                y += yStep\n            }\n        }\n\n        rotatedTexWalls: Image[] = []\n        drawWall(offsetX: number, offsetY: number, tileIndex: number) {\n            // this.drawWall(offsetX, offsetY)\n            let texWall = this.rotatedTexWalls[tileIndex]\n            if (!texWall) {\n                // let ms = control.benchmark(() => {\n                texWall = image.create(TileSize * Max_TileImgScaleX, TileSize * Max_TileImgScaleY + WallHeight)\n                    this.drawWallSide_Tex(texWall, 0, WallHeight, this.map.getTileset()[tileIndex], 0)\n                    this.drawWallSide_Tex(texWall, 0, WallHeight, this.map.getTileset()[tileIndex], 1)\n                    texWall.drawTransparentImage(this.rotatedTiles[tileIndex], 0, 0)\n                    this.rotatedTexWalls[tileIndex] = texWall\n                // }); info.player4.setLife(ms) // this.tempScreen.print(ms.toString(), 0, 110)\n            }\n            this.tempScreen.drawTransparentImage(texWall, offsetX, offsetY - WallHeight)\n        }\n\n        rotatedTiles:Image[]\n        lastRenderAngle=-1\n        selfSprAniId=0\n        corners: { x: number, y: number }[] = [] //[{ x: 0, y: 0 }, { x: 0, y: 0 }, { x: 0, y: 0 }]\n        render() {\n            // isometricView, ref: https://forum.makecode.com/t/snes-mode-7-transformations/8530\n\n            this.viewXFpx = this.xFpx\n            this.viewYFpx = this.yFpx\n            this.viewZPos = this.spriteMotionZ[this.sprSelf.id].p + (this.sprSelf._height as any as number) - (2<<fpx) + this.cameraOffsetZ_fpx\n\n            while (this._angle < 0) this._angle += Math.PI * 2\n            while (this._angle >Math.PI*2) this._angle -= Math.PI * 2\n            info.player2.setScore(this._angle*180/Math.PI)\n            const angle = -this._angle - Math.PI / 2\n\n            if (!this.rotatedTiles) {\n                this.rotatedTiles = []\n                for (let i = 0; i < this.map.getTileset().length; i++)\n                    this.rotatedTiles.push(image.create(TileSize * Max_TileImgScaleX, TileSize * Max_TileImgScaleY))\n            }\n\n            //update tiles and parameters\n            if(this.lastRenderAngle!=this._angle)\n            {\n\n                A_Fpx = (Math.cos(angle) * fpx_scale / Scale)|0\n                B_Fpx = (Math.sin(angle) * fpx_scale / Scale)|0\n                // A_Fpx = Math.sqrt(AD_BC_Fpx2 - B_Fpx * B_Fpx)\n                // B_Fpx = Math.sqrt(AD_BC_Fpx2 - A_Fpx * A_Fpx)\n\n                for (let i = 0; i < this.rotatedTiles.length; i++)\n                    this.rotatedTiles[i].fill(0)\n\n                let ms: number\n                ms = control.benchmark(() => {\n                    this.rotateAll(this.map.getTileset(), A_Fpx, B_Fpx)\n                    //a workaround avoiding gaps between tiles\n                    this.rotatedTiles.forEach((t)=> t.drawTransparentImage(t, -1, -1))\n                    this.rotatedTexWalls.splice(0, this.rotatedTexWalls.length)\n                }); info.setLife(ms/this.rotatedTiles.length) // this.tempScreen.print(ms.toString(), 0, 110)\n\n\n                // this.rotatedTiles.forEach((v, i) =>{\n                //     this.tempScreen.drawImage(v, (i % 3) * 64, 32+32*((i/3)|0))})\n\n                //tile corners, for drawing wall\n                // ms=control.benchmark(()=> {\n                    this.corners.splice(0, this.corners.length)\n                    this.corners = [\n                        rotatePoint(0, 0, A_Fpx, B_Fpx),\n                        rotatePoint(0, 15.99, A_Fpx, B_Fpx),\n                        rotatePoint(15.99, 15.99, A_Fpx, B_Fpx),\n                        rotatePoint(15.99, 0, A_Fpx, B_Fpx),\n                    ]\n\n                    const topCornerId = this.corners.reduce((tId, p, i) => { return p.y < this.corners[tId].y ? i : tId }, 0)\n                    this.corners.removeAt(topCornerId)\n                    if (topCornerId) //not necessary if removed [0]\n                        for (let i = 0; i < 3 - topCornerId; i++) //rolling reorder, keep original loop order, start from the next corner of toppest one to the last, then start from beginning\n                            this.corners.insertAt(0, this.corners.pop())\n                    // this.corners[1].x -= 1\n                // }); info.player2.setScore(ms)\n\n                //shear doubled, manually, for reference\n                // this.tempScreen.drawImage(assets.image`shearDoubleX_reference`, 50, 0)\n\n                // ms = control.benchmark(() => {\n                // this.rotatedTiles = this.map.getTileset().map((v, i) => this.shearDoubleX(v, this._angle, i))\n                // }); this.tempScreen.print(ms.toString(), 0, 100)\n                // this.rotatedTiles.forEach((v, i) =>{\n                // this.tempScreen.drawImage(v, (i % 3) * 64, 32 * ((i / 3) | 0))})\n                // \n                // this.tempScreen.drawImage(this.map.getTileImage(3), 0, 12)\n\n                this.lastRenderAngle=this._angle\n            }\n\n            const A_px_Fpx = (TileSize * Scale_Square -1) * A_Fpx  // -2 is a workaround avoiding gaps between tiles \n            const B_px_Fpx = (TileSize * Scale_Square -1) * B_Fpx  // -2 is a workaround avoiding gaps between tiles \n            const C_px_Fpx = -B_px_Fpx\n            const D_px_Fpx = A_px_Fpx\n\n            //shearDoubleX\n            // const A = 32 * fpx_scale\n            // const B = 16 * fpx_scale\n            // const C = -A\n            // const D =  B\n\n            if(0){//debug tiles align with A B\n                this.tempScreen.fill(8)\n                const A = A_px_Fpx / fpx_scale\n                const B = B_px_Fpx / fpx_scale\n                const C = -B\n                const D = A\n\n                const baseX=0, baseY=64\n                const centerX= baseX+(TileSize*TileImgScaleX>>1), centerY=baseY+TileSize*TileImgScaleY/2\n\n                this.drawWall(baseX - A, baseY - B / (TileImgScaleX / TileImgScaleY), 3)\n                \n                // this.rotatedTiles[1].replace(0,6)\n                this.drawWall(baseX, baseY, 1)\n                \n                this.tempScreen.drawLine(centerX, centerY - WallHeight, centerX + A, centerY - WallHeight + B/(TileImgScaleX/TileImgScaleY), 2)\n                this.tempScreen.drawLine(centerX, centerY - WallHeight, centerX + C, centerY - WallHeight + D/(TileImgScaleX/TileImgScaleY), 2)\n                //debug\n                this.corners.forEach((p, i) => this.tempScreen.print(p.x + \",\" + p.y, 70, i * 10 + 30))\n                // info.player2.setScore(100 * this._angle * 180 / Math.PI)\n\n                this.corners.forEach((p, i) => { this.tempScreen.setPixel(baseX+p.x, baseY - WallHeight + p.y, i + 2) })\n\n                return\n            }\n\n            const left_CenterTile = ScreenCenterX - (TileSize * TileImgScaleX >>1 )\n            const top_CenterTile =  ScreenCenterY - (TileSize * TileImgScaleY >>1 )\n\n        let ms = control.benchmark(() => {\n            const Walls = []\n            let offsetX0_Fpx = (( (HalfTileSize - this.sprSelf.y) * C_px_Fpx + A_px_Fpx * (HalfTileSize - this.sprSelf.x) ) >>TileMapScale ) + (left_CenterTile<<fpx)\n            let offsetY0_Fpx = (((HalfTileSize - this.sprSelf.y) * D_px_Fpx + B_px_Fpx * (HalfTileSize - this.sprSelf.x)) >> TileMapScale) + (top_CenterTile << fpx) * (TileImgScaleX / TileImgScaleY)\n            for (let i = 0; i < this.map.width; i++) {\n                let offsetX_Fpx = offsetX0_Fpx\n                let offsetY_Fpx = offsetY0_Fpx\n                for (let j = 0; j < this.map.height; j++) {\n                    const offsetX = offsetX_Fpx >> fpx\n                    const offsetY = (offsetY_Fpx >> (fpx))/(TileImgScaleX / TileImgScaleY)\n                    if (offsetX > -TileSize * TileImgScaleX && offsetX < screen.width && offsetY > -TileSize * TileImgScaleY && offsetY < screen.height + TileSize * TileImgScaleY) {\n                        const t = this.map.getTile(j, i)\n                        if (this.map.isWall(j, i)) {\n                            Walls.push([1, offsetX, offsetY, t, \n                                (D_px_Fpx > 0 ? i : this.map.width - 1 - i) * this.map.width +\n                                (B_px_Fpx > 0 ? j : this.map.height - 1 - j)\n                            ])\n                        }else //floor\n                            this.tempScreen.drawTransparentImage(this.rotatedTiles[t], offsetX, offsetY)\n                    }\n                    offsetX_Fpx+=A_px_Fpx\n                    offsetY_Fpx+=B_px_Fpx\n                }\n                offsetX0_Fpx += C_px_Fpx\n                offsetY0_Fpx += D_px_Fpx\n            }\n\n            //draw Sprite and wall by order of distance\n            const drawingSprites = this.sprites\n            .map((spr, index) => {\n                const offsetX = ScreenCenterX + ((C_px_Fpx * (spr.y - this.sprSelf.y) + A_px_Fpx * (spr.x - this.sprSelf.x)) >> (TileMapScale + fpx))\n                const offsetY = ScreenCenterY + (((D_px_Fpx * (spr.y - this.sprSelf.y) + B_px_Fpx * (spr.x - this.sprSelf.x)) >> (TileMapScale + fpx))/(TileImgScaleX/TileImgScaleY))\n                const j = (spr.x / TileSize) | 0, i = (spr.y / TileSize) | 0\n                return [0, offsetX, offsetY, index,\n                    (D_px_Fpx > 0 ? i : this.map.width - 1 - i) * this.map.width +\n                    (B_px_Fpx > 0 ? j : this.map.height - 1 - j) +\n                    ((spr.layer-1)<<10)\n                    ]\n            })\n            .filter((v,i) =>{\n                const spr= this.sprites[i]\n                return (v[2] > 0 && v[1] >= -(spr.width * Scale >> 1) && v[1] < screen.width + (spr.width * Scale >> 1) && v[2] < screen.height + spr.height * Scale + (this.spriteMotionZ[spr.id].p * WallScale >> fpx))\n            })\n            drawingSprites\n                .concat(Walls) // [0/1:spr/wall, offsetX, offsetY,sprID/wallTex, drawing order index of row&col]\n                .sort((v1, v2) => v1[4] - v2[4]) // from far to near\n                .forEach((v) => {\n                    if (v[0] === 0) \n                        this.drawSprite(this.sprites[v[3]], v[1], v[2])\n                    else if (v[0] === 1)\n                        this.drawWall(v[1], v[2], v[3])\n                    // this.tempScreen.print(v[4] + \"\", v[1] + TileSize * 2, v[2], 2)\n            })\n\n            drawingSprites.forEach((v) => this.drawSprite_SayText(this.sprites[v[3]], v[1], v[2]))\n\n            game.currentScene().particleSources.forEach((p)=>{\n                if(this.spriteParticles.indexOf(p)<0)p.__draw(game.currentScene().camera)\n            })\n\n        });info.setScore(ms) // this.tempScreen.print(ms.toString(), 0, 20)\n        }\n        \n        registerOnSpriteDirectionUpdate(handler: (spr: Sprite, dir: number) => void) {\n            this.onSpriteDirectionUpdateHandler = handler\n        }\n\n        drawSprite(spr: Sprite, x: number, y: number) {\n            const widthSpr = spr.width * Scale\n            const heightSpr = spr.height * Scale\n            const dir = (Math.atan2(spr._vx as any as number, spr._vy as any as number) + this._angle) / Math.PI / 2 + .5\n            const texSpr = !this.spriteAnimations[spr.id] ? spr.image : this.spriteAnimations[spr.id].getFrameByDir(dir)\n            helpers.imageBlit(this.tempScreen, x - (widthSpr >> 1), y - heightSpr - (this.spriteMotionZ[spr.id].p * WallScale >> fpx), widthSpr, heightSpr,\n                texSpr, 0, 0, spr.image.width, spr.image.height, true, false)\n                \n            const particle = this.spriteParticles[spr.id]\n            if (particle) {\n                if (particle.lifespan) {\n                    this.camera.drawOffsetX = -x\n                    this.camera.drawOffsetY = -(y - (spr.height * Scale >> 1) - (this.spriteMotionZ[spr.id].p * WallScale >> fpx))\n                    particle.__draw(this.camera)\n                } else {\n                    this.spriteParticles[spr.id] = undefined\n                }\n            }\n        }\n\n        //sayText\n        drawSprite_SayText(spr: Sprite, x: number, y: number){\n            const sayRender = this.sayRederers[spr.id]\n            if (sayRender) {\n                const heightSpr = spr.height * Scale\n                if (this.sayEndTimes[spr.id] && control.millis() > this.sayEndTimes[spr.id]) {\n                    this.sayRederers[spr.id] = undefined\n                } else {\n                    this.tempSprite.x = x\n                    this.tempSprite.y = y - heightSpr - (this.spriteMotionZ[spr.id].p * WallScale >> fpx) -2\n                    this.camera.drawOffsetX = 0\n                    this.camera.drawOffsetY = 0\n                    sayRender.draw(this.tempScreen, this.camera, this.tempSprite)\n                }\n            }\n\n/*\n            const sayOrParticle = !!sayRender || !!particle\n            if (sayOrParticle) {\n                screen.fill(0)\n                //particle\n                //update screen for this spr\n                const fpx_div_transformy = Math.roundWithPrecision(transformY / 4 / fpx_scale, 2)\n                const height = (SH / fpx_div_transformy)\n                const blitXSaySrc = ((blitX - spriteScreenX) * fpx_div_transformy) + SWHalf\n                const blitWidthSaySrc = (blitWidth * fpx_div_transformy)\n                if (blitXSaySrc <= 0) { //imageBlit considers negative value as 0\n                    helpers.imageBlit(\n                        this.tempScreen,\n                        spriteScreenX - SWHalf / fpx_div_transformy, drawStart - height / 2, (blitWidthSaySrc + blitXSaySrc) / fpx_div_transformy, height,\n                        screen,\n                        0, 0, blitWidthSaySrc + blitXSaySrc, SH, true, false)\n                } else {\n                    helpers.imageBlit(\n                        this.tempScreen,\n                        blitX, drawStart - height / 2, blitWidth, height,\n                        screen,\n                        blitXSaySrc, 0, blitWidthSaySrc, SH,\n                        true, false)\n                }\n            }\n            // const ms = control.benchmark(() => {\n            // }); this.tempScreen.print(ms.toString(), 0, 30 + index * 10, 15)\n*/\n        }\n\n    }\n\n    //%fixedinstance\n    export const raycastingRender = new Render.RayCastingRender()\n}\n","render_blocks.ts":"enum RCSpriteAttribute{\n    ZOffset,\n    ZPosition,\n    ZVelocity,\n    ZAcceleration\n}\n/**\n * A 2.5D Screen Render, using Raycasting algorithm\n **/\n//% color=#03AA74 weight=1 icon=\"\\uf1b2\" //cube f1b2 , fold f279\n//% groups='[\"Instance\",\"Basic\", \"Dimension Z\", \"Animate\", \"Advanced\"]'\n//% block=\"3D Render\"\nnamespace Render {\n    export enum attribute {\n        dirX,\n        dirY,\n        fov,\n        wallZScale,\n    }\n\n    export class Animations {\n        constructor(public frameInterval: number, public animations: Image[][]) {\n        }\n\n        msLast = 0\n        index = 0\n        iAnimation = 0\n        getFrameByDir(dir: number): Image {\n            if (control.millis() - this.msLast > this.frameInterval) {\n                this.msLast = control.millis()\n                this.index++\n                while(dir<0) dir+=1 //make sure dir>0\n                this.iAnimation = Math.round((dir * this.animations.length)) % this.animations.length\n                if (this.index >= this.animations[this.iAnimation].length)\n                    this.index = 0\n            }\n            return this.animations[this.iAnimation][this.index]\n        }\n    }\n\n    /**\n * Apply a directional image animations on a sprite\n * @param sprite the sprite to animate on\n * @param animations the directional animates\n */\n    //% blockId=set_animation\n    //% block=\"set $sprite=variables_get(mySprite) with animations$animations\"\n    //% animations.shadow=create_animation\n    //% group=\"Animate\"\n    //% weight=100\n    //% help=github:pxt-raycasting/docs/set-sprite-animations\n    export function setSpriteAnimations(sprite: Sprite, animations: Animations) {\n        raycastingRender.spriteAnimations[sprite.id] = animations\n    }\n\n    /**\n * Create a directional image animations, multi animations will applied to one round dirctions averagely, start from the left. \n * The reason that directions start from left, is almost all Arcade out-of-box 1 or 2-dirction images are facing left, so that would be convient for using.\n * @param frameInterval the time between changes, eg: 150\n * @param frames1 animation, if this is the first of multi animation it will be used as left, others will \n * @param frames2 optional, used for 2 or more dirctional\n * @param frames3 optional, used for 3 or more dirctional\n * @param frames4 optional, used for 4 or more dirctional\n */\n    //% blockId=create_animation\n    //% block=\"interval$frameInterval=timePicker animates:$frames1=animation_editor|| $frames2=animation_editor $frames3=animation_editor $frames4=animation_editor\"\n    //% inlineInputMode=inline\n    //% group=\"Animate\"\n    //% weight=100\n    //% help=github:pxt-raycasting/docs/create-animations\n    export function createAnimations(frameInterval: number, frames1: Image[], frames2?: Image[], frames3?: Image[], frames4?: Image[]): Animations {\n        const animationList = [frames1]\n        if (frames2) animationList.push(frames2)\n        if (frames3) animationList.push(frames3)\n        if (frames4) animationList.push(frames4)\n        return new Animations(frameInterval, animationList)\n    }\n\n    /**\n     * Get the Render\n     * @param img the image\n     */\n    //% group=\"Instance\"\n    //% blockId=rcRender_getRCRenderInstance block=\"raycasting render\"\n    //% expandableArgumentMode=toggle\n    //% weight=100 \n    //% blockHidden=true\n    //% hidden=1\n    export function getRCRenderInstance(): RayCastingRender {\n        return raycastingRender\n    }\n\n    /**\n     * Get the render Sprite, which create automatically, for physical collisions, and holding the view point.\n     * You can consider it as \"myself\", and operate it like a usual sprite, eg.: position, speed, scale, collision, ...\n     * But properties relative 3D, eg. ZOffset, ZPosition, viewAngle, and etc. are not in the Sprite class.\n     */\n    //% group=\"Instance\"\n    //% blockId=rcRender_getRenderSpriteVariable block=\"myself sprite\"\n    //% expandableArgumentMode=toggle\n    //% blockSetVariable=mySprite\n    //% weight=99\n    //% help=github:pxt-raycasting/get-render-sprite-variable\n    export function getRenderSpriteVariable(): Sprite {\n        return raycastingRender.sprSelf\n    }\n\n    /**\n     * Get the render Sprite, which create automatically, for physical collisions, and holding the view point.(but get/set view direction with dirX/dirY, which not in the Sprite class) \n     * You can consider it as \"myself\", and operate it like a usual sprite.\n     * eg: position, speed, scale, collision, ...\n     */\n    //% group=\"Instance\"\n    //% blockId=rcRender_getRenderSpriteInstance block=\"myself sprite\"\n    //% expandableArgumentMode=toggle\n    //% weight=98\n    //% help=github:pxt-raycasting/docs/get-render-sprite-instance\n    export function getRenderSpriteInstance(): Sprite {\n        return raycastingRender.sprSelf\n    }\n\n    /**\n     * Toggle current view mode\n     */\n    //% blockId=rcRender_toggleViewMode block=\"toggle current view mode\"\n    //% group=\"Basic\"\n    //% weight=89\n    //% help=github:pxt-raycasting/docs/toggle-view-mode\n    export function toggleViewMode() {\n        raycastingRender.viewMode = raycastingRender.viewMode == ViewMode.tilemapView ? ViewMode.isometricView : ViewMode.tilemapView\n    }\n\n    /**\n     * Current view mode is the specific one?\n     * @param viewMode\n     */\n    //% blockId=rcRender_isViewMode block=\"current is $viewMode\"\n    //% group=\"Basic\"\n    //% weight=88\n    //% help=github:pxt-raycasting/docs/is-view-mode\n    export function isViewMode(viewMode: ViewMode): boolean {\n        return viewMode == raycastingRender.viewMode\n    }\n\n    /**\n     * Set view mode\n     * @param viewMode\n     */\n    //% blockId=rcRender_setViewMode block=\"set view mode $viewMode\"\n    //% group=\"Basic\"\n    //% weight=87\n    //% help=github:pxt-raycasting/docs/set-view-mode\n    export function setViewMode(viewMode: ViewMode) {\n        raycastingRender.viewMode = viewMode\n    }\n\n    /**\n     * Get render arribute\n     * @param viewMode\n     */\n    //% group=\"Basic\"\n    //% block=\"get %attribute\" \n    //% blockId=rcRender_getAttribute\n    //% weight=83\n    //% help=github:pxt-raycasting/docs/get-attribute\n    export function getAttribute(attr: attribute): number {\n        switch (attr) {\n            case attribute.dirX:\n                return raycastingRender.dirX\n            case attribute.dirY:\n                return raycastingRender.dirY\n            case attribute.fov:\n                return raycastingRender.fov\n            case attribute.wallZScale:\n                return raycastingRender.wallZScale\n            default:\n                return 0\n        }\n    }\n\n    /**\n     * Set render arribute\n     * @param viewMode\n     */\n    //% group=\"Basic\"\n    //% block=\"set %attribute = %value\" \n    //% blockId=rcRender_setAttribute\n    //% weight=82\n    //% help=github:pxt-raycasting/docs/set-attribute\n    export function setAttribute(attr: attribute, value: number) {\n        switch (attr) {\n            case attribute.dirX:\n                raycastingRender.dirX = value\n                break\n            case attribute.dirY:\n                raycastingRender.dirY = value\n                break\n            case attribute.fov:\n                if (value < 0) value = 0\n                raycastingRender.fov = value\n                break\n            case attribute.wallZScale:\n                if (value < 0) value = 0\n                raycastingRender.wallZScale = value\n                break\n            default:\n        }\n    }\n\n    /**\n     * Get default FOV (field of view) value\n     * @param viewMode\n     */\n    //% group=\"Basic\"\n    //% block=\"defaultFov\"\n    //% blockId=rcRender_getDefaultFov\n    //% weight=81\n    //% help=github:pxt-raycasting/docs/get-default-fov\n    export function getDefaultFov(): number {\n        return defaultFov\n    }\n\n    /**\n     * Set view angle\n     * @param angle, unit: degree 0~360\n     */\n    //% blockId=rcRender_setViewAngleInDegree block=\"set view angle$angle\"\n    //% angle.min=0 angle.max=360 angle.defl=90\n    //% group=\"Basic\"\n    //% weight=80\n    //% help=github:pxt-raycasting/docs/set-view-angle-in-degree\n    export function setViewAngleInDegree(angle: number) {\n        raycastingRender.viewAngle = angle * Math.PI / 180\n    }\n\n    /**\n     * Set view angle by dirX and dirY\n     * @param dirX\n     * @param dirY\n     */\n    //% blockId=rcRender_setViewAngle block=\"set view angle by dirX%dirX and dirY%dirY\"\n    //% group=\"Basic\"\n    //% weight=79\n    //% help=github:pxt-raycasting/docs/set-view-angle\n    export function setViewAngle(dirX: number, dirY: number) {\n        raycastingRender.viewAngle = Math.atan2(dirY, dirX)\n    }\n\n    /**\n     * Set floating offset height for a sprite at Z direction\n     * @param sprite\n     * @param Zoffset Negative floats down, affirmative goes up\n     * @param duration moving time, 0 for immediately, unit: ms\n     */\n    //% blockId=rcRender_setZOffset block=\"set Sprite %spr=variables_get(mySprite) floating %offset pixels|| duration $duration=timePicker|ms \"\n    //% offset.min=-100 offset.max=100 offset.defl=8\n    //% duration.min=0 duration.max=5000 duration.defl=0\n    //% group=\"Dimension Z\"\n    //% weight=77\n    //% blockHidden\n    //% help=github:pxt-raycasting/docs/set-z-offset\n    export function setZOffset(sprite: Sprite, offset: number, duration?: number) {\n        raycastingRender.setZOffset(sprite, offset, duration)\n    }\n\n    /**\n     * Set arribute of a Sprite\n     * @param spr Sprite\n     * @param attr RCSpriteAttribute\n     */\n    //% group=\"Dimension Z\"\n    //% block=\"set Sprite %spr=variables_get(mySprite) %attribute = %value\"\n    //% blockId=rcRender_setSpriteAttribute\n    //% weight=75\n    //% help=github:pxt-raycasting/docs/set-sprite-attribute\n    export function setSpriteAttribute(spr: Sprite, attr: RCSpriteAttribute, value: number) {\n        switch (attr) {\n            case RCSpriteAttribute.ZOffset:\n                raycastingRender.setZOffset(spr, value, 0)\n                break\n            case RCSpriteAttribute.ZPosition:\n                raycastingRender.getMotionZ(spr).p = Render.tofpx(value)\n                break\n            case RCSpriteAttribute.ZVelocity:\n                raycastingRender.getMotionZ(spr).v = Render.tofpx(value)\n                break\n            case RCSpriteAttribute.ZAcceleration:\n                raycastingRender.getMotionZ(spr).a = Render.tofpx(value)\n                break\n            default:\n        }\n    }\n\n    /**\n     * Get arribute of a Sprite\n     * @param spr Sprite\n     * @param attr RCSpriteAttribute\n     */\n    //% group=\"Dimension Z\"\n    //% block=\"get Sprite %spr=variables_get(mySprite) %attribute\"\n    //% blockId=rcRender_getSpriteAttribute\n    //% weight=74\n    //% help=github:pxt-raycasting/docs/get-sprite-attribute\n    export function getSpriteAttribute(spr:Sprite, attr: RCSpriteAttribute): number {\n        switch (attr) {\n            case RCSpriteAttribute.ZOffset:\n                return raycastingRender.getMotionZ(spr).offset\n            case RCSpriteAttribute.ZPosition:\n                return raycastingRender.getMotionZ(spr).p << Render.fpx\n            case RCSpriteAttribute.ZVelocity:\n                return raycastingRender.getMotionZ(spr).v << Render.fpx\n            case RCSpriteAttribute.ZAcceleration:\n                return raycastingRender.getMotionZ(spr).a << Render.fpx\n            default:\n                return 0\n        }\n    }\n\n    /**\n     * Check if 2 sprites overlaps each another in Z dimension\n     * Best work together with sprites.onOverlap(kind1, kind2)\n     * @param sprite1\n     * @param sprite2\n     */\n    //% blockId=rcRender_isSpritesOverlapZ\n    //% block=\"is sprites $sprite1=variables_get(mySprite) and $sprite2=variables_get(mySprite2) overlaps in Z dimension\"\n    //% group=\"Dimension Z\"\n    //% weight=71\n    //% help=github:pxt-raycasting/docs/is-sprites-overlap-z\n    export function isSpritesOverlapZ(sprite1: Sprite, sprite2: Sprite): boolean {\n        return raycastingRender.isOverlapZ(sprite1, sprite2)\n    }\n\n    /**\n     * Make sprite jump, with specific height and duration\n     * Jump can only happened when sprite is standing, current height = its offset .\n     * @param sprite\n     * @param height jump height in pixel\n     * @param duration hover time span, unit: ms\n     */\n    //% blockId=rcRender_jumpWithHeightAndDuration block=\"Sprite %spr=variables_get(mySprite) jump, with height $height duration $duration=timePicker|ms \"\n    //% height.min=0 height.max=100 height.defl=16\n    //% duration.min=50 duration.max=5000 duration.defl=500\n    //% group=\"Dimension Z\"\n    //% weight=70\n    //% help=github:pxt-raycasting/docs/jump-with-height-and-duration\n    export function jumpWithHeightAndDuration(sprite: Sprite, height: number, duration: number) {\n        raycastingRender.jumpWithHeightAndDuration(sprite, height, duration)\n    }\n\n    /**\n     * Make sprite jump, with specific speed and acceleration\n     * Simular with Move block, but jump can only happened when sprite is standing, current height = its offset.\n     * @param sprite\n     * @param v vetical speed, unit: pixel/s\n     * @param a vetical acceleration, unit: pixel/sÂ²\n     */\n    //% blockId=rcRender_jump block=\"Sprite %spr=variables_get(mySprite) jump||, with speed $v=spriteSpeedPicker acceleration $a\"\n    //% v.min=-100 v.max=100 v.defl=60\n    //% a.min=-1000 a.max=1000 a.defl=-250\n    //% group=\"Dimension Z\"\n    //% weight=68\n    //% help=github:pxt-raycasting/docs/jump\n    export function jump(sprite: Sprite, v?: number, a?: number) {\n        raycastingRender.jump(sprite, v, a)\n    }\n\n    /**\n     * Make sprite jump, with specific speed and acceleration\n     * @param sprite\n     * @param v vetical speed, unit: pixel/s\n     * @param a vetical acceleration, unit: pixel/sÂ²\n     */\n    //% blockId=rcRender_move block=\"Sprite %spr=variables_get(mySprite) move, with speed $v=spriteSpeedPicker|| acceleration $a\"\n    //% v.min=-200 v.max=200 v.defl=60\n    //% a.min=-1000 a.max=1000 a.defl=-250\n    //% group=\"Dimension Z\"\n    //% weight=66\n    //% help=github:pxt-raycasting/docs/move\n    export function move(sprite: Sprite, v?: number, a?: number) {\n        raycastingRender.move(sprite, v, a)\n    }\n\n    /**\n     * Control the self sprite using the direction buttons from the controller. \n     * To stop controlling self sprite, pass 0 for v and va.\n     *\n     * @param v The velocity used for forward/backword movement when up/down is pressed, in pixel/s\n     * @param va The angle velocity used for turn view direction when left/right is pressed, in radian/s.\n     */\n    //% blockId=\"rcRender_moveWithController\" block=\"move with buttons velocity $v|| turn speed $va camera sway$cameraSway pixels\"\n    //% weight=60\n    //% expandableArgumentMode=\"toggle\"\n    //% v.defl=2 va.defl=3\n    //% group=\"Advanced\"\n    //% v.shadow=\"spriteSpeedPicker\"\n    //% va.shadow=\"spriteSpeedPicker\"\n    //% help=github:pxt-raycasting/docs/move-with-controller\n    export function moveWithController(v: number = 2, va: number = 3, cameraSway?:number) {\n        raycastingRender.velocity = v\n        raycastingRender.velocityAngle = va\n        if(cameraSway!=undefined)\n            raycastingRender.cameraSway=cameraSway|0\n    }\n\n    /**\n     * Render takeover all sprites in current scene\n     * Render will call this automatically, but maybe not in time enough.\n     * If you saw sprite draw at its tilemap position on screen, call this just after created the sprite.\n     */\n    //% blockId=rcRender_takeoverSceneSprites \n    //% block=\"takeover sprites in scene\"\n    //% group=\"Advanced\"\n    //% weight=49\n    //% help=github:pxt-raycasting/docs/takeover-scene-sprites\n    export function takeoverSceneSprites() {\n        raycastingRender.takeoverSceneSprites()\n    }\n\n    /**\n     * Run on sprite dirction updated, present view point to Sprite facing dirction, or which angle you see of the sprite.\n     * Just using with other animation extensions, to set proper Image for sprite.\n     * Not required, if you have used the set animations block provided.\n     * @param dir It is a float number, 0~1 corresponds to 0~360Â°, suggest use Math.round(dir*dirAniTotalCount)%dirAniTotalCount to get index of direction\n     */\n    //% blockId=rcRender_registerOnSpriteDirectionUpdateHandler\n    //% block=\"run code when sprite $spr dirction updated to $dir\"\n    //% draggableParameters\n    //% group=\"Advanced\"\n    //% weight=48\n    //% help=github:pxt-raycasting/docs/register-on-sprite-direction-update-handler\n    export function registerOnSpriteDirectionUpdateHandler(handler: (spr: Sprite, dir: number) => void) {\n        raycastingRender.registerOnSpriteDirectionUpdate(handler)\n    }\n}","animation.ts":"//////////////////////// animation.ts contents of previous version, just for test.ts here for convenience /////////////////////\n// file contents:\n// directional animations defines for enging_raycasting.ts\n// for convenience, constructed animations as below, which images are builtin in Arcade, \n// in order from easy to complex\n\n// each are 2D Image array, Image[][]: \n// 1st dimension is direction: \n//    length=1 to any, e.g. 1,2,3,4,...,8,..., engine can automatically arange them to 0~360Â° \n//    order: start from left, then folling with others in CW order\n//    e.g: \n//         2 directions should be [leftAni,RightAni], \n//         4-direction should be [leftAni, frontAni, rightAni, backAni], \n//         8-direction=[l,lf,f,fr,r,rb,b,lb], ...\n//    the reason that directions start from left, is almost all Arcade builtin one side images are facing left, so that would be convient for using.\n// 2nd dimension is animation Images\n//    length=1 to any, e.g. 1,2,3,4,..., engine will automatically loop them by aniInterval(set when create CompactSprite, or use default)\n\n\n//simplest, just one static image, looks the same in all angle of view\n//% whenUsed\nconst texturesDonut = [[sprites.food.smallDonut]]\n//% whenUsed\nconst texturesBigCake = [[sprites.food.bigCake]]\n\n//1-direction, with ani, looks the same Ani in all angle of view\n//% whenUsed\nconst texturesCoin = [[sprites.builtin.coin0, sprites.builtin.coin1, sprites.builtin.coin2, sprites.builtin.coin3, sprites.builtin.coin4, sprites.builtin.coin5]]\n\n//% whenUsed\nconst texturesDog = [[sprites.builtin.dog0, sprites.builtin.dog1, sprites.builtin.dog2]]\n//% whenUsed\nconst texturesDuck = [[sprites.duck.duck1, sprites.duck.duck2, sprites.duck.duck3, sprites.duck.duck4, sprites.duck.duck5, sprites.duck.duck6],\n    [sprites.duck.duck1, sprites.duck.duck2, sprites.duck.duck3, sprites.duck.duck4, sprites.duck.duck5, sprites.duck.duck6]]\nimagesFlipX(texturesDuck[0])\n\n//2-direction, with ani, looks difference from left or right side\n//% whenUsed\nconst texturesPlane = [[sprites.vehicle.plane0, sprites.vehicle.plane1, sprites.vehicle.plane2, sprites.vehicle.plane3, sprites.vehicle.plane4, sprites.vehicle.plane5],\n[sprites.vehicle.plane0, sprites.vehicle.plane1, sprites.vehicle.plane2, sprites.vehicle.plane3, sprites.vehicle.plane4, sprites.vehicle.plane5]]\n//no right side ani images builtin, so make them from lefts, and then flipX\nimagesFlipX(texturesPlane[1])\n\n//% whenUsed\nconst texturesFish = [[sprites.builtin.angelFish0, sprites.builtin.angelFish1, sprites.builtin.angelFish2, sprites.builtin.angelFish3],\n[sprites.builtin.angelFish0, sprites.builtin.angelFish1, sprites.builtin.angelFish2, sprites.builtin.angelFish3]]\nimagesFlipX(texturesFish[1])\n\n//4-direction\n//% whenUsed\nconst texturesHero = [\n    [sprites.castle.heroWalkSideLeft1, sprites.castle.heroWalkSideLeft2, sprites.castle.heroWalkSideLeft3, sprites.castle.heroWalkSideLeft4],\n    [sprites.castle.heroWalkFront1, sprites.castle.heroWalkFront2, sprites.castle.heroWalkFront3, sprites.castle.heroWalkFront4],\n    [sprites.castle.heroWalkSideRight1, sprites.castle.heroWalkSideRight2, sprites.castle.heroWalkSideRight3, sprites.castle.heroWalkSideRight4],\n    [sprites.castle.heroWalkBack1, sprites.castle.heroWalkBack2, sprites.castle.heroWalkBack3, sprites.castle.heroWalkBack4],\n]\n\n//% whenUsed\nconst texturesPrincess2 = [\n    [sprites.castle.princess2Left1, sprites.castle.princess2Left2],\n    [sprites.castle.princess2WalkFront1, sprites.castle.princess2WalkFront2, sprites.castle.princess2WalkFront3, sprites.castle.princess2WalkFront2],\n    [sprites.castle.princess2Right1, sprites.castle.princess2Right2],\n    [sprites.castle.princess2WalkBack1, sprites.castle.princess2WalkBack2, sprites.castle.princess2WalkBack3, sprites.castle.princess2WalkBack2],\n]\n\n//4-direction, but back side has only 1 image, so no ani when looking from back\n//% whenUsed\nconst texturesSkelly = [\n    [sprites.castle.skellyWalkLeft1, sprites.castle.skellyWalkLeft2],\n    [sprites.castle.skellyWalkFront1, sprites.castle.skellyWalkFront2, sprites.castle.skellyWalkFront3],\n    [sprites.castle.skellyWalkRight1, sprites.castle.skellyWalkRight2],\n    [img`\n\t        ........................\n\t        ........................\n\t        ........................\n\t        ........................\n\t        ..........ffff..........\n\t        ........ff1111ff........\n\t        .......fb111111bf.......\n\t        .......f11111111f.......\n\t        ......fd11111111df......\n\t        ......fd11111111df......\n\t        ......fd11111111df......\n\t        ......fb11111111bf......\n\t        ......fcd111111dcf......\n\t        .......fb111111bf.......\n\t        .....ffffdb1bdcfff......\n\t        ....fc111cfbfbc111cf....\n\t        ....f11111ffff11111f....\n\t        ....fbfbfbffffffbfbf....\n\t        .........ffffff.........\n\t        ..........fff...........\n\t        ........................\n\t        ........................\n\t        ........................\n\t        ........................\n\t    `],\n]\n\n//% whenUsed\nconst texturesPrincess = [\n    [sprites.castle.princessLeft0, sprites.castle.princessLeft1, sprites.castle.princessLeft0, sprites.castle.princessLeft2],\n    [sprites.castle.princessFront0, sprites.castle.princessFront1, sprites.castle.princessFront0, sprites.castle.princessFront2],\n    [],\n    [sprites.castle.princessBack0, sprites.castle.princessBack1, sprites.castle.princessBack0, sprites.castle.princessBack2],\n]\ntexturesPrincess[0].forEach((v, i) => {\n    texturesPrincess[2].push(v.clone())\n    texturesPrincess[2][i].flipX()\n}\n)\n\nfunction imagesFlipX(ani: Image[]) {\n    ani.forEach((img, i) => {\n        ani[i] = img.clone() //don't worry memery leak or waste, cause old images are still using by left\n        ani[i].flipX()\n    })\n}\n\n//////////////////////// end of animation.ts contents of previous version //////////////\n\n","docs/get-render-sprite-variable.md":"# get Render Sprite Variable\n\nGet the render Sprite, which create automatically, for physical collisions, and holding the view point.\n\n```sig\nRender.getRenderSpriteVariable()\n```\n\n## ~hint\n* You can consider it as \"myself\", and operate it like a usual sprite, eg.: position, speed, scale, collision, ... \n* But properties relative 3D, eg. ZOffset, ZPosition, viewAngle, and etc. are not in the Sprite class.\n## ~\n\n## Parameters\n\n* none\n\n## Returns\n\n* a game [sprite](/types/sprite) which raycasting render using for view point.\n\n## Example\n\n```blocks\nlet mySprite = Render.getRenderSpriteVariable()\nmySprite.setPosition(100,100)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/get-render-sprite-instance.md":"# get Render Sprite Instance\n\nGet the render Sprite, which create automatically, for physical collisions, and holding the view point.\n\n```sig\nRender.getRenderSpriteInstance()\n```\n\n## ~hint\n* You can consider it as \"myself\", and operate it like a usual sprite, eg.: position, speed, scale, collision, ... \n* But properties relative 3D, eg. ZOffset, ZPosition, viewAngle, and etc. are not in the Sprite class.\n## ~\n\n## Parameters\n\n* none\n\n## Returns\n\n* a game [sprite](/types/sprite) which raycasting render using for view point.\n\n## Example\n\n```blocks\nRender.getRenderSpriteInstance().setPosition(100,100)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/create-animations.md":"# create Animations\n\n * Create a directional image animations, multi animations will applied to one round dirctions averagely, start from the left. \n\n```sig\nRender.createAnimations(100,[sprites.food.smallDonut])\n```\n\n## ~hint\n * The reason that directions start from left, is almost all Arcade out-of-box 1 or 2-dirction images are facing left, so that would be convient for using.\n## ~\n\n## Parameters\n * **frameInterval** the time between changes, eg: 150\n * **frames1** animation, if this is the first of multi animation it will be used as left, others will \n * **frames2** optional, used for 2 or more dirctional\n * **frames3** optional, used for 3 or more dirctional\n * **frames4** optional, used for 4 or more dirctional\n\n## ~hint\n * 4 frames provided, animations would left, front, right, back side in order.\n * 2 frames provided, animations would left, right side in order.\n## ~\n\n\n## Returns\n\n* an Animations object that can be set to [Render.setSpriteAnimations(Animations)](docs/set-sprite-animations.md).\n\n## Example\n\n```blocks\nlet mySprite = Render.getRenderSpriteVariable()\nmySprite.setPosition(100,100)\nlet animations = Render.createAnimations(150, [img`\n    . . . f 4 4 f f f f . . . . . . \n    . . f 4 5 5 4 5 f b f f . . . . \n    . . f 5 5 5 5 4 e 3 3 b f . . . \n    . . f e 4 4 4 e 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e e 3 b e 3 3 3 3 f . . \n    . f 3 3 e e e f f 3 3 3 3 f . . \n    . f 3 e e e f b f b b b b f . . \n    . . f e 4 4 f 1 e b b b b f . . \n    . . . f 4 4 4 4 f b b b b f f . \n    . . . f e e e f f f b b b b f . \n    . . . f d d d e 4 4 f b b f . . \n    . . . f d d d e 4 4 e f f . . . \n    . . f b d b d b e e b f . . . . \n    . . f f 1 d 1 d 1 d f f . . . . \n    . . . . f f b b f f . . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . f 4 4 f f f f . . . . . . \n    . . f 4 5 5 4 5 f b f f . . . . \n    . . f 5 5 5 5 4 e 3 3 b f . . . \n    . . f e 4 4 4 e 3 3 3 3 b f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e e 3 b e 3 3 3 3 f . . \n    . f 3 3 e e e f f 3 3 3 3 f . . \n    . . f e e e f b f b b b b f f . \n    . . . e 4 4 f 1 e b b b b b f . \n    . . . f 4 4 4 4 f b b b b b f . \n    . . . f d d d e 4 4 b b b f . . \n    . . . f d d d e 4 4 f f f . . . \n    . . f d d d b b e e b b f . . . \n    . . f b d 1 d 1 d d b f . . . . \n    . . . f f f b b f f f . . . . . \n    `], [img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f 3 3 f f e e e e f f 3 3 f . \n    . f b b f b f e e f b f b b f . \n    . f b b e 1 f 4 4 f 1 e b b f . \n    f f b b f 4 4 4 4 4 4 f b b f f \n    f b b f f f e e e e f f f b b f \n    . f e e f b d d d d b f e e f . \n    . . e 4 c d d d d d d c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . f f . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . f e 3 3 3 3 3 3 3 3 3 3 e f . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f b 3 f f e e e e f f 3 b f . \n    f f b b f b f e e f b f b b f f \n    f b b b e 1 f 4 4 f 1 e b b b f \n    . f b b e e 4 4 4 4 4 f b b f . \n    . . f 4 4 4 e d d d b f e f . . \n    . . f e 4 4 e d d d d c 4 e . . \n    . . . f e e d d b d b b f e . . \n    . . . f f 1 d 1 d 1 1 f f . . . \n    . . . . . f f f b b f . . . . . \n    `,img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f 3 3 f f e e e e f f 3 3 f . \n    . f b b f b f e e f b f b b f . \n    . f b b e 1 f 4 4 f 1 e b b f . \n    f f b b f 4 4 4 4 4 4 f b b f f \n    f b b f f f e e e e f f f b b f \n    . f e e f b d d d d b f e e f . \n    . . e 4 c d d d d d d c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . f f . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . f e 3 3 3 3 3 3 3 3 3 3 e f . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f b 3 f f e e e e f f 3 b f . \n    f f b b f b f e e f b f b b f f \n    f b b b e 1 f 4 4 f 1 e b b b f \n    . f b b f 4 4 4 4 4 e e b b f . \n    . . f e f b d d d e 4 4 4 f . . \n    . . e 4 c d d d d e 4 4 e f . . \n    . . e f b b d b d d e e f . . . \n    . . . f f 1 1 d 1 d 1 f f . . . \n    . . . . . f b b f f f . . . . . \n    `], [img`\n    . . . . . . f f f f 4 4 f . . . \n    . . . . f f b f 5 4 5 5 4 f . . \n    . . . f b 3 3 e 4 5 5 5 5 f . . \n    . . f b 3 3 3 3 e 4 4 4 e f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . . f 3 3 3 3 e b 3 e e 3 3 f . \n    . . f 3 3 3 3 f f e e e 3 3 f . \n    . . f b b b b f b f e e e 3 f . \n    . . f b b b b e 1 f 4 4 e f . . \n    . f f b b b b f 4 4 4 4 f . . . \n    . f b b b b f f f e e e f . . . \n    . . f b b f 4 4 e d d d f . . . \n    . . . f f e 4 4 e d d d f . . . \n    . . . . f b e e b d b d b f . . \n    . . . . f f d 1 d 1 d 1 f f . . \n    . . . . . . f f b b f f . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . . f f f f 4 4 f . . . \n    . . . . f f b f 5 4 5 5 4 f . . \n    . . . f b 3 3 e 4 5 5 5 5 f . . \n    . . f b 3 3 3 3 e 4 4 4 e f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 3 f . \n    . . f 3 3 3 3 e b 3 e e 3 3 f . \n    . . f 3 3 3 3 f f e e e 3 3 f . \n    . f f b b b b f b f e e e f . . \n    . f b b b b b e 1 f 4 4 e . . . \n    . f b b b b b f 4 4 4 4 f . . . \n    . . f b b b 4 4 e d d d f . . . \n    . . . f f f 4 4 e d d d f . . . \n    . . . f b b e e b b d d d f . . \n    . . . . f b d d 1 d 1 d b f . . \n    . . . . . f f f b b f f f . . . \n    `], [img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 3 f . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b c f \n    f b b b b b b b b b b b b b b f \n    . f c c b b b b b b b b c c f . \n    . . e 4 c f f f f f f c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b f . \n    f b b b b b b b b b b b b c f . \n    f f b b b b b b b b b b c f . . \n    . f c c c f f f f f f f e c . . \n    . . . f b b d b d d e 4 4 e . . \n    . . . f f 1 1 d 1 d e e f . . . \n    . . . . . f b b f f f . . . . . \n    `,img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 3 f . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b c f \n    f b b b b b b b b b b b b b b f \n    . f c c b b b b b b b b c c f . \n    . . e 4 c f f f f f f c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    . f b b b b b b b b b b b b c f \n    . f c b b b b b b b b b b b b f \n    . . f c b b b b b b b b b b f f \n    . . c e f f f f f f f c c c f . \n    . . e 4 4 e d d b d b b f . . . \n    . . . f e e d 1 d 1 1 f f . . . \n    . . . . . f f f b b f . . . . . \n    `])\nRender.setSpriteAnimations(mySprite, animations)\n\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\nanimation\n```","docs/set-sprite-animations.md":"# set Sprite Animations\n\n * Apply a directional animations on a sprite\n\n```sig\nRender.setSpriteAnimations(Sprite, Render.Animations)\n```\n\n## Parameters\n * **sprite** the [sprite](/types/sprite) to animate on\n * **animations** the directional animates, created by [Render.createAnimations](docs/create-animations.md)\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nlet mySprite = Render.getRenderSpriteVariable()\nmySprite.setPosition(100,100)\nlet animations = Render.createAnimations(150, [img`\n    . . . f 4 4 f f f f . . . . . . \n    . . f 4 5 5 4 5 f b f f . . . . \n    . . f 5 5 5 5 4 e 3 3 b f . . . \n    . . f e 4 4 4 e 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e e 3 b e 3 3 3 3 f . . \n    . f 3 3 e e e f f 3 3 3 3 f . . \n    . f 3 e e e f b f b b b b f . . \n    . . f e 4 4 f 1 e b b b b f . . \n    . . . f 4 4 4 4 f b b b b f f . \n    . . . f e e e f f f b b b b f . \n    . . . f d d d e 4 4 f b b f . . \n    . . . f d d d e 4 4 e f f . . . \n    . . f b d b d b e e b f . . . . \n    . . f f 1 d 1 d 1 d f f . . . . \n    . . . . f f b b f f . . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . f 4 4 f f f f . . . . . . \n    . . f 4 5 5 4 5 f b f f . . . . \n    . . f 5 5 5 5 4 e 3 3 b f . . . \n    . . f e 4 4 4 e 3 3 3 3 b f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e e 3 b e 3 3 3 3 f . . \n    . f 3 3 e e e f f 3 3 3 3 f . . \n    . . f e e e f b f b b b b f f . \n    . . . e 4 4 f 1 e b b b b b f . \n    . . . f 4 4 4 4 f b b b b b f . \n    . . . f d d d e 4 4 b b b f . . \n    . . . f d d d e 4 4 f f f . . . \n    . . f d d d b b e e b b f . . . \n    . . f b d 1 d 1 d d b f . . . . \n    . . . f f f b b f f f . . . . . \n    `], [img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f 3 3 f f e e e e f f 3 3 f . \n    . f b b f b f e e f b f b b f . \n    . f b b e 1 f 4 4 f 1 e b b f . \n    f f b b f 4 4 4 4 4 4 f b b f f \n    f b b f f f e e e e f f f b b f \n    . f e e f b d d d d b f e e f . \n    . . e 4 c d d d d d d c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . f f . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . f e 3 3 3 3 3 3 3 3 3 3 e f . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f b 3 f f e e e e f f 3 b f . \n    f f b b f b f e e f b f b b f f \n    f b b b e 1 f 4 4 f 1 e b b b f \n    . f b b e e 4 4 4 4 4 f b b f . \n    . . f 4 4 4 e d d d b f e f . . \n    . . f e 4 4 e d d d d c 4 e . . \n    . . . f e e d d b d b b f e . . \n    . . . f f 1 d 1 d 1 1 f f . . . \n    . . . . . f f f b b f . . . . . \n    `,img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f 3 3 f f e e e e f f 3 3 f . \n    . f b b f b f e e f b f b b f . \n    . f b b e 1 f 4 4 f 1 e b b f . \n    f f b b f 4 4 4 4 4 4 f b b f f \n    f b b f f f e e e e f f f b b f \n    . f e e f b d d d d b f e e f . \n    . . e 4 c d d d d d d c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . f f . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . f e 3 3 3 3 3 3 3 3 3 3 e f . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f b 3 f f e e e e f f 3 b f . \n    f f b b f b f e e f b f b b f f \n    f b b b e 1 f 4 4 f 1 e b b b f \n    . f b b f 4 4 4 4 4 e e b b f . \n    . . f e f b d d d e 4 4 4 f . . \n    . . e 4 c d d d d e 4 4 e f . . \n    . . e f b b d b d d e e f . . . \n    . . . f f 1 1 d 1 d 1 f f . . . \n    . . . . . f b b f f f . . . . . \n    `], [img`\n    . . . . . . f f f f 4 4 f . . . \n    . . . . f f b f 5 4 5 5 4 f . . \n    . . . f b 3 3 e 4 5 5 5 5 f . . \n    . . f b 3 3 3 3 e 4 4 4 e f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . . f 3 3 3 3 e b 3 e e 3 3 f . \n    . . f 3 3 3 3 f f e e e 3 3 f . \n    . . f b b b b f b f e e e 3 f . \n    . . f b b b b e 1 f 4 4 e f . . \n    . f f b b b b f 4 4 4 4 f . . . \n    . f b b b b f f f e e e f . . . \n    . . f b b f 4 4 e d d d f . . . \n    . . . f f e 4 4 e d d d f . . . \n    . . . . f b e e b d b d b f . . \n    . . . . f f d 1 d 1 d 1 f f . . \n    . . . . . . f f b b f f . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . . f f f f 4 4 f . . . \n    . . . . f f b f 5 4 5 5 4 f . . \n    . . . f b 3 3 e 4 5 5 5 5 f . . \n    . . f b 3 3 3 3 e 4 4 4 e f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 3 f . \n    . . f 3 3 3 3 e b 3 e e 3 3 f . \n    . . f 3 3 3 3 f f e e e 3 3 f . \n    . f f b b b b f b f e e e f . . \n    . f b b b b b e 1 f 4 4 e . . . \n    . f b b b b b f 4 4 4 4 f . . . \n    . . f b b b 4 4 e d d d f . . . \n    . . . f f f 4 4 e d d d f . . . \n    . . . f b b e e b b d d d f . . \n    . . . . f b d d 1 d 1 d b f . . \n    . . . . . f f f b b f f f . . . \n    `], [img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 3 f . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b c f \n    f b b b b b b b b b b b b b b f \n    . f c c b b b b b b b b c c f . \n    . . e 4 c f f f f f f c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b f . \n    f b b b b b b b b b b b b c f . \n    f f b b b b b b b b b b c f . . \n    . f c c c f f f f f f f e c . . \n    . . . f b b d b d d e 4 4 e . . \n    . . . f f 1 1 d 1 d e e f . . . \n    . . . . . f b b f f f . . . . . \n    `,img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 3 f . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b c f \n    f b b b b b b b b b b b b b b f \n    . f c c b b b b b b b b c c f . \n    . . e 4 c f f f f f f c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    . f b b b b b b b b b b b b c f \n    . f c b b b b b b b b b b b b f \n    . . f c b b b b b b b b b b f f \n    . . c e f f f f f f f c c c f . \n    . . e 4 4 e d d b d b b f . . . \n    . . . f e e d 1 d 1 1 f f . . . \n    . . . . . f f f b b f . . . . . \n    `])\nRender.setSpriteAnimations(mySprite, animations)\n\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\nanimation\n```","docs/toggle-view-mode.md":"# toggle View Mode\n\n * Toggle current view mode, between tilemapView & raycastingView \n\n```sig\nRender.toggleViewMode()\n```\n\n## ~hint\n * The raycastingView: rendered by raycasting, 3D (or aka 2.5D) \n * The tilemapView: traditional flat tilemap, 2D\n * By default this render working in raycastingView, and can be switch to tilemapView any time, or switch back to raycastingView any time.\n * Could place inside the [on Event of Button](/reference/controller/button/on-event) block, for switch view mode back and forth.\n## ~\n\n## Parameters\n* none\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.toggleViewMode()\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/is-view-mode.md":"# is View Mode\n\n *  Current view mode is the specific one?\n\n```sig\nRender.isViewMode()\n```\n\n## ~hint\n * The raycastingView: rendered by raycasting, 3D (or aka 2.5D) \n * The tilemapView: traditional flat tilemap, 2D\n * By default this render working in raycastingView, and can be switch to tilemapView any time, or switch back to raycastingView any time.\n * According result switch difference background image.\n## ~\n\n## Parameters\n* **viewMode** raycastingView or tilemapView\n\n## Returns\n\n* a [boolean](types/boolean): true if current view mode is specific one.\n\n## Example\n\n```blocks\ncontroller.menu.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.toggleViewMode()\n    if (Render.isViewMode(ViewMode.tilemapView)) {\n        scene.setBackgroundImage(img`\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            `)\n    } else {\n        scene.setBackgroundImage(img`\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            `)\n    }\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-view-mode.md":"# set View Mode\n\n * set current view mode to tilemapView or raycastingView \n\n```sig\nRender.setViewMode()\n```\n\n## ~hint\n * The raycastingView: rendered by raycasting, 3D (or aka 2.5D) \n * The tilemapView: traditional flat tilemap, 2D\n * By default this render working in raycastingView, and can be switch to tilemapView any time, or switch back to raycastingView any time.\n * Could place inside the [on Event of Button](/reference/controller/button/on-event) block, with Pressed/Released, for switch view mode back and forth.\n## ~\n\n## Parameters\n* **viewMode** raycastingView or tilemapView\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\ncontroller.menu.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.setViewMode(ViewMode.tilemapView)\n})\ncontroller.menu.onEvent(ControllerButtonEvent.Released, function () {\n    Render.setViewMode(ViewMode.raycastingView)\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/get-attribute.md":"# get Attribute\n\n * Get render arribute\n\n```sig\nRender.getAttribute()\n```\n\n\n## Parameters\n* **attribute**  dirX,dirY,fov,wallZScale\n## ~hint\n * **dirX**: view direction x\n * **dirY**: view direction y\n * **fov**:  field of view, for zoom in/out, default value can be get by [defaultFov](docs/default-fov.md)\n * **wallZScale**: scale up/down height of walls in z dimension, this is a radio value, default is 1.\n## ~\n\n## Returns\n\n* value according to specific \n\n## Example\n\n```blocks\nlet v=Render.getAttribute(Render.attribute.fov)/2\nRender.SetAttribute(Render.attribute.fov, v)\n)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-attribute.md":"# set Attribute\n\n * Set render arribute\n\n```sig\nRender.setAttribute()\n```\n\n\n## Parameters\n* **attribute**  dirX,dirY,fov,wallZScale\n* **value**\n## ~hint\n * **dirX**: view direction x\n * **dirY**: view direction y\n * **fov**:  field of view, for zoom in/out, default value can be get by [defaultFov](/default-fov)\n * **wallZScale**: scale up/down height of walls in z dimension, this is a radio value, default is 1.\n## ~\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nRender.setAttribute(Render.attribute.fov, Render.getAttribute(Render.attribute.fov)/2)\n)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/get-default-fov.md":"# get Default Fov\n\n * Get default FOV (field of view) value\n\n```sig\nRender.getDefaultFov()\n```\n\n\n## Parameters\n* none\n\n## Returns\n\n* The default fov(field of view) value, is 0.666... (or 2/3)\n\n    ## ~hint\n    * field of view, for zoom in/out\n    * it is a ratio of view plane vector x & y, or \"half view width\" and \"distance to view plane\"\n    * if you facing the wall and 1 wall height a way from it, just seeing wall full fill the screen in vertical direction, the distance=screen.height, so for arcade screen that is: 160/2 /120 = 2/3.\n    * so, half default will zoom in x2, while double default value means very wide( x2 ) field of view\n    ## ~\n\n## Example\n\n```blocks\n\ntiles.setCurrentTilemap(tilemap`level1`)\n\nlet v=Render.getDefaultFov()/2\nRender.SetAttribute(Render.attribute.fov, v)\n)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-view-angle-in-degree.md":"# set View Angle In Degree\n\n * Set view angle\n\n```sig\nRender.setViewAngleInDegree()\n```\n\n## Parameters\n* **angle** angle value 0~360 Â°\n## ~hint\n * angle=0 facing east, 90 facing south; 180 facing west; 270 facing north\n## ~\n\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nRender.setViewAngleInDegree(180)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-view-angle.md":"# set View Angle\n\n * Set view angle\n\n```sig\nRender.setViewAngle()\n```\n\n## Parameters\n* **dirX** facing dirction vector x\n* **dirY** facing dirction vector Y\n## ~hint\n * x=1 y=0 facing east;\n * x=0 y=1 facing south;\n * x=-1 y=0 facing west;\n * x=0 y=-1 facing north\n * dirX/Y values can be any number, not limited in -1,0,1\n * inside, the angle of view = Math.atan2(dirY,dirX)\n## ~\n\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nRender.setViewAngle(0,-1)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-z-offset.md":"# set Z Offset\n\n * Set floating offset height for a sprite at Z direction\n\n```sig\nRender.setZOffset()\n```\n\n\n## Parameters\n* **sprite** the [sprite](/types/sprite) to be set\n* **Zoffset** in pixels, negative floats down, affirmative goes up\n* **duration** moving time, if new value diff from current position at Z dimension. 0 for immediately, unit: ms\n## ~hint\n    * the myself sprite can also be set Z Offset value.\n## ~\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nRender.setZOffset(mySprite, 8)\nRender.setZOffset(Render.getRenderSpriteInstance(), 8)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/is-sprites-overlap-z.md":"# is Sprite Overlap Z\n\n * Check if 2 sprites overlaps each another in Z dimension\n\n```sig\nRender.isSpritesOverlapZ()\n```\n\n\n## Parameters\n* **sprite1** [sprite](/types/sprite) to check with\n* **sprite2** [sprite](/types/sprite) to check with\n## ~hint\n * Best work together with sprites.onOverlap(kind1, kind2), which check overlaping in X&Y dimension\n## ~\n\n## Returns\n\n* a [boolean](types/boolean): true if overlaped at Z dimension, nothing todo with X Y dimension\n\n## Example\n\n```blocks\nsprites.onOverlap(SpriteKind.Enemy, SpriteKind.Projectile, function (sprite, otherSprite) {\n    if (Render.isSpritesOverlapZ(sprite, otherSprite)) {\n        otherSprite.destroy()\n        info.changeScoreBy(1)\n    }\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/jump-with-height-and-duration.md":"# jump With Height And Duration\n\n * Make sprite jump, with specific height and duration\n\n```sig\nRender.jumpWithHeightAndDuration()\n```\n\n\n## Parameters\n* **sprite**\n* **height** jump height in pixel\n* **duration** hover time span, unit: ms\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\ncontroller.B.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.jumpWithHeightAndDuration(Render.getRenderSpriteInstance(), 8, 500)\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/jump.md":"# jump\n\n * Make sprite jump, with specific speed and acceleration\n * Simular with Move block, but jump can only happened when sprite is standing, current height = its offset.\n\n```sig\nRender.jump()\n```\n\n\n## Parameters\n* **sprite**\n* **v** vetical speed, unit: pixel/s\n* **a** vetical acceleration, unit: pixel/sÂ²\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\ncontroller.B.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.jump(mySprite)\n    Render.jump(mySprite, 60, -200)\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/move.md":"# move\n\n * Make sprite jump, with specific speed and acceleration\n * Simular with jump block, but jump can only happened when sprite is standing, current height = its offset.\n\n```sig\nRender.move()\n```\n\n\n## Parameters\n* **sprite**\n* **v** vetical speed, unit: pixel/s\n* **a** vetical acceleration, unit: pixel/sÂ²\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\ncontroller.B.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.move(mySprite, 60, -200)\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/move-with-controller.md":"# move With Controller\n\n* Control the self sprite using the arrow buttons from the controller. \n* To stop controlling self sprite, pass 0 for v and va.\n\n```sig\nRender.moveWithController()\n```\n\n\n## Parameters\n * **v** The velocity used for forward/backword movement when up/down is pressed, in pixel/s\n * **va** The angle velocity used for turn view direction when left/right is pressed, in radian/s.\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nRender.moveWithController(2, 3)\n```\n\nFor disable moving control inside the extension:\n```blocks\nRender.moveWithController(0, 0)\ncontroller.moveSprite(Render.getRenderSpriteInstance(), 100, 100)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/takeover-scene-sprites.md":"# takeover Scene Sprites\n\n* Render takeover all sprites in current scene\n\n```sig\nRender.takeoverSceneSprites()\n```\n\n## ~hint\n* Render will call this automatically, so not required usually.\n* Call this just after created the sprite, only if you saw sprite draw at its tilemap position on screen\n## ~\n\n## Parameters\n* none\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nlet mySprite = sprites.create(img`\n    . . . . . . . . . . b 5 b . . . \n    . . . . . . . . . b 5 b . . . . \n    . . . . . . b b b b b b . . . . \n    . . . . . b b 5 5 5 5 5 b . . . \n    . . . . b b 5 d 1 f 5 d 4 c . . \n    . . . . b 5 5 1 f f d d 4 4 4 b \n    . . . . b 5 5 d f b 4 4 4 4 b . \n    . . . b d 5 5 5 5 4 4 4 4 b . . \n    . b b d d d 5 5 5 5 5 5 5 b . . \n    b d d d b b b 5 5 5 5 5 5 5 b . \n    c d d b 5 5 d c 5 5 5 5 5 5 b . \n    c b b d 5 d c d 5 5 5 5 5 5 b . \n    c b 5 5 b c d d 5 5 5 5 5 5 b . \n    b b c c c d d d 5 5 5 5 5 d b . \n    . . . . c c d d d 5 5 5 b b . . \n    . . . . . . c c c c c b b . . . \n    `, SpriteKind.Player)\nRender.takeoverSceneSprites()\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/register-on-sprite-direction-update-handler.md":"# register On Sprite Direction Update Handler\n\n* Run on sprite dirction updated, present view point to Sprite facing dirction, or which angle you see of the sprite.\n\n```sig\nRender.registerOnSpriteDirectionUpdateHandler()\n```\n\n## ~hint\n* Not required, if you have used the set animations block provided.\n* Used for working with other animation extensions, to set proper Image for sprite according to current seeing direction.\n## ~\n\n## Parameters\n  * **dir** It is a float number, 0 ~ 1 corresponds to 0 ~ 360Â°, suggest use Math.round(dir*dirAniTotalCount)%dirAniTotalCount to get index of direction\n## Returns\n\n* none\n\n## Example\n\n```blocks\nlet mySprite = sprites.create(img`\n    . . . . . . . . . . b 5 b . . . \n    . . . . . . . . . b 5 b . . . . \n    . . . . . . b b b b b b . . . . \n    . . . . . b b 5 5 5 5 5 b . . . \n    . . . . b b 5 d 1 f 5 d 4 c . . \n    . . . . b 5 5 1 f f d d 4 4 4 b \n    . . . . b 5 5 d f b 4 4 4 4 b . \n    . . . b d 5 5 5 5 4 4 4 4 b . . \n    . b b d d d 5 5 5 5 5 5 5 b . . \n    b d d d b b b 5 5 5 5 5 5 5 b . \n    c d d b 5 5 d c 5 5 5 5 5 5 b . \n    c b b d 5 d c d 5 5 5 5 5 5 b . \n    c b 5 5 b c d d 5 5 5 5 5 5 b . \n    b b c c c d d d 5 5 5 5 5 d b . \n    . . . . c c d d d 5 5 5 b b . . \n    . . . . . . c c c c c b b . . . \n    `, SpriteKind.Player)\nlet list = [\n    img`\n        . . . . . . f f f f . . . . . . \n        . . . . f f f 2 2 f f f . . . . \n        . . . f f f 2 2 2 2 f f f . . . \n        . . f f f e e e e e e f f f . . \n        . . f f e 2 2 2 2 2 2 e e f . . \n        . . f e 2 f f f f f f 2 e f . . \n        . . f f f f e e e e f f f f . . \n        . f f e f b f 4 4 f b f e f f . \n        . f e e 4 1 f d d f 1 4 e e f . \n        . . f e e d d d d d d e e f . . \n        . . . f e e 4 4 4 4 e e f . . . \n        . . e 4 f 2 2 2 2 2 2 f 4 e . . \n        . . 4 d f 2 2 2 2 2 2 f d 4 . . \n        . . 4 4 f 4 4 5 5 4 4 f 4 4 . . \n        . . . . . f f f f f f . . . . . \n        . . . . . f f . . f f . . . . . \n        `,\n    img`\n        . . . . . . . . . . . . . . . . \n        . . . . . . f f f f . . . . . . \n        . . . . f f f 2 2 f f f . . . . \n        . . . f f f 2 2 2 2 f f f . . . \n        . . f f f e e e e e e f f f . . \n        . . f f e 2 2 2 2 2 2 e e f . . \n        . f f e 2 f f f f f f 2 e f f . \n        . f f f f f e e e e f f f f f . \n        . . f e f b f 4 4 f b f e f . . \n        . . f e 4 1 f d d f 1 4 e f . . \n        . . . f e 4 d d d d 4 e f e . . \n        . . f e f 2 2 2 2 e d d 4 e . . \n        . . e 4 f 2 2 2 2 e d d e . . . \n        . . . . f 4 4 5 5 f e e . . . . \n        . . . . f f f f f f f . . . . . \n        . . . . f f f . . . . . . . . . \n        `,\n    img`\n        . . . . . . f f f f . . . . . . \n        . . . . f f f 2 2 f f f . . . . \n        . . . f f f 2 2 2 2 f f f . . . \n        . . f f f e e e e e e f f f . . \n        . . f f e 2 2 2 2 2 2 e e f . . \n        . . f e 2 f f f f f f 2 e f . . \n        . . f f f f e e e e f f f f . . \n        . f f e f b f 4 4 f b f e f f . \n        . f e e 4 1 f d d f 1 4 e e f . \n        . . f e e d d d d d d e e f . . \n        . . . f e e 4 4 4 4 e e f . . . \n        . . e 4 f 2 2 2 2 2 2 f 4 e . . \n        . . 4 d f 2 2 2 2 2 2 f d 4 . . \n        . . 4 4 f 4 4 5 5 4 4 f 4 4 . . \n        . . . . . f f f f f f . . . . . \n        . . . . . f f . . f f . . . . . \n        `,\n    img`\n        . . . . . . . . . . . . . . . . \n        . . . . . . f f f f . . . . . . \n        . . . . f f f 2 2 f f f . . . . \n        . . . f f f 2 2 2 2 f f f . . . \n        . . f f f e e e e e e f f f . . \n        . . f e e 2 2 2 2 2 2 e f f . . \n        . f f e 2 f f f f f f 2 e f f . \n        . f f f f f e e e e f f f f f . \n        . . f e f b f 4 4 f b f e f . . \n        . . f e 4 1 f d d f 1 4 e f . . \n        . . e f e 4 d d d d 4 e f . . . \n        . . e 4 d d e 2 2 2 2 f e f . . \n        . . . e d d e 2 2 2 2 f 4 e . . \n        . . . . e e f 5 5 4 4 f . . . . \n        . . . . . f f f f f f f . . . . \n        . . . . . . . . . f f f . . . . \n        `\n    ]\nRender.registerOnSpriteDirectionUpdateHandler(function (spr, dir) {\n    let FrameIndex = Math.round(dir * list.length) % list.length\n    mySprite.setImage(list[FrameIndex])\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```\n","docs/get-sprite-attribute.md":"# get Sprite Attribute\n\n * Get arribute of a sprite\n\n```sig\nRender.getSpriteAttribute()\n```\n\n\n## Parameters\n* **RCSpriteAttribute**  \n## ~hint\n * **ZOffset**: make sprite float from ground, unit: pixel\n * **ZPosition**: current position in Z dimension, unit: pixel, modified by move() or jump(). Equal to ZOffset when stand still.\n * **ZVelocity**: Velocity for move/jump\n * **ZAcceleration**: Acceleration for move/jump\n## ~\n\n## Returns\n\n* value according to specific \n\n## Example\n\n```blocks\nlet mySprite=sprites.create(img`0`, SpriteKind.Player)\nlet v=Render.getSpriteAttribute(mySprite, RCSpriteAttribute.ZOffset)/2\nRender.setSpriteAttribute(mySprite, RCSpriteAttribute.ZOffset, v)\n)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-sprite-attribute.md":"# set Sprite Attribute\n\n * Set arribute of a sprite\n\n```sig\nRender.setSpriteAttribute()\n```\n\n\n## Parameters\n* **spr**: a Sprite\n* **RCSpriteAttribute**:\n## ~hint\n * **ZOffset**: make sprite float from ground, unit: pixel\n * **ZPosition**: current position in Z dimension, unit: pixel, modified by move() or jump(). Equal to ZOffset when stand still.\n * **ZVelocity**: Velocity for move/jump\n * **ZAcceleration**: Acceleration for move/jump\n## ~\n\n## Returns\n\n* value according to specific \n\n## Example\n\n```blocks\nlet mySprite=sprites.create(img`0`, SpriteKind.Player)\nlet v=Render.getSpriteAttribute(mySprite, RCSpriteAttribute.ZOffset)/2\nRender.setSpriteAttribute(mySprite, RCSpriteAttribute.ZOffset, v)\n)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","pxt.json":"{\n    \"name\": \"Isometric by AqeeAqee\",\n    \"version\": \"0.3.18\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"device\": \"*\"\n    },\n    \"files\": [\n        \"README.md\",\n        \"render_raycasting.ts\",\n        \"render_blocks.ts\",\n        \"animation.ts\",\n        \"docs/get-render-sprite-variable.md\",\n        \"docs/get-render-sprite-instance.md\",\n        \"docs/create-animations.md\",\n        \"docs/set-sprite-animations.md\",\n        \"docs/toggle-view-mode.md\",\n        \"docs/is-view-mode.md\",\n        \"docs/set-view-mode.md\",\n        \"docs/get-attribute.md\",\n        \"docs/set-attribute.md\",\n        \"docs/get-default-fov.md\",\n        \"docs/set-view-angle-in-degree.md\",\n        \"docs/set-view-angle.md\",\n        \"docs/set-z-offset.md\",\n        \"docs/is-sprites-overlap-z.md\",\n        \"docs/jump-with-height-and-duration.md\",\n        \"docs/jump.md\",\n        \"docs/move.md\",\n        \"docs/move-with-controller.md\",\n        \"docs/takeover-scene-sprites.md\",\n        \"docs/register-on-sprite-direction-update-handler.md\",\n        \"docs/get-sprite-attribute.md\",\n        \"docs/set-sprite-attribute.md\"\n    ],\n    \"testFiles\": [\n        \"main.ts\",\n        \"tilemap.g.jres\",\n        \"tilemap.g.ts\",\n        \"images.g.jres\",\n        \"images.g.ts\"\n    ],\n    \"targetVersions\": {\n        \"branch\": \"v0.14.3\",\n        \"tag\": \"v0.14.3\",\n        \"commits\": \"https://github.com/microsoft/pxt-arcade/commits/aef27bb278de89a83ecb6ab02af5319c06d617e2\",\n        \"target\": \"1.12.39\",\n        \"pxt\": \"5.21.6\",\n        \"targetId\": \"arcade\"\n    },\n    \"supportedTargets\": [\n        \"arcade\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n","main.ts":"        \ngame.stats = true\nconst rcRender = Render.raycastingRender\n// Render.moveWithController(1.5,2,1)\n\n// let trans16 = image.create(16, 16)\n\nRender.setSpriteAnimations(rcRender.sprSelf, Render.createAnimations(150, assets.animation`heroWalk`))\n\nconst tm = tiles.createTilemap(hex`1000100003040506070102010201020102010201010201020102010201020102010201020201020102010201020102010201020101020102010201020102010201020102020102010201020102010201020102010102010201020102010201020102010202010201020102010201020102010201010201020102010201020102010201020201020102010201020102010201020101020102010201020102010201020102020102010201020102010201020102010102010201020102010201020102010202010201020102010201020102010201010201020102010201020102010201020201020102010201020102010201020101020102010201020102010201020102`, img`\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . 2 2 2 2 . . 2 2 2 2 . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . 2 . . . . . . . . 2 . . .\n    . . . 2 2 2 2 . . 2 2 2 2 . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n    . . . . . . . . . . . . . . . .\n`, [myTiles.transparency16,myTiles.tile3,myTiles.tile4,sprites.castle.tileGrass2,sprites.castle.tilePath5,sprites.vehicle.roadVertical,sprites.vehicle.roadHorizontal,sprites.dungeon.chestClosed], TileScale.Sixteen);\n// tiles.setCurrentTilemap(tm)\n// const spawnTile = myTiles.tile4\n\ntiles.setCurrentTilemap(tilemap`level1`)\nconst spawnTile = sprites.castle.tileDarkGrass3\n\nconst tilemapScale = 1 << game.currentScene().tileMap.scale\nrcRender.sprSelf.setPosition(8 * tilemapScale, 8 * tilemapScale)\n\n// effects.blizzard.startScreenEffect(99999999, 99)\n\nlet count = 0\nfunction createSprite(x: number, y: number, vx: number, vy: number, textures: Image[][], kind: number) {\n    const spr = sprites.create(textures[0][0], kind)\n    // rcRender.takeoverSceneSprites()\n    const tilemapScale = 1 << game.currentScene().tileMap.scale\n    spr.setPosition(x * tilemapScale, y * tilemapScale)\n    spr.setVelocity(vx, vy)\n    spr.setBounceOnWall(true)\n    spr.setScale(0.5)\n    // setCharacterAnimationForSprite(spr, textures)\n    Render.setSpriteAnimations(spr, Render.createAnimations(150, textures[0], textures[1], textures[2], textures[3]))\n    // if (kind == SpriteKind.Enemy)\n    //     tiles.placeOnRandomTile(spr, trans16)\n    spr.sayText(spr.id + \" test\\n test\", 9999)\n    // spr.startEffect(effects.fountain,9999)\n\n    return spr\n}\n\n// 0<= dir <1, then may be added by 2 for avoid negative\n// rcRender.registerOnSpriteDirectionUpdate((spr, dir) => {\n//     // character.setCharacterState(spr, character.rule(characterAniDirs[Math.floor(dir * 4 + .5) % 4]))\n// })\n\n// createSprite(8, 7, 6, 10, texturesDuck, SpriteKind.Enemy)\n// createSprite(6, 7, 6, 10, texturesDonut, SpriteKind.Enemy)\n// createSprite(5, 8, 6, 10, texturesDog, SpriteKind.Enemy)\nlet sprPriness2 = createSprite(11, 8, 6, 10, texturesPrincess2, SpriteKind.Enemy)\n// let sprHero = createSprite(10, 8, 6, 10, texturesHero, SpriteKind.Enemy)\nlet sprSkelly = createSprite(9, 9, 6, 10, texturesSkelly, SpriteKind.Enemy)\nlet sprPriness = createSprite(10, 7, 6, 10, texturesPrincess, SpriteKind.Enemy)\nlet sprPlane = createSprite(9, 7, 6, 10, texturesPlane, SpriteKind.Enemy)\n// let cake = createSprite(2, 2, 4, 2, texturesBigCake, SpriteKind.Enemy)\nlet fish = createSprite(7, 9, 0, 0, texturesFish, SpriteKind.Enemy)\n\nsprSkelly.startEffect(effects.fire, 9999999)\n\nRender.setSpriteAttribute(sprSkelly, RCSpriteAttribute.ZOffset, 4)\nRender.setSpriteAttribute(sprPlane, RCSpriteAttribute.ZOffset, 16)\n// Render.setSpriteAttribute(cake, RCSpriteAttribute.ZOffset, 4)\nRender.setSpriteAttribute(fish, RCSpriteAttribute.ZOffset, 8)\n\nfunction createCoin(){\n    let spr=createSprite(4, 7, Math.randomRange(5,10), Math.randomRange(3,10), texturesCoin, SpriteKind.Food)\n    tiles.placeOnRandomTile(spr, spawnTile)\n    rcRender.setZOffset(spr,.25)\n}\n\n//test for RelativeToCamera\n// game.onUpdateInterval(3000, ()=>{\n//     cake.setFlag(SpriteFlag.RelativeToCamera, !(cake.flags&SpriteFlag.RelativeToCamera))\n// })\n\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, () => {\n    music.pewPew.play()\n    let s = sprites.createProjectileFromSprite(sprites.projectile.bubble1, rcRender.sprSelf, rcRender.dirX * 55, rcRender.dirY * 55)\n    s.setScale(0.25)\n    rcRender.setZOffset(s, rcRender.getMotionZPosition(rcRender.sprSelf) + 2)  //todo, use VP height\n})\n\nsprites.onOverlap(SpriteKind.Enemy, SpriteKind.Projectile, function (sprite, otherSprite) {\n    if (!rcRender.isOverlapZ(sprite, otherSprite)) return\n\n    sprite.setVelocity(0, 0)\n    sprite.sayText(\"No!\", 2000)\n    rcRender.move(sprite, 60, -160)\n    // rcRender.setZOffset(sprite, 0)\n    music.baDing.play()\n    // sprite.setKind(SpriteKind.Food)\n    otherSprite.destroy()\n    // Render.setSpriteAnimations(sprite, new Render.Animations(120, texturesCoin))\n    // sprite.setImage(sprites.builtin.coin0)\n    sprite.setScale(.5)\n    sprite.startEffect(effects.fire, 3000)\n    // tiles.placeOnRandomTile(sprite, spawnTile)\n    // sprite.setVelocity(Math.randomRange(4,10), Math.randomRange(4,10))\n    createCoin()\n    // game.showLongText(sprite.id+\" \"+otherSprite.id, DialogLayout.Bottom)\n})\n\nsprites.onOverlap(SpriteKind.Enemy, SpriteKind.Food, function (sprite, otherSprite) {\n    // music.pewPew.play()\n    // otherSprite.destroy()\n})\nsprites.onOverlap(SpriteKind.Enemy, SpriteKind.Enemy, function (sprite, otherSprite) {\n    if (!rcRender.isOverlapZ(sprite, otherSprite)) return\n\n    otherSprite.setVelocity(otherSprite.x - sprite.x, otherSprite.y - sprite.y)\n    sprite.setVelocity(-(otherSprite.x - sprite.x), -(otherSprite.y - sprite.y))\n})\n\nsprites.onOverlap(SpriteKind.Player, SpriteKind.Enemy, function (sprite, otherSprite) {\n    if (!rcRender.isOverlapZ(sprite, otherSprite)) return\n\n})\n\nsprites.onOverlap(SpriteKind.Player, SpriteKind.Food, function (sprite, otherSprite) {\n    if (!rcRender.isOverlapZ(sprite, otherSprite)) return\n\n    music.baDing.play()\n    info.changeScoreBy(1)\n\n    // tiles.placeOnRandomTile(otherSprite, sprites.skillmap.islandTile4)\n    // otherSprite.setVelocity(Math.randomRange(4, 10), Math.randomRange(4, 10))\n    otherSprite.destroy()\n})\n\ncontroller.menu.onEvent(ControllerButtonEvent.Pressed, () => {\n    Render.toggleViewMode()\n})\n\n\n\ncontroller.B.repeatDelay = 0\n\nlet isAdjusting = false\ncontroller.anyButton.onEvent(ControllerButtonEvent.Pressed, () => {\n    if (controller.B.isPressed()) {\n        if (controller.A.isPressed()) {\n            Render.moveWithController(0, 0)\n            isAdjusting = true\n        } else {\n            rcRender.jumpWithHeightAndDuration(rcRender.sprSelf, tilemapScale*2, 5000)\n        }\n    }\n})\ncontroller.B.onEvent(ControllerButtonEvent.Released, () => {\n    isAdjusting = false\n    Render.moveWithController(1.5, 2)\n})\ncontroller.A.onEvent(ControllerButtonEvent.Released, () => {\n    isAdjusting = false\n    Render.moveWithController(1.5, 2)\n})\n\ncontroller.up.onEvent(ControllerButtonEvent.Pressed, () => {\n    if (isAdjusting)\n    Render.changeScaleY(1)\n})\ncontroller.down.onEvent(ControllerButtonEvent.Pressed, () => {\n    if (isAdjusting)\n    Render.changeScaleY(-1)\n})\ncontroller.left.onEvent(ControllerButtonEvent.Pressed, () => {\n    if (isAdjusting)\n    Render.changeScale(-1)\n})\ncontroller.right.onEvent(ControllerButtonEvent.Pressed, () => {\n    if (isAdjusting)\n    Render.changeScale(1)\n})\n\n\nrcRender.wallZScale = 2\n\nlet zOffset = 3// tilemapScale / 2\n// rcRender.setZOffset(rcRender.sprSelf, zOffset, 0)\nlet fov = Render.defaultFov\ngame.onUpdate(() => {\n    if (false&&isAdjusting) {\n        // zOffset -= controller.dy(10)\n        // rcRender.setZOffset(rcRender.sprSelf, zOffset, 0)\n        fov -= controller.dy(1)\n        Render.setAttribute(Render.attribute.fov, fov)\n        info.setScore(zOffset * 100)\n    }\n})\n\n\n// controller.B.onEvent(ControllerButtonEvent.Pressed, () => {\n//     for (let fov = Render.defaultFov; fov > Render.defaultFov - .6; fov -= .06) {\n//         rcRender.fov=fov\n//         pause(20)\n//     }\n// })\n// controller.B.onEvent(ControllerButtonEvent.Released, () => {\n//     for (let fov = Render.defaultFov - .6; fov <= Render.defaultFov; fov += .06) {\n//         rcRender.fov=fov\n//         pause(20)\n//     }\n// })\n\n\n// const characterAniDirs = [Predicate.MovingLeft, Predicate.MovingDown, Predicate.MovingRight, Predicate.MovingUp]\n// function setCharacterAnimationForSprite(spr: Sprite, textures: Image[][]) {\n//     characterAniDirs.forEach((dir, i) => {\n//         character.loopFrames(spr, textures[Math.floor(i * textures.length / characterAniDirs.length)], 150, character.rule(dir))\n//     })\n// }\n// info.setScore(0)\ninfo.setLife(3)\n// let mySprite = sprites.create(sprites.builtin.computer1, SpriteKind.Player)\n// mySprite.setPosition(80,10)\n// mySprite.setFlag(SpriteFlag.RelativeToCamera, true)\n\n\n","tilemap.g.jres":"{\n    \"transparency16\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true\n    },\n    \"tile1\": {\n        \"data\": \"hwQQABAAAAAhUyFTIVMhUzIVMhUyFTIVUyFTIVMhUyEVMhUyFTIVMiFTIVMhUyFTMhUyFTIVMhVTIVMhUyFTIRUyFTIVMhUyIVMhUyFTIVMyFTIVMhUyFVMhUyFTIVMhFTIVMhUyFTIhUyFTIVMhUzIVMhUyFTIVUyFTIVMhUyEVMhUyFTIVMg==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"myTile\"\n    },\n    \"tile2\": {\n        \"data\": \"hwQQABAAAADdHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHQ==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"myTile0\"\n    },\n    \"tile3\": {\n        \"data\": \"hwQQABAAAABmZmZmZmZmZjYzMzMzMzNjNjMzMzMzM2M2MzMzMzMzYzYzMzMzMzNjNjMzMzMzM2M2MzMzMzMzYzYzMzMzMzNjNjMzMzMzM2M2MzMzMzMzYzYzMzMzMzNjNjMzMzMzM2M2MzMzMzMzYzYzMzMzMzNjNjMzMzMzM2NmZmZmZmZmZg==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"myTile1\"\n    },\n    \"tile4\": {\n        \"data\": \"hwQQABAAAAC7u7u7u7u7u3t3d3d3d3e3e3d3d3d3d7d7d3d3d3d3t3t3d3d3d3e3e3d3d3d3d7d7d3d3d3d3t3t3d3d3d3e3e3d3d3d3d7d7d3d3d3d3t3t3d3d3d3e3e3d3d3d3d7d7d3d3d3d3t3t3d3d3d3e3e3d3d3d3d7e7u7u7u7u7uw==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"myTile2\"\n    },\n    \"level1\": {\n        \"id\": \"level1\",\n        \"mimeType\": \"application/mkcd-tilemap\",\n        \"data\": \"MTAxMDAwMTAwMDAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwOTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwOTA5MDEwMTA5MDUwMjAyMDIwMjA0MDQwMjAyMDIwMjA2MDkwMTAxMDkwMzA5MDkwOTA5MDMwMzA5MDkwOTA5MDMwOTAxMDEwOTAzMDkwMTAxMDEwMzAzMDEwMTAxMDkwMzA5MDEwMTA5MDMwOTAxMDkwOTAzMDMwOTA5MDEwOTAzMDkwMTAxMDkwMzA5MDEwOTA5MDMwMzA5MDkwMTA5MDMwOTAxMDEwOTA4MDIwMjAyMDIwNzA4MDIwMjAyMDIwNzA5MDEwMTA5MDUwMjAyMDIwMjA2MDUwMjAyMDIwMjA2MDkwMTAxMDkwMzA5MDEwOTA5MDMwMzA5MDkwMTA5MDMwOTAxMDEwOTAzMDkwMTA5MDkwMzAzMDkwOTAxMDkwMzA5MDEwMTA5MDMwOTAxMDEwMTAzMDMwMTAxMDEwOTAzMDkwMTAxMDkwMzA5MDkwOTA5MDMwMzA5MDkwOTA5MDMwOTAxMDEwOTA4MDIwMjAyMDIwNzA4MDIwMjAyMDIwNzA5MDEwMTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMjIyMjIyMjIyMjIyMjIyMjAyMDAwMDAwMDAwMDAwMjAwMjAwMDAwMDAwMDAwMDIwMDIwMDAwMDAwMDAwMDAyMDAyMDAyMjAyMjAyMjAwMjAwMjAwMDIwMDAwMjAwMDIwMDIwMDAyMDAwMDIwMDAyMDAyMDAwMDAwMDAwMDAwMjAwMjAwMDAwMDAwMDAwMDIwMDIwMDAyMDAwMDIwMDAyMDAyMDAwMjAwMDAyMDAwMjAwMjAwMjIwMjIwMjIwMDIwMDIwMDAwMDAwMDAwMDAyMDAyMDAwMDAwMDAwMDAwMjAwMjAwMDAwMDAwMDAwMDIwMjIyMjIyMjIyMjIyMjIyMg==\",\n        \"tileset\": [\n            \"myTiles.transparency16\",\n            \"sprites.builtin.brick\",\n            \"sprites.vehicle.roadHorizontal\",\n            \"sprites.vehicle.roadVertical\",\n            \"sprites.vehicle.roadIntersection3\",\n            \"sprites.vehicle.roadTurn1\",\n            \"sprites.vehicle.roadTurn2\",\n            \"sprites.vehicle.roadTurn4\",\n            \"sprites.vehicle.roadTurn3\",\n            \"sprites.castle.tileDarkGrass3\"\n        ],\n        \"displayName\": \"level1\"\n    },\n    \"*\": {\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"dataEncoding\": \"base64\",\n        \"namespace\": \"myTiles\"\n    }\n}","tilemap.g.ts":"// Auto-generated code. Do not edit.\nnamespace myTiles {\n    //% fixedInstance jres blockIdentity=images._tile\n    export const transparency16 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile1 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile2 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile3 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile4 = image.ofBuffer(hex``);\n\n    helpers._registerFactory(\"tilemap\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"level1\":\n            case \"level1\":return tiles.createTilemap(hex`1000100001010101010101010101010101010101010909090909090909090909090909010109050202020204040202020206090101090309090909030309090909030901010903090101010303010101090309010109030901090903030909010903090101090309010909030309090109030901010908020202020708020202020709010109050202020206050202020206090101090309010909030309090109030901010903090109090303090901090309010109030901010103030101010903090101090309090909030309090909030901010908020202020708020202020709010109090909090909090909090909090101010101010101010101010101010101`, img`\n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . 2 2 2 . . 2 2 2 . . . 2 \n2 . . . 2 . . . . . . 2 . . . 2 \n2 . . . 2 . . . . . . 2 . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . 2 . . . . . . 2 . . . 2 \n2 . . . 2 . . . . . . 2 . . . 2 \n2 . . . 2 2 2 . . 2 2 2 . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 . . . . . . . . . . . . . . 2 \n2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 \n`, [myTiles.transparency16,sprites.builtin.brick,sprites.vehicle.roadHorizontal,sprites.vehicle.roadVertical,sprites.vehicle.roadIntersection3,sprites.vehicle.roadTurn1,sprites.vehicle.roadTurn2,sprites.vehicle.roadTurn4,sprites.vehicle.roadTurn3,sprites.castle.tileDarkGrass3], TileScale.Sixteen);\n        }\n        return null;\n    })\n\n    helpers._registerFactory(\"tile\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"transparency16\":return transparency16;\n            case \"myTile\":\n            case \"tile1\":return tile1;\n            case \"myTile0\":\n            case \"tile2\":return tile2;\n            case \"myTile1\":\n            case \"tile3\":return tile3;\n            case \"myTile2\":\n            case \"tile4\":return tile4;\n        }\n        return null;\n    })\n\n}\n// Auto-generated code. Do not edit.\n","images.g.jres":"{\n    \"image1\": {\n        \"data\": \"hwRAACAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAABXBwAAAAAAAAAAAAAAAAAAVwcAAAAAAAAAAAAAAAAAUHd3AAAAAAAAAAAAAAAAAFB3dwAAAAAAAAAAAAAAAABXd3cHAAAAAAAAAAAAAAAAV3d3BwAAAAAAAAAAAAAAcHd3d3cAAAAAAAAAAAAAAHB3d3d3AAAAAAAAAAAAAAB3d3FzcQcAAAAAAAAAAAAAd3dxc3EHAAAAAAAAAAAAcHcXERPRdwAAAAAAAAAAAHB3FxET0XcAAAAAAAAAAAB3dxcRFtF2BwAAAAAAAAAAd3cXERbRdgcAAAAAAAAAcHd3N2F2MXZ3AAAAAAAAAHB3dzdhdjF2dwAAAAAAAAB3d3c3YXcxdncHAAAAAAAAd3d3N2F3MXZ3BwAAAAAAcHd3dxcRF9F2d3cAAAAAAHB3d3cXERfRdnd3AAAAAAB3d3d3Fx0T3Xd3dwcAAAAAd3d3dxcdE913d3cHAAAAcHd3V3d3bWN9dxcXdwAAAHB3d1d3d21jfXcXF3cAAAB3d3dXdXdnZ3d3Fxd2BwAAd3d3V3V3Z2d3dxcXdgcAcBcXd3dld3d3d3cXF3Z3AHAXF3d3ZXd3d3d3Fxd2dwB3Fxd2d2d3d3FxdxcWd3cHdxcXdndnd3dxcXcXFnd3B3cXF3Z3d3d3cWF3d3Z3dwd3Fxd2d3d3d3Fhd3d2d3cHcBcWd3d1dXdxYXd3d3d1AHAXFnd3dXV3cWF3d3d3dQAAd3Z3d1VVd2Fxd3d3dwUAAHd2d3dVVXdhcXd3d3cFAABwd3d3VlZ3Z3d3d3d3AAAAcHd3d1ZWd2d3d3d3dwAAAAB3d3d2dnd3d3d3dwcAAAAAd3d3dnZ3d3d3d3cHAAAAAHB3d3dxc3F3d3d3AAAAAABwd3d3cXNxd3d3dwAAAAAAAHd3FxET0Xd3dwcAAAAAAAB3dxcRE9F3d3cHAAAAAAAAcHcXERbRdnd3AAAAAAAAAHB3FxEW0XZ3dwAAAAAAAAAAdzdhdjF2dwcAAAAAAAAAAHc3YXYxdncHAAAAAAAAAABwN2F3MXZ3AAAAAAAAAAAAcDdhdzF2dwAAAAAAAAAAAAAXERfRdgcAAAAAAAAAAAAAFxEX0XYHAAAAAAAAAAAAABAdE913AAAAAAAAAAAAAAAQHRPddwAAAAAAAAAAAAAAAG1jfQcAAAAAAAAAAAAAAABtY30HAAAAAAAAAAAAAAAAYGd3AAAAAAAAAAAAAAAAAGBndwAAAAAAAAAAAAAAAAAAdwcAAAAAAAAAAAAAAAAAAHcHAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAA\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"displayName\": \"shearDoubleX_reference\"\n    },\n    \"anim1\": {\n        \"namespace\": \"myAnimations\",\n        \"id\": \"anim1\",\n        \"mimeType\": \"application/mkcd-animation\",\n        \"data\": \"YzgwMDEwMDAxMDAwMDQwMDAwMDAwMGZmZmYwMDAwMDAwMDAwZmZlZWVlZmYwMDAwMDBmMGVlZmVlZmVlMGYwMDAwZmZmZjJmZjJmZmZmMDAwMGZmMmUyZWUyZTJmZjAwMDBlZmYyZjIyZjJmZmUwMDAwZmYyZmUyMmVmMmZmMDBmMGVmMmZlZmZlZjJmZTBmZjBlZWZmZWVlZWVmZWUwZjAwZWZlZWVlZWVlZWZlMDAwMGYwZWVlZWVlZWUwZjAwMDA0ZWZmZmZmZmZmZTQwMDAwZDQyZjIyMjJmMjRkMDAwMDQ0NGY0NDQ0ZjQ0NDAwMDAwMGYwZmZmZjBmMDAwMDAwMDBmMDBmZjAwZjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwZmZmZjAwMDAwMDAwMDBmZmVlZWVmZjAwMDAwMGYwZWVmZWVmZWUwZjAwMDBmMGZmMmZmMmZmMGYwMDAwZmYyZTJlZTJlMmZmMDAwMGVmZjJmMmZmZjJmZTAwMDBmZjJmZWYyZWYyZmYwMDAwZWZmMmVmMmVlZmZlMDBmMGVmZmZlZWZlZWVmZTBmZjBlZmVlZWVlZWVlZmUwZjAwZjBlZWVlZWVlZTBmMDAwMGUwZmZmZmZmZmZlNDAwMDA0MDJmMjIyMmRlNGQwMDAwZTBmZmZmZmZlZTA0MDAwMDAwZmYwZjAwMDAwMDAwMDAwMDAwZmZmZjAwMDAwMDAwMDBmZmVlZWVmZjAwMDAwMGYwZWVmZWVmZWUwZjAwMDBmZmZmMmZmMmZmZmYwMDAwZmYyZTJlZTJlMmZmMDAwMGVmZjJmMjJmMmZmZTAwMDBmZjJmZTIyZWYyZmYwMGYwZWYyZmVmZmVmMmZlMGZmMGVlZmZlZWVlZWZlZTBmMDBlZmVlZWVlZWVlZmUwMDAwZjBlZWVlZWVlZTBmMDAwMDRlZmZmZmZmZmZlNDAwMDBkNDJmMjIyMmYyNGQwMDAwNDQ0ZjQ0NDRmNDQ0MDAwMDAwZjBmZmZmMGYwMDAwMDAwMGYwMGZmMDBmMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBmZmZmMDAwMDAwMDAwMGZmZWVlZWZmMDAwMDAwZjBlZWZlZWZlZTBmMDAwMGYwZmYyZmYyZmYwZjAwMDBmZjJlMmVlMmUyZmYwMDAwZWYyZmZmMmYyZmZlMDAwMGZmMmZlMmZlZjJmZjAwMDBlZmZlZTJmZTJmZmUwMGYwZWZlZWVmZWVmZmZlMGZmMGVmZWVlZWVlZWVmZTBmMDBmMGVlZWVlZWVlMGYwMDAwNGVmZmZmZmZmZjBlMDAwMGQ0ZWQyMjIyZjIwNDAwMDA0MGVlZmZmZmZmMGUwMDAwMDAwMDAwZjBmZjAwMDA=\",\n        \"displayName\": \"heroWalk\"\n    },\n    \"*\": {\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"dataEncoding\": \"base64\",\n        \"namespace\": \"myImages\"\n    }\n}","images.g.ts":"// Auto-generated code. Do not edit.\nnamespace myImages {\n\n    helpers._registerFactory(\"image\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"image1\":\n            case \"shearDoubleX_reference\":return img`\n..............................7777..............................\n............................77777777............................\n..........................777777777777..........................\n........................7777111111117777........................\n......................77777777777766667777......................\n....................777777771111111177777777....................\n..................7777777777776666777777777777..................\n................77777777777777777777777777777777................\n..............777777777777777777777777777777777777..............\n............7777777777775555777777777777777777777777............\n..........77777777777777775555777755556666777777777777..........\n........777777777777777777776666777755557777111133331111........\n......777777777777777777777777777755556666111111111111dddd......\n....55557777111133331111777777777777555577771111666611116666....\n..77777777111111111111dddd777777777777777733336666777733337777..\n5555777777771111666611116666777777777777777711117777111166667777\n..7777777733336666777733337777111111117777111111111111dddd7777..\n....7777777711117777111166667777777766667777dddd3333dddd7777....\n......7777111111111111dddd77771111111177777777666666667777......\n........7777dddd3333dddd77777777666677777777777777777777........\n..........77776666666677777777777777777777777777777777..........\n............7777777777777777777777777777777777777777............\n..............777777777777777777777777777777777777..............\n................77777777111111117777777777777777................\n..................7777777777776666777777777777..................\n....................777711111111777777777777....................\n......................77776666777777777777......................\n........................7777777777777777........................\n..........................777777775555..........................\n............................77777777............................\n..............................7777..............................\n................................................................\n`;\n        }\n        return null;\n    })\n\n    helpers._registerFactory(\"animation\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"heroWalk\":\n            case \"anim1\":return [img`\n. . . . . . f f f f . . . . . . \n. . . . f f e e e e f f . . . . \n. . . f e e e f f e e e f . . . \n. . f f f f f 2 2 f f f f f . . \n. . f f e 2 e 2 2 e 2 e f f . . \n. . f e 2 f 2 f f 2 f 2 e f . . \n. . f f f 2 2 e e 2 2 f f f . . \n. f f e f 2 f e e f 2 f e f f . \n. f e e f f e e e e f e e e f . \n. . f e e e e e e e e e e f . . \n. . . f e e e e e e e e f . . . \n. . e 4 f f f f f f f f 4 e . . \n. . 4 d f 2 2 2 2 2 2 f d 4 . . \n. . 4 4 f 4 4 4 4 4 4 f 4 4 . . \n. . . . . f f f f f f . . . . . \n. . . . . f f . . f f . . . . . \n`, img`\n. . . . . . . . . . . . . . . . \n. . . . . . f f f f . . . . . . \n. . . . f f e e e e f f . . . . \n. . . f e e e f f e e e f . . . \n. . . f f f f 2 2 f f f f . . . \n. . f f e 2 e 2 2 e 2 e f f . . \n. . f e 2 f 2 f f f 2 f e f . . \n. . f f f 2 f e e 2 2 f f f . . \n. . f e 2 f f e e 2 f e e f . . \n. f f e f f e e e f e e e f f . \n. f f e e e e e e e e e e f f . \n. . . f e e e e e e e e f . . . \n. . . e f f f f f f f f 4 e . . \n. . . 4 f 2 2 2 2 2 e d d 4 . . \n. . . e f f f f f f e e 4 . . . \n. . . . f f f . . . . . . . . . \n`, img`\n. . . . . . f f f f . . . . . . \n. . . . f f e e e e f f . . . . \n. . . f e e e f f e e e f . . . \n. . f f f f f 2 2 f f f f f . . \n. . f f e 2 e 2 2 e 2 e f f . . \n. . f e 2 f 2 f f 2 f 2 e f . . \n. . f f f 2 2 e e 2 2 f f f . . \n. f f e f 2 f e e f 2 f e f f . \n. f e e f f e e e e f e e e f . \n. . f e e e e e e e e e e f . . \n. . . f e e e e e e e e f . . . \n. . e 4 f f f f f f f f 4 e . . \n. . 4 d f 2 2 2 2 2 2 f d 4 . . \n. . 4 4 f 4 4 4 4 4 4 f 4 4 . . \n. . . . . f f f f f f . . . . . \n. . . . . f f . . f f . . . . . \n`, img`\n. . . . . . . . . . . . . . . . \n. . . . . . f f f f . . . . . . \n. . . . f f e e e e f f . . . . \n. . . f e e e f f e e e f . . . \n. . . f f f f 2 2 f f f f . . . \n. . f f e 2 e 2 2 e 2 e f f . . \n. . f e f 2 f f f 2 f 2 e f . . \n. . f f f 2 2 e e f 2 f f f . . \n. . f e e f 2 e e f f 2 e f . . \n. f f e e e f e e e f f e f f . \n. f f e e e e e e e e e e f f . \n. . . f e e e e e e e e f . . . \n. . e 4 f f f f f f f f e . . . \n. . 4 d d e 2 2 2 2 2 f 4 . . . \n. . . 4 e e f f f f f f e . . . \n. . . . . . . . . f f f . . . . \n`];\n        }\n        return null;\n    })\n\n    helpers._registerFactory(\"song\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n\n        }\n        return null;\n    })\n\n}\n// Auto-generated code. Do not edit.\n"}},{"timestamp":1762282439760,"editorVersion":"2.0.61","text":{"README.md":"(Discuss on Makecode Arcade forum at: \n[Raycasting 3D render with directional animation sprites](https://forum.makecode.com/t/raycasting-3d-render-blocks-edition/12921/) )\n\n## Brief:\nAn extension for Makecode Arcade, render a tilemap into 2.5D view, a kind of less calculation consuming 3D perspective view, with directional animations of sprites, \nbased on mmoskal's [3d map](https://forum.makecode.com/t/3d-raycasting-in-arcade/474)\n\n## Quick Start\n* Basically, this render just draw a traditional tilemap game into \"3D view\"\n* setTilemap(), walk around with arrow keys\n* Do your game as usual\n    * sprites, suggest sprite.setScale(0.5) for each, set directional animations with provided animation block.\n    * work together with most of Arcade blocks and extensions, sprite, projectile, overlap,...\n    * except these drawing screen directly, sprite effects ...\n* Operate view pos and collision size with provided \"myself sprite\", and view direction with \"setViewAngle\" block\n* Switch view mode with block \"setViewMode to tilemap(2D)/raycasting(3D)\"\n* Zoom in/out by set fov\n\n## Features:\n* Switch Tilemap(original 2D)/Raycasting(3D by default) view mode with provided \"set mode\" block\n    * The Tilemap mode, basically rendered all stuff via original Arcade functions, so should works as usual\n* Work together with most exsiting Arcade blocks:\n    * Tilemap: Tilemap designer, all blocks: Place sprite on a specific/random tile, ...\n    * Sprite: Manipulate sprite the same way in other tilemap prj before, with almost all blocks:\n        * set image,position,speed, acceleration, scale, kind, follow, detroy, ... \n        * note, one-tile size sprite and wall are disproportionate in 3D view, so suggest shrink to 0.5 or less by setScale(), or set small images for sprites.\n        * except z (diff from 3D world)\n        * except funtions drawing screen directly(effects, say)\n    * Projectile: all, except creating from side(side in 3D is diff from 2D)\n    * Arcade physical engine: wall, bounce, overlap events, ... (see known issues)\n* Predefined \"myself\" Sprite, for physical events in your code, kind=player, camera followed by default. Operate it as of an ordinary sprits, except can't see it in 3D view.\n* Porvide a block for set directional animations of sprite, with the Arcade out-of-box animation editor. Max 4 directions by now, but can be any count, let me know if you need more.\n* Porvide a event handler block running codes when direction between myself and sprite changed, can work together with out-of-box Animation blocks and richard Character Animation extension.\n* FOV(field of view), zoom in/out, by change \"fov\" property value\n* Mimimap, removed, cause we have real-size and real-time tilemap already. Let me know if you need.\n* The offsetZ for sprite, for floating effect, only worked when rendering in 3D view, so collisions could happen even they are far away at Z axis in 3D view\n* Porvide jump/move with height&duration parameters for sprites, calculate velocity and acceleration value auto.\n* Support original Spirte.sayText(), scaled with sprites together\n* Other incompatible: splash/showLongText, they can work, but transparent part is empty, which should be rendered 3D view.\n\n## Known issues:\n* Performing: To compactible with existing blocks, many codes are added in, the perf goes down significantly, need tuning later.\n* The Arcade phyical engine worked fine if sprite image is square. But if not, say a tall tree, collision will occured before hit the wall at y axis. \n    * Reason: The physical engine working in 2D mode, that consider sprite image as its size(x&y direction). But 3D render consider the image width as size for both x & y axises, height as sprite Z-axis size. This could be fix by override the physical engine, in future, if needed.\n\n## Todo:\n* Particles Effects\n* Override physic engine. Any one need?\n* Pose depended animations, stand, walk, attack. Any one need?\n* Perf tuning, Fx8\n* Tutorial\n\n\n----\n> Open this page at [https://aqeeaqee.github.io/pxt-raycasting/](https://aqeeaqee.github.io/pxt-raycasting/)\n\n## Use as Extension\n\nThis repository can be added as an **extension** in MakeCode.\n\n* open [https://arcade.makecode.com/](https://arcade.makecode.com/)\n* click on **New Project**\n* click on **Extensions** under the gearwheel menu\n* search for **https://github.com/aqeeaqee/pxt-raycasting** and import\n\n## Edit this project ![Build status badge](https://github.com/aqeeaqee/pxt-raycasting/workflows/MakeCode/badge.svg)\n\nTo edit this repository in MakeCode.\n\n* open [https://arcade.makecode.com/](https://arcade.makecode.com/)\n* click on **Import** then click on **Import URL**\n* paste **https://github.com/aqeeaqee/pxt-raycasting** and click import\n\n## Blocks preview\n\nThis image shows the blocks code from the last commit in master.\nThis image may take a few minutes to refresh.\n\n\\![A rendered view of the blocks](https://github.com/aqeeaqee/pxt-raycasting/raw/master/.github/makecode/blocks.png)\n\n#### Metadata (used for search, rendering)\n\n* for PXT/arcade\n<script src=\"https://makecode.com/gh-pages-embed.js\"></script><script>makeCodeRender(\"{{ site.makecode.home_url }}\", \"{{ site.github.owner_name }}/{{ site.github.repository_name }}\");</script>\n","render_raycasting.ts":"namespace userconfig {\n    export const ARCADE_SCREEN_WIDTH =  320\n    export const ARCADE_SCREEN_HEIGHT = 240\n}\n\n//% shim=pxt::updateScreen\nfunction updateScreen(img: Image) { }\n\nenum ViewMode {\n    //% block=\"TileMap Mode\"\n    tilemapView,\n    //% block=\"Isometric Mode\"\n    isometricView,\n}\n\n\n\nnamespace Render {\n    const SH = screen.height, SHHalf = SH / 2\n    const SW = screen.width, SWHalf = SW / 2\n    export const fpx = 8\n    const fpx2=fpx*2\n    const fpx2_4 = fpx2 - 4\n    const fpx_scale = 2 ** fpx\n    export function tofpx(n: number) { return (n * fpx_scale) | 0 }\n    const one = 1 << fpx\n    const one2 = 1 << (fpx + fpx)\n    const FPX_MAX = (1 << fpx) - 1\n\n    //for Isometric\n    const ScreenCenterX = screen.width >> 1, ScreenCenterY = screen.height * 3 >> 2\n    const TileMapScale = 4, TileSize = 1 << TileMapScale, HalfTileSize = TileSize >> 1\n    let TileImgScale = 4, HalfTileImgScale = TileImgScale / 2 ///>> 1\n    let TileImgScaleX = TileImgScale, TileImgScaleY = 2 //16x16 Rotate&Scale to 64x64, then shrink to 64x32\n    const IsConsole = control.ramSize() < 1024 * 1024, Max_TileImgScaleX = 4, Max_TileImgScaleY = IsConsole ? 2 : 4\n    let Scale = TileImgScale / Math.SQRT2, Scale_Square = TileImgScale ** 2 / 2 // = Scale**2 //8 // =\n    let WallScale = HalfTileImgScale, WallHeight = TileSize * WallScale\n    const X0 = TileSize >> 1, Y0 = X0\n    let H = X0 - TileSize * HalfTileImgScale, V = Y0 - TileSize * HalfTileImgScale\n    let AD_BC_Fpx2 = (one2 / Scale_Square) | 0 //= (Math.SQRT1_2/2)**2 == (A * D - B * C)\n    let A_Fpx = 0\n    let B_Fpx = 0\n\n    export function changeScale(delta: number){\n        setScale(TileImgScale + delta * 0.5)\n    }\n\n    function setScale(value: number){\n        const ratio = TileImgScale / TileImgScaleY\n        TileImgScale = Math.clamp(1, 4, value)\n        setScaleY(TileImgScale / ratio)\n\n        info.player3.setScore(TileImgScale*100)\n        HalfTileImgScale = TileImgScale / 2 ///>> 1\n        TileImgScaleX = TileImgScale\n        Scale = TileImgScale / Math.SQRT2, Scale_Square = TileImgScale ** 2 / 2\n        WallHeight = TileSize * HalfTileImgScale\n        H = X0 - TileSize * HalfTileImgScale, V = Y0 - TileSize * HalfTileImgScale\n        AD_BC_Fpx2 = (one2 / Scale_Square) | 0\n        raycastingRender.lastRenderAngle=-1 // force refresh\n    }\n\n    export function changeScaleY(delta:number){\n        setScaleY(TileImgScaleY + delta /8)\n    }\n    \n    function setScaleY(value: number){\n        TileImgScaleY = Math.clamp(1 / 8, TileImgScaleX / (IsConsole && TileImgScaleX > 2 ? 2 : 1), value)\n        info.player4.setScore(TileImgScaleY*100)\n        raycastingRender.lastRenderAngle = -1 // force refresh\n    }\n\n    function rotatePoint(xIn: number, yIn: number, A_Fpx:number, B_Fpx:number) {\n        const D_Fpx = A_Fpx, C_Fpx = -B_Fpx\n        let xOut = ((D_Fpx * (xIn - X0) - B_Fpx * (yIn - Y0)) << fpx) / AD_BC_Fpx2 - (H - X0)\n        let yOut = -((C_Fpx * (xIn - X0) - A_Fpx * (yIn - Y0)) << fpx) / AD_BC_Fpx2 - (V - Y0)\n        return { x: (xOut | 0), y: yOut / (TileImgScaleX / TileImgScaleY) }\n    }\n\n    class MotionSet1D {\n        p: number\n        v: number = 0\n        a: number = 0\n        constructor(public offset: number) {\n            this.p = offset\n        }\n    }\n\n    export const defaultFov = SW / SH / 2  //Wall just fill screen height when standing 1 tile away\n\n    export class RayCastingRender{\n\n        private tempScreen: Image = screen // image.create(SW, SH)\n        private tempBackground: scene.BackgroundLayer //for \"see through\" when scene popped out\n\n        velocityAngle: number = 2\n        velocity: number = 3\n        protected _viewMode=ViewMode.isometricView\n        protected dirXFpx: number\n        protected dirYFpx: number\n        protected planeX: number\n        protected planeY: number\n        protected _angle: number\n        protected _fov: number\n        protected _wallZScale: number = 1\n        cameraSway = 0\n        protected isWalking=false\n        protected cameraOffsetX = 0\n        protected cameraOffsetZ_fpx = 0\n\n        //sprites & accessories\n        sprSelf: Sprite\n        sprites: Sprite[] = []\n        sprites2D: Sprite[] = []\n        spriteParticles: particles.ParticleSource[] = []\n        spriteLikes: SpriteLike[] = []\n        spriteAnimations: Animations[] = []\n        protected spriteMotionZ: MotionSet1D[] = []\n        protected sayRederers: sprites.BaseSpriteSayRenderer[] = []\n        protected sayEndTimes: number[] = []\n\n        //reference\n        protected tilemapScale = TileScale.Sixteen\n        protected tilemapScaleSize = 1 << TileScale.Sixteen\n        map: tiles.TileMapData\n        mapData:Array<number>\n        bg: Image\n        textures: Image[]\n        protected oldRender: scene.Renderable\n        protected myRender: scene.Renderable\n\n        //render\n\n        //render perf const\n        viewZPos:number\n        viewXFpx:number\n        viewYFpx:number\n\n        //for drawing sprites\n        protected invDet: number //required for correct matrix multiplication\n        camera: scene.Camera\n        tempSprite: Sprite = sprites.create(img`0`)\n        protected transformX: number[] = []\n        protected transformY: number[] = []\n        protected angleSelfToSpr: number[] = []\n\n        onSpriteDirectionUpdateHandler: (spr: Sprite, dir: number) => void\n\n        get xFpx(): number {\n            return Fx.add(this.sprSelf._x, Fx.div(this.sprSelf._width, Fx.twoFx8)) as any as number / this.tilemapScaleSize\n        }\n\n        // set xFpx(v: number) {\n        //     this.sprSelf._x = v * this.tilemapScaleSize as any as Fx8\n        // }\n\n        get yFpx(): number {\n            return Fx.add(this.sprSelf._y, Fx.div(this.sprSelf._height, Fx.twoFx8)) as any as number / this.tilemapScaleSize\n        }\n\n        // set yFpx(v: number) {\n        //     this.sprSelf._y = v * this.tilemapScaleSize as any as Fx8\n        // }\n\n        get dirX(): number {\n            return this.dirXFpx / fpx_scale\n        }\n\n        get dirY(): number {\n            return this.dirYFpx / fpx_scale\n        }\n\n        set dirX(v: number) {\n            this.dirXFpx = v * fpx_scale\n        }\n\n        set dirY(v: number) {\n            this.dirYFpx = v * fpx_scale\n        }\n\n        sprXFx8(spr: Sprite) {\n            return Fx.add(spr._x, Fx.div(spr._width, Fx.twoFx8)) as any as number / this.tilemapScaleSize\n        }\n\n        sprYFx8(spr: Sprite) {\n            return Fx.add(spr._y, Fx.div(spr._height, Fx.twoFx8)) as any as number / this.tilemapScaleSize\n        }\n\n        get fov(): number {\n            return this._fov\n        }\n\n        set fov(fov: number) {\n            this._fov = fov\n            this.setVectors()\n        }\n\n        get viewAngle(): number {\n            return this._angle\n        }\n        set viewAngle(angle: number) {\n            this._angle = angle\n            this.setVectors()\n            // this.updateSelfImage()\n        }\n\n        get wallZScale(): number {\n            return this._wallZScale\n        }\n        set wallZScale(v: number) {\n            this._wallZScale = v\n        }\n\n        getMotionZ(spr: Sprite, offsetZ: number = 0) {\n            let motionZ = this.spriteMotionZ[spr.id]\n            if (!motionZ) {\n                motionZ = new MotionSet1D(tofpx(offsetZ))\n                this.spriteMotionZ[spr.id] = motionZ\n            }\n            return motionZ\n        }\n\n        getZOffset(spr: Sprite) {\n            return this.getMotionZ(spr).offset / fpx_scale\n        }\n\n        setZOffset(spr: Sprite, offsetZ: number, duration: number = 500) {\n            const motionZ = this.getMotionZ(spr, offsetZ)\n\n            motionZ.offset = tofpx(offsetZ)\n            if (motionZ.p != motionZ.offset) {\n                if (duration === 0)\n                    motionZ.p = motionZ.offset\n                else if(motionZ.v==0)\n                    this.move(spr, (motionZ.offset - motionZ.p) / fpx_scale * 1000 / duration, 0)\n            }\n        }\n\n        getMotionZPosition(spr: Sprite) {\n            return this.getMotionZ(spr).p / fpx_scale\n        }\n\n        //todo, use ZHeight(set from sprite.Height when takeover, then sprite.Height will be replace with width)\n        isOverlapZ(sprite1: Sprite, sprite2: Sprite): boolean {\n            const p1 = this.getMotionZPosition(sprite1)\n            const p2 = this.getMotionZPosition(sprite2)\n            if (p1 < p2) {\n                if (p1 + sprite1.height > p2) return true\n            } else {\n                if (p2 + sprite2.height > p1) return true\n            }\n            return false\n        }\n\n        move(spr: Sprite, v: number, a: number) {\n            const motionZ = this.getMotionZ(spr)\n\n            motionZ.v = tofpx(v)\n            motionZ.a = tofpx(a)\n        }\n\n        jump(spr: Sprite, v: number, a: number) {\n            const motionZ = this.getMotionZ(spr)\n            let floorHeight = motionZ.offset\n            if (tiles.tileAtLocationIsWall(spr.tilemapLocation()))\n                floorHeight += TileSize << fpx\n\n            if (motionZ.p != floorHeight)\n                return\n\n            motionZ.v = tofpx(v)\n            motionZ.a = tofpx(a)\n        }\n\n        jumpWithHeightAndDuration(spr: Sprite, height: number, duration: number) {\n            const motionZ = this.getMotionZ(spr)\n            let floorHeight = motionZ.offset\n            if (tiles.tileAtLocationIsWall(spr.tilemapLocation()))\n                floorHeight += TileSize << fpx\n\n            if (motionZ.p != floorHeight)\n                return\n\n            // height= -v*v/a/2\n            // duration = -v/a*2 *1000\n            const v = height * 4000 / duration\n            const a = -v * 2000 / duration\n            motionZ.v = tofpx(v)\n            motionZ.a = tofpx(a)\n        }\n\n        get viewMode(): ViewMode {\n            return this._viewMode\n        }\n\n        set viewMode(v: ViewMode) {\n            this._viewMode = v\n        }\n\n        updateViewZPos() {\n            this.viewZPos = this.spriteMotionZ[this.sprSelf.id].p + (this.sprSelf._height as any as number) - (2 << fpx)\n        }\n\n        takeoverSceneSprites() {\n            const sc_allSprites = game.currentScene().allSprites\n            for (let i=0;i<sc_allSprites.length;) {\n                const spr=sc_allSprites[i]\n                if (spr instanceof Sprite) {\n                    const sprList = (spr.flags & sprites.Flag.RelativeToCamera) ? this.sprites2D:this.sprites\n                    if (sprList.indexOf(spr) < 0) {\n                        sprList.push(spr as Sprite)\n                        this.getMotionZ(spr, 0)\n                        spr.onDestroyed(() => {\n                            this.sprites.removeElement(spr as Sprite)   //can be in one of 2 lists\n                            this.sprites2D.removeElement(spr as Sprite) //can be in one of 2 lists\n                            const sayRenderer = this.sayRederers[spr.id]\n                            if (sayRenderer) {\n                                this.sayRederers.removeElement(sayRenderer)\n                                sayRenderer.destroy()\n                            }\n                        })\n                    }\n                } else if(spr instanceof particles.ParticleSource){\n                    const particle = (spr as particles.ParticleSource)\n                    if (this.spriteParticles.indexOf(particle) < 0 && particle.anchor instanceof Sprite) {\n                        const spr = (particle.anchor as Sprite)\n                        if(this.sprites.indexOf(spr)>=0){\n                            this.spriteParticles[spr.id]=particle\n                            particle.anchor= {x:0,y:0}\n                        }\n                    }\n                } else {\n                    if (this.spriteLikes.indexOf(spr) < 0)\n                        this.spriteLikes.push(spr)\n                }\n                sc_allSprites.removeElement(spr)\n            }\n            this.sprites.forEach((spr) => {\n                if (spr)\n                    this.takeoverSayRenderOfSprite(spr)\n            })\n        }\n        takeoverSayRenderOfSprite(sprite: Sprite) {\n            const sprite_as_any = (sprite as any)\n            if (sprite_as_any.sayRenderer) {\n                this.sayRederers[sprite.id] = sprite_as_any.sayRenderer\n                this.sayEndTimes[sprite.id] = sprite_as_any.sayEndTime;\n                sprite_as_any.sayRenderer = undefined\n                sprite_as_any.sayEndTime = undefined\n            }\n        }\n\n        tilemapLoaded() {\n            const sc = game.currentScene()\n            this.map = sc.tileMap.data\n            this.mapData = ((this.map as any).data as Buffer).toArray(NumberFormat.Int8LE)\n            this.tilemapScaleSize = 1 << sc.tileMap.data.scale\n            this.textures = sc.tileMap.data.getTileset()\n            this.oldRender = sc.tileMap.renderable\n            this.spriteLikes.removeElement(this.oldRender)\n            sc.allSprites.removeElement(this.oldRender)\n\n            let frameCallback_update = sc.eventContext.registerFrameHandler(scene.PRE_RENDER_UPDATE_PRIORITY + 1, () => {\n                const dt = sc.eventContext.deltaTime;\n                // sc.camera.update();  // already did in scene\n                for (const s of this.sprites)\n                    s.__update(sc.camera, dt);\n                this.sprSelf.__update(sc.camera, dt)\n            })\n\n            let frameCallback_draw = sc.eventContext.registerFrameHandler(scene.RENDER_SPRITES_PRIORITY + 1, () => {\n                if (this._viewMode == ViewMode.isometricView) {\n                    if (!this.tempBackground) {\n                        this.tempScreen.drawImage(game.currentScene().background.image, 0, 0)\n                        this.render()\n                        // screen.fill(0)\n                        this.sprites2D.forEach(spr => spr.__draw(sc.camera))\n                        this.spriteLikes.forEach(spr => spr.__draw(sc.camera))\n                        // this.tempScreen.drawTransparentImage(screen, 0, 0)\n                    }\n                } else {\n                    screen.drawImage(game.currentScene().background.image, 0, 0)\n                    this.oldRender.__drawCore(sc.camera)\n                    this.sprites.forEach(spr => spr.__draw(sc.camera))\n                    this.sprSelf.__draw(sc.camera)\n                    this.sprites2D.forEach(spr => spr.__draw(sc.camera))\n                    this.spriteLikes.forEach(spr => spr.__draw(sc.camera))\n                }\n            })\n\n            sc.tileMap.addEventListener(tiles.TileMapEvent.Unloaded, data => {\n                sc.eventContext.unregisterFrameHandler(frameCallback_update)\n                sc.eventContext.unregisterFrameHandler(frameCallback_draw)\n            })\n        }\n\n        constructor() {\n            this._angle = Math.PI/4\n            this.fov = defaultFov\n            this.camera = new scene.Camera()\n\n            const sc = game.currentScene()\n            if (!sc.tileMap) {\n                sc.tileMap = new tiles.TileMap();\n            } else {\n                this.tilemapLoaded()\n            }\n            game.currentScene().tileMap.addEventListener(tiles.TileMapEvent.Loaded, data => this.tilemapLoaded())\n\n            //self sprite\n            this.sprSelf = sprites.create(image.create(this.tilemapScaleSize >> 1, this.tilemapScaleSize >> 1), SpriteKind.Player)\n            this.sprSelf.setImage(sprites.castle.heroWalkBack1)\n            this.sprSelf.scale=0.5\n            this.takeoverSceneSprites()\n            // this.sprites.removeElement(this.sprSelf)\n            this.updateViewZPos()\n            scene.cameraFollowSprite(this.sprSelf) //prevent projectiles from AutoDestroy \n            // this.updateSelfImage()\n\n            game.onUpdate(function () {\n                this.updateControls()\n                this.updateSprite()\n            })\n\n            game.onUpdateInterval(400, ()=>{\n                for (let i = 0; i < this.sprites.length;) {\n                    const spr = this.sprites[i]\n                    if (spr.flags & sprites.Flag.RelativeToCamera) {\n                        this.sprites.removeElement(spr)\n                        this.sprites2D.push(spr)\n                    } else {i++}\n                }\n                for (let i = 0; i < this.sprites2D.length;) {\n                    const spr = this.sprites2D[i]\n                    if (!(spr.flags & sprites.Flag.RelativeToCamera)) {\n                        this.sprites2D.removeElement(spr)\n                        this.sprites.push(spr)\n                    } else {i++}\n                }\n                this.takeoverSceneSprites() // in case some one new\n            })\n\n\n//            game.onUpdateInterval(25, () => {\n//                if(this.cameraSway&&this.isWalking){\n//                    this.cameraOffsetX = (Math.sin(control.millis() / 150) * this.cameraSway * 3)|0\n//                    this.cameraOffsetZ_fpx = tofpx(Math.cos(control.millis() / 75) * this.cameraSway)|0\n//                }\n//            });\n\n//            control.__screen.setupUpdate(() => {\n//                if(this.viewMode==ViewMode.isometricView)\n//                    updateScreen(this.tempScreen)\n//                else\n//                    updateScreen(screen)\n//            })\n\n            game.addScenePushHandler((oldScene) => {\n                this.tempBackground = oldScene.background.addLayer(this.tempScreen, 0, BackgroundAlignment.Center)\n                control.__screen.setupUpdate(() => { updateScreen(screen) })\n            })\n            game.addScenePopHandler((oldScene) => {\n                ((oldScene.background as any)._layers as scene.BackgroundLayer[]).removeElement(this.tempBackground)\n                this.tempBackground=undefined\n                control.__screen.setupUpdate(() => {\n                    if (this.viewMode == ViewMode.isometricView)\n                        updateScreen(this.tempScreen)\n                    else\n                        updateScreen(screen)\n                })\n            })\n        }\n\n        private setVectors() {\n            const sin = Math.sin(this._angle)\n            const cos = Math.cos(this._angle)\n            this.dirXFpx = tofpx(cos)\n            this.dirYFpx = tofpx(sin)\n            this.planeX = tofpx(sin * this._fov)\n            this.planeY = tofpx(cos * -this._fov)\n        }\n\n        //todo, pre-drawn dirctional image\n        public updateSelfImage() {\n            const img = this.sprSelf.image\n            img.fill(6)\n            const arrowLength = img.width / 2\n            img.drawLine(arrowLength, arrowLength, arrowLength + this.dirX * arrowLength, arrowLength + this.dirY * arrowLength, 2)\n            img.fillRect(arrowLength - 1, arrowLength - 1, 2, 2, 2)\n        }\n\n        updateControls() {\n            if (this.velocityAngle !== 0) {\n                const dx = controller.dx(this.velocityAngle)\n                if (dx) {\n                    this.viewAngle += dx\n                }\n            }\n            if (this.velocity !== 0) {\n                this.isWalking=true\n                const dy = controller.dy(this.velocity)\n                if (dy) {\n                    const nx = this.xFpx - Math.round(this.dirXFpx * dy)\n                    const ny = this.yFpx - Math.round(this.dirYFpx * dy)\n                    this.sprSelf.setPosition((nx * this.tilemapScaleSize / fpx_scale), (ny * this.tilemapScaleSize / fpx_scale))\n                }else{\n                    this.isWalking =false\n                }\n            }\n        }\n\n        updateSprite(){\n            const dt = game.eventContext().deltaTime\n            for (const spr of this.sprites) {\n                this.updateMotionZ(spr, dt)\n            }\n            this.updateMotionZ(this.sprSelf, dt)\n        }\n\n        updateMotionZ(spr:Sprite, dt:number){\n            const motionZ = this.spriteMotionZ[spr.id]\n            //if (!motionZ) continue\n\n            let floorHeight = motionZ.offset\n            if(tiles.tileAtLocationIsWall(spr.tilemapLocation()))\n                floorHeight += TileSize <<fpx\n            if (motionZ.v != 0 || motionZ.p != floorHeight) {\n                motionZ.v += motionZ.a * dt, motionZ.p += motionZ.v * dt\n                //landing\n                if ((motionZ.a >= 0 && motionZ.v > 0 && motionZ.p >= floorHeight) ||\n                    (motionZ.a <= 0 && motionZ.v < 0 && motionZ.p <= floorHeight)) { motionZ.p = floorHeight, motionZ.v = 0 }\n                if(spr===this.sprSelf)\n                    this.updateViewZPos()\n            }\n            if (spr === this.sprSelf){\n                const isLevel2 = motionZ.p >= (TileSize << fpx)\n                spr.setFlag(SpriteFlag.Ghost, isLevel2)\n                spr.layer = isLevel2 ? 2 : 1\n            }\n        }\n\n        rotateAll(inImgs: Image[], A_Fpx: number, B_Fpx: number) {\n            // let ms=0\n\n            // this.corners[0].x = 999\n            // this.corners[2].x = -999\n            // this.corners[1].y = -999\n\n            let D_Fpx =  A_Fpx\n            let C_Fpx = -B_Fpx\n            let xIn0_FX = (A_Fpx * (H - X0)) + (B_Fpx * (V - Y0)) + (X0 << fpx)\n            let yIn0_FX = (C_Fpx * (H - X0)) + (D_Fpx * (V - Y0)) + (Y0 << fpx)\n            // B_Fpx <<= 1 // skip 1 every 1, shrink to 64x32\n            // D_Fpx <<= 1 // ...\n            B_Fpx *= (TileImgScaleX/TileImgScaleY) // skip 1 every 1, shrink to 64x32\n            D_Fpx *= (TileImgScaleX/TileImgScaleY) // ...\n            const TileSize_Fpx = TileSize << fpx\n\n            for (let xOut = 0; xOut < TileSize * TileImgScaleX; xOut++) {\n                let xIn_FX = xIn0_FX\n                let yIn_FX = yIn0_FX\n                for (let yOut = 0; yOut < TileSize * TileImgScaleY; yOut++) {\n                    if (0 <= xIn_FX && xIn_FX < TileSize_Fpx && 0 <= yIn_FX && yIn_FX < TileSize_Fpx) {\n                        const xIn = xIn_FX >> fpx\n                        const yIn = yIn_FX >> fpx\n                        for (let i = 1; i < inImgs.length; i++) {\n                            const c = inImgs[i].getPixel(xIn, yIn)\n                            this.rotatedTiles[i].setPixel(xOut, yOut, c)\n                        }\n\n                        // ms+=control.benchmark(()=>{ //<3ms totally on Meowbit\n                        if (false && (0 === xIn || xIn === TileSize - 1) && (0 === yIn || yIn === TileSize - 1)){\n                            // console.log([xIn, yIn, xOut, yOut].join())\n                            if (xOut < this.corners[0].x) { this.corners[0].x = xOut; this.corners[0].y = yOut; }\n                            else if (xOut === this.corners[0].x && yOut > this.corners[0].y) { this.corners[0].y = yOut; }\n                            else if (xOut+1 > this.corners[2].x) {this.corners[2].x = xOut +1; this.corners[2].y = yOut; }\n                            else if (xOut+1 === this.corners[2].x && yOut > this.corners[2].y) { this.corners[2].y = yOut; }\n                            if (yOut > this.corners[1].y) { this.corners[1].x = xOut; this.corners[1].y = yOut; }\n                        }\n                        // }); \n                    }\n                    xIn_FX += B_Fpx \n                    yIn_FX += D_Fpx \n                }\n                xIn0_FX += A_Fpx\n                yIn0_FX += C_Fpx\n            }\n            // info.player2.setScore(ms)\n        }\n\n        shearDoubleX(inImg: Image, degree: number, i = 0){\n            //fix 45Â°\n            const size = Math.max(inImg.width, inImg.height)\n            const outImg = image.create(size << 2, size << 1)\n            \n            // outImg.fill(i+1)\n            for (let x = 0; x < inImg.width; x++) {\n                for (let y = 0; y < inImg.height; y++) {\n                    const xo =  (x+y)*2, yo=15 - x + y\n                    outImg.drawLine(xo,yo, xo+3,yo, inImg.getPixel(x,y))\n                }\n            }\n            return outImg\n        }\n\n        drawWallSide_Solid(offsetX: number, offsetY:number){\n                    const p0x = offsetX + this.corners[0].x, p0y = offsetY + this.corners[0].y\n                    const p1x = offsetX + this.corners[1].x, p1y = offsetY + this.corners[1].y\n                    const p3x = offsetX + this.corners[2].x, p3y = offsetY + this.corners[2].y\n\n                    this.tempScreen.fillPolygon4(\n                        p0x, p0y,\n                        p0x, p0y - WallHeight,\n                        p1x, p1y - WallHeight,\n                        p1x, p1y,\n                        12)\n\n                    this.tempScreen.fillPolygon4(\n                        p3x, p3y,\n                        p3x, p3y - WallHeight,\n                        p1x, p1y - WallHeight,\n                        p1x, p1y,\n                        12)\n        }\n\n        drawWallSide_Tex(targetImg: Image, offsetX: number, offsetY: number, tex: Image, startCornerIndex: number) {\n            const p0x = offsetX + this.corners[startCornerIndex].x, p0y = offsetY + this.corners[startCornerIndex].y\n            const p1x = offsetX + this.corners[startCornerIndex + 1].x, p1y = offsetY + this.corners[startCornerIndex + 1].y\n            let y = (p0y - WallHeight + 1) << fpx\n            const diffX0_1 = p1x - p0x\n            let texX = 0\n            const texXStep = Math.idiv((TileSize << fpx), diffX0_1)\n            const yStep = Math.idiv((p1y - p0y) << fpx, diffX0_1)\n            for (let x = 0; x <= diffX0_1; x++) {\n                // this.tempScreen.print(y+\"\", 100,60+x*10)\n                helpers.imageBlitRow(targetImg, x + p0x, y >> fpx,\n                    tex, texX >> fpx, WallHeight)\n                texX += texXStep\n                y += yStep\n            }\n        }\n\n        rotatedTexWalls: Image[] = []\n        drawWall(offsetX: number, offsetY: number, tileIndex: number) {\n            // this.drawWall(offsetX, offsetY)\n            let texWall = this.rotatedTexWalls[tileIndex]\n            if (!texWall) {\n                // let ms = control.benchmark(() => {\n                texWall = image.create(TileSize * Max_TileImgScaleX, TileSize * Max_TileImgScaleY + WallHeight)\n                    this.drawWallSide_Tex(texWall, 0, WallHeight, this.map.getTileset()[tileIndex], 0)\n                    this.drawWallSide_Tex(texWall, 0, WallHeight, this.map.getTileset()[tileIndex], 1)\n                    texWall.drawTransparentImage(this.rotatedTiles[tileIndex], 0, 0)\n                    this.rotatedTexWalls[tileIndex] = texWall\n                // }); info.player4.setLife(ms) // this.tempScreen.print(ms.toString(), 0, 110)\n            }\n            this.tempScreen.drawTransparentImage(texWall, offsetX, offsetY - WallHeight)\n        }\n\n        rotatedTiles:Image[]\n        lastRenderAngle=-1\n        selfSprAniId=0\n        corners: { x: number, y: number }[] = [] //[{ x: 0, y: 0 }, { x: 0, y: 0 }, { x: 0, y: 0 }]\n        render() {\n            // isometricView, ref: https://forum.makecode.com/t/snes-mode-7-transformations/8530\n\n            this.viewXFpx = this.xFpx\n            this.viewYFpx = this.yFpx\n            this.viewZPos = this.spriteMotionZ[this.sprSelf.id].p + (this.sprSelf._height as any as number) - (2<<fpx) + this.cameraOffsetZ_fpx\n\n            while (this._angle < 0) this._angle += Math.PI * 2\n            while (this._angle >Math.PI*2) this._angle -= Math.PI * 2\n            info.player2.setScore(this._angle*180/Math.PI)\n            const angle = -this._angle - Math.PI / 2\n\n            if (!this.rotatedTiles) {\n                this.rotatedTiles = []\n                for (let i = 0; i < this.map.getTileset().length; i++)\n                    this.rotatedTiles.push(image.create(TileSize * Max_TileImgScaleX, TileSize * Max_TileImgScaleY))\n            }\n\n            //update tiles and parameters\n            if(this.lastRenderAngle!=this._angle)\n            {\n\n                A_Fpx = (Math.cos(angle) * fpx_scale / Scale)|0\n                B_Fpx = (Math.sin(angle) * fpx_scale / Scale)|0\n                // A_Fpx = Math.sqrt(AD_BC_Fpx2 - B_Fpx * B_Fpx)\n                // B_Fpx = Math.sqrt(AD_BC_Fpx2 - A_Fpx * A_Fpx)\n\n                for (let i = 0; i < this.rotatedTiles.length; i++)\n                    this.rotatedTiles[i].fill(0)\n\n                let ms: number\n                ms = control.benchmark(() => {\n                    this.rotateAll(this.map.getTileset(), A_Fpx, B_Fpx)\n                    //a workaround avoiding gaps between tiles\n                    this.rotatedTiles.forEach((t)=> t.drawTransparentImage(t, -1, -1))\n                    this.rotatedTexWalls.splice(0, this.rotatedTexWalls.length)\n                }); info.setLife(ms/this.rotatedTiles.length) // this.tempScreen.print(ms.toString(), 0, 110)\n\n\n                // this.rotatedTiles.forEach((v, i) =>{\n                //     this.tempScreen.drawImage(v, (i % 3) * 64, 32+32*((i/3)|0))})\n\n                //tile corners, for drawing wall\n                // ms=control.benchmark(()=> {\n                    this.corners.splice(0, this.corners.length)\n                    this.corners = [\n                        rotatePoint(0, 0, A_Fpx, B_Fpx),\n                        rotatePoint(0, 15.99, A_Fpx, B_Fpx),\n                        rotatePoint(15.99, 15.99, A_Fpx, B_Fpx),\n                        rotatePoint(15.99, 0, A_Fpx, B_Fpx),\n                    ]\n\n                    const topCornerId = this.corners.reduce((tId, p, i) => { return p.y < this.corners[tId].y ? i : tId }, 0)\n                    this.corners.removeAt(topCornerId)\n                    if (topCornerId) //not necessary if removed [0]\n                        for (let i = 0; i < 3 - topCornerId; i++) //rolling reorder, keep original loop order, start from the next corner of toppest one to the last, then start from beginning\n                            this.corners.insertAt(0, this.corners.pop())\n                    // this.corners[1].x -= 1\n                // }); info.player2.setScore(ms)\n\n                //shear doubled, manually, for reference\n                // this.tempScreen.drawImage(assets.image`shearDoubleX_reference`, 50, 0)\n\n                // ms = control.benchmark(() => {\n                // this.rotatedTiles = this.map.getTileset().map((v, i) => this.shearDoubleX(v, this._angle, i))\n                // }); this.tempScreen.print(ms.toString(), 0, 100)\n                // this.rotatedTiles.forEach((v, i) =>{\n                // this.tempScreen.drawImage(v, (i % 3) * 64, 32 * ((i / 3) | 0))})\n                // \n                // this.tempScreen.drawImage(this.map.getTileImage(3), 0, 12)\n\n                this.lastRenderAngle=this._angle\n            }\n\n            const A_px_Fpx = (TileSize * Scale_Square -1) * A_Fpx  // -2 is a workaround avoiding gaps between tiles \n            const B_px_Fpx = (TileSize * Scale_Square -1) * B_Fpx  // -2 is a workaround avoiding gaps between tiles \n            const C_px_Fpx = -B_px_Fpx\n            const D_px_Fpx = A_px_Fpx\n\n            //shearDoubleX\n            // const A = 32 * fpx_scale\n            // const B = 16 * fpx_scale\n            // const C = -A\n            // const D =  B\n\n            if(0){//debug tiles align with A B\n                this.tempScreen.fill(8)\n                const A = A_px_Fpx / fpx_scale\n                const B = B_px_Fpx / fpx_scale\n                const C = -B\n                const D = A\n\n                const baseX=0, baseY=64\n                const centerX= baseX+(TileSize*TileImgScaleX>>1), centerY=baseY+TileSize*TileImgScaleY/2\n\n                this.drawWall(baseX - A, baseY - B / (TileImgScaleX / TileImgScaleY), 3)\n                \n                // this.rotatedTiles[1].replace(0,6)\n                this.drawWall(baseX, baseY, 1)\n                \n                this.tempScreen.drawLine(centerX, centerY - WallHeight, centerX + A, centerY - WallHeight + B/(TileImgScaleX/TileImgScaleY), 2)\n                this.tempScreen.drawLine(centerX, centerY - WallHeight, centerX + C, centerY - WallHeight + D/(TileImgScaleX/TileImgScaleY), 2)\n                //debug\n                this.corners.forEach((p, i) => this.tempScreen.print(p.x + \",\" + p.y, 70, i * 10 + 30))\n                // info.player2.setScore(100 * this._angle * 180 / Math.PI)\n\n                this.corners.forEach((p, i) => { this.tempScreen.setPixel(baseX+p.x, baseY - WallHeight + p.y, i + 2) })\n\n                return\n            }\n\n            const left_CenterTile = ScreenCenterX - (TileSize * TileImgScaleX >>1 )\n            const top_CenterTile =  ScreenCenterY - (TileSize * TileImgScaleY >>1 )\n\n        let ms = control.benchmark(() => {\n            const Walls = []\n            let offsetX0_Fpx = (( (HalfTileSize - this.sprSelf.y) * C_px_Fpx + A_px_Fpx * (HalfTileSize - this.sprSelf.x) ) >>TileMapScale ) + (left_CenterTile<<fpx)\n            let offsetY0_Fpx = (((HalfTileSize - this.sprSelf.y) * D_px_Fpx + B_px_Fpx * (HalfTileSize - this.sprSelf.x)) >> TileMapScale) + (top_CenterTile << fpx) * (TileImgScaleX / TileImgScaleY)\n            for (let i = 0; i < this.map.width; i++) {\n                let offsetX_Fpx = offsetX0_Fpx\n                let offsetY_Fpx = offsetY0_Fpx\n                for (let j = 0; j < this.map.height; j++) {\n                    const offsetX = offsetX_Fpx >> fpx\n                    const offsetY = (offsetY_Fpx >> (fpx))/(TileImgScaleX / TileImgScaleY)\n                    if (offsetX > -TileSize * TileImgScaleX && offsetX < screen.width && offsetY > -TileSize * TileImgScaleY && offsetY < screen.height + TileSize * TileImgScaleY) {\n                        const t = this.map.getTile(j, i)\n                        if (this.map.isWall(j, i)) {\n                            Walls.push([1, offsetX, offsetY, t, \n                                (D_px_Fpx > 0 ? i : this.map.width - 1 - i) * this.map.width +\n                                (B_px_Fpx > 0 ? j : this.map.height - 1 - j)\n                            ])\n                        }else //floor\n                            this.tempScreen.drawTransparentImage(this.rotatedTiles[t], offsetX, offsetY)\n                    }\n                    offsetX_Fpx+=A_px_Fpx\n                    offsetY_Fpx+=B_px_Fpx\n                }\n                offsetX0_Fpx += C_px_Fpx\n                offsetY0_Fpx += D_px_Fpx\n            }\n\n            //draw Sprite and wall by order of distance\n            const drawingSprites = this.sprites\n            .map((spr, index) => {\n                const offsetX = ScreenCenterX + ((C_px_Fpx * (spr.y - this.sprSelf.y) + A_px_Fpx * (spr.x - this.sprSelf.x)) >> (TileMapScale + fpx))\n                const offsetY = ScreenCenterY + (((D_px_Fpx * (spr.y - this.sprSelf.y) + B_px_Fpx * (spr.x - this.sprSelf.x)) >> (TileMapScale + fpx))/(TileImgScaleX/TileImgScaleY))\n                const j = (spr.x / TileSize) | 0, i = (spr.y / TileSize) | 0\n                return [0, offsetX, offsetY, index,\n                    (D_px_Fpx > 0 ? i : this.map.width - 1 - i) * this.map.width +\n                    (B_px_Fpx > 0 ? j : this.map.height - 1 - j) +\n                    ((spr.layer-1)<<10)\n                    ]\n            })\n            .filter((v,i) =>{\n                const spr= this.sprites[i]\n                return (v[2] > 0 && v[1] >= -(spr.width * Scale >> 1) && v[1] < screen.width + (spr.width * Scale >> 1) && v[2] < screen.height + spr.height * Scale + (this.spriteMotionZ[spr.id].p * WallScale >> fpx))\n            })\n            drawingSprites\n                .concat(Walls) // [0/1:spr/wall, offsetX, offsetY,sprID/wallTex, drawing order index of row&col]\n                .sort((v1, v2) => v1[4] - v2[4]) // from far to near\n                .forEach((v) => {\n                    if (v[0] === 0) \n                        this.drawSprite(this.sprites[v[3]], v[1], v[2])\n                    else if (v[0] === 1)\n                        this.drawWall(v[1], v[2], v[3])\n                    // this.tempScreen.print(v[4] + \"\", v[1] + TileSize * 2, v[2], 2)\n            })\n\n            drawingSprites.forEach((v) => this.drawSprite_SayText(this.sprites[v[3]], v[1], v[2]))\n\n            game.currentScene().particleSources.forEach((p)=>{\n                if(this.spriteParticles.indexOf(p)<0)p.__draw(game.currentScene().camera)\n            })\n\n        });info.setScore(ms) // this.tempScreen.print(ms.toString(), 0, 20)\n        }\n        \n        registerOnSpriteDirectionUpdate(handler: (spr: Sprite, dir: number) => void) {\n            this.onSpriteDirectionUpdateHandler = handler\n        }\n\n        drawSprite(spr: Sprite, x: number, y: number) {\n            const widthSpr = spr.width * Scale\n            const heightSpr = spr.height * Scale\n            const dir = (Math.atan2(spr._vx as any as number, spr._vy as any as number) + this._angle) / Math.PI / 2 + .5\n            const texSpr = !this.spriteAnimations[spr.id] ? spr.image : this.spriteAnimations[spr.id].getFrameByDir(dir)\n            helpers.imageBlit(this.tempScreen, x - (widthSpr >> 1), y - heightSpr - (this.spriteMotionZ[spr.id].p * WallScale >> fpx), widthSpr, heightSpr,\n                texSpr, 0, 0, spr.image.width, spr.image.height, true, false)\n                \n            const particle = this.spriteParticles[spr.id]\n            if (particle) {\n                if (particle.lifespan) {\n                    this.camera.drawOffsetX = -x\n                    this.camera.drawOffsetY = -(y - (spr.height * Scale >> 1) - (this.spriteMotionZ[spr.id].p * WallScale >> fpx))\n                    particle.__draw(this.camera)\n                } else {\n                    this.spriteParticles[spr.id] = undefined\n                }\n            }\n        }\n\n        //sayText\n        drawSprite_SayText(spr: Sprite, x: number, y: number){\n            const sayRender = this.sayRederers[spr.id]\n            if (sayRender) {\n                const heightSpr = spr.height * Scale\n                if (this.sayEndTimes[spr.id] && control.millis() > this.sayEndTimes[spr.id]) {\n                    this.sayRederers[spr.id] = undefined\n                } else {\n                    this.tempSprite.x = x\n                    this.tempSprite.y = y - heightSpr - (this.spriteMotionZ[spr.id].p * WallScale >> fpx) -2\n                    this.camera.drawOffsetX = 0\n                    this.camera.drawOffsetY = 0\n                    sayRender.draw(this.tempScreen, this.camera, this.tempSprite)\n                }\n            }\n\n/*\n            const sayOrParticle = !!sayRender || !!particle\n            if (sayOrParticle) {\n                screen.fill(0)\n                //particle\n                //update screen for this spr\n                const fpx_div_transformy = Math.roundWithPrecision(transformY / 4 / fpx_scale, 2)\n                const height = (SH / fpx_div_transformy)\n                const blitXSaySrc = ((blitX - spriteScreenX) * fpx_div_transformy) + SWHalf\n                const blitWidthSaySrc = (blitWidth * fpx_div_transformy)\n                if (blitXSaySrc <= 0) { //imageBlit considers negative value as 0\n                    helpers.imageBlit(\n                        this.tempScreen,\n                        spriteScreenX - SWHalf / fpx_div_transformy, drawStart - height / 2, (blitWidthSaySrc + blitXSaySrc) / fpx_div_transformy, height,\n                        screen,\n                        0, 0, blitWidthSaySrc + blitXSaySrc, SH, true, false)\n                } else {\n                    helpers.imageBlit(\n                        this.tempScreen,\n                        blitX, drawStart - height / 2, blitWidth, height,\n                        screen,\n                        blitXSaySrc, 0, blitWidthSaySrc, SH,\n                        true, false)\n                }\n            }\n            // const ms = control.benchmark(() => {\n            // }); this.tempScreen.print(ms.toString(), 0, 30 + index * 10, 15)\n*/\n        }\n\n    }\n\n    //%fixedinstance\n    export const raycastingRender = new Render.RayCastingRender()\n}\n","render_blocks.ts":"enum RCSpriteAttribute{\n    ZOffset,\n    ZPosition,\n    ZVelocity,\n    ZAcceleration\n}\n/**\n * A 2.5D Screen Render, using Raycasting algorithm\n **/\n//% color=#03AA74 weight=1 icon=\"\\uf1b2\" //cube f1b2 , fold f279\n//% groups='[\"Instance\",\"Basic\", \"Dimension Z\", \"Animate\", \"Advanced\"]'\n//% block=\"3D Render\"\nnamespace Render {\n    export enum attribute {\n        dirX,\n        dirY,\n        fov,\n        wallZScale,\n    }\n\n    export class Animations {\n        constructor(public frameInterval: number, public animations: Image[][]) {\n        }\n\n        msLast = 0\n        index = 0\n        iAnimation = 0\n        getFrameByDir(dir: number): Image {\n            if (control.millis() - this.msLast > this.frameInterval) {\n                this.msLast = control.millis()\n                this.index++\n                while(dir<0) dir+=1 //make sure dir>0\n                this.iAnimation = Math.round((dir * this.animations.length)) % this.animations.length\n                if (this.index >= this.animations[this.iAnimation].length)\n                    this.index = 0\n            }\n            return this.animations[this.iAnimation][this.index]\n        }\n    }\n\n    /**\n * Apply a directional image animations on a sprite\n * @param sprite the sprite to animate on\n * @param animations the directional animates\n */\n    //% blockId=set_animation\n    //% block=\"set $sprite=variables_get(mySprite) with animations$animations\"\n    //% animations.shadow=create_animation\n    //% group=\"Animate\"\n    //% weight=100\n    //% help=github:pxt-raycasting/docs/set-sprite-animations\n    export function setSpriteAnimations(sprite: Sprite, animations: Animations) {\n        raycastingRender.spriteAnimations[sprite.id] = animations\n    }\n\n    /**\n * Create a directional image animations, multi animations will applied to one round dirctions averagely, start from the left. \n * The reason that directions start from left, is almost all Arcade out-of-box 1 or 2-dirction images are facing left, so that would be convient for using.\n * @param frameInterval the time between changes, eg: 150\n * @param frames1 animation, if this is the first of multi animation it will be used as left, others will \n * @param frames2 optional, used for 2 or more dirctional\n * @param frames3 optional, used for 3 or more dirctional\n * @param frames4 optional, used for 4 or more dirctional\n */\n    //% blockId=create_animation\n    //% block=\"interval$frameInterval=timePicker animates:$frames1=animation_editor|| $frames2=animation_editor $frames3=animation_editor $frames4=animation_editor\"\n    //% inlineInputMode=inline\n    //% group=\"Animate\"\n    //% weight=100\n    //% help=github:pxt-raycasting/docs/create-animations\n    export function createAnimations(frameInterval: number, frames1: Image[], frames2?: Image[], frames3?: Image[], frames4?: Image[]): Animations {\n        const animationList = [frames1]\n        if (frames2) animationList.push(frames2)\n        if (frames3) animationList.push(frames3)\n        if (frames4) animationList.push(frames4)\n        return new Animations(frameInterval, animationList)\n    }\n\n    /**\n     * Get the Render\n     * @param img the image\n     */\n    //% group=\"Instance\"\n    //% blockId=rcRender_getRCRenderInstance block=\"raycasting render\"\n    //% expandableArgumentMode=toggle\n    //% weight=100 \n    //% blockHidden=true\n    //% hidden=1\n    export function getRCRenderInstance(): RayCastingRender {\n        return raycastingRender\n    }\n\n    /**\n     * Get the render Sprite, which create automatically, for physical collisions, and holding the view point.\n     * You can consider it as \"myself\", and operate it like a usual sprite, eg.: position, speed, scale, collision, ...\n     * But properties relative 3D, eg. ZOffset, ZPosition, viewAngle, and etc. are not in the Sprite class.\n     */\n    //% group=\"Instance\"\n    //% blockId=rcRender_getRenderSpriteVariable block=\"myself sprite\"\n    //% expandableArgumentMode=toggle\n    //% blockSetVariable=mySprite\n    //% weight=99\n    //% help=github:pxt-raycasting/get-render-sprite-variable\n    export function getRenderSpriteVariable(): Sprite {\n        return raycastingRender.sprSelf\n    }\n\n    /**\n     * Get the render Sprite, which create automatically, for physical collisions, and holding the view point.(but get/set view direction with dirX/dirY, which not in the Sprite class) \n     * You can consider it as \"myself\", and operate it like a usual sprite.\n     * eg: position, speed, scale, collision, ...\n     */\n    //% group=\"Instance\"\n    //% blockId=rcRender_getRenderSpriteInstance block=\"myself sprite\"\n    //% expandableArgumentMode=toggle\n    //% weight=98\n    //% help=github:pxt-raycasting/docs/get-render-sprite-instance\n    export function getRenderSpriteInstance(): Sprite {\n        return raycastingRender.sprSelf\n    }\n\n    /**\n     * Toggle current view mode\n     */\n    //% blockId=rcRender_toggleViewMode block=\"toggle current view mode\"\n    //% group=\"Basic\"\n    //% weight=89\n    //% help=github:pxt-raycasting/docs/toggle-view-mode\n    export function toggleViewMode() {\n        raycastingRender.viewMode = raycastingRender.viewMode == ViewMode.tilemapView ? ViewMode.isometricView : ViewMode.tilemapView\n    }\n\n    /**\n     * Current view mode is the specific one?\n     * @param viewMode\n     */\n    //% blockId=rcRender_isViewMode block=\"current is $viewMode\"\n    //% group=\"Basic\"\n    //% weight=88\n    //% help=github:pxt-raycasting/docs/is-view-mode\n    export function isViewMode(viewMode: ViewMode): boolean {\n        return viewMode == raycastingRender.viewMode\n    }\n\n    /**\n     * Set view mode\n     * @param viewMode\n     */\n    //% blockId=rcRender_setViewMode block=\"set view mode $viewMode\"\n    //% group=\"Basic\"\n    //% weight=87\n    //% help=github:pxt-raycasting/docs/set-view-mode\n    export function setViewMode(viewMode: ViewMode) {\n        raycastingRender.viewMode = viewMode\n    }\n\n    /**\n     * Get render arribute\n     * @param viewMode\n     */\n    //% group=\"Basic\"\n    //% block=\"get %attribute\" \n    //% blockId=rcRender_getAttribute\n    //% weight=83\n    //% help=github:pxt-raycasting/docs/get-attribute\n    export function getAttribute(attr: attribute): number {\n        switch (attr) {\n            case attribute.dirX:\n                return raycastingRender.dirX\n            case attribute.dirY:\n                return raycastingRender.dirY\n            case attribute.fov:\n                return raycastingRender.fov\n            case attribute.wallZScale:\n                return raycastingRender.wallZScale\n            default:\n                return 0\n        }\n    }\n\n    /**\n     * Set render arribute\n     * @param viewMode\n     */\n    //% group=\"Basic\"\n    //% block=\"set %attribute = %value\" \n    //% blockId=rcRender_setAttribute\n    //% weight=82\n    //% help=github:pxt-raycasting/docs/set-attribute\n    export function setAttribute(attr: attribute, value: number) {\n        switch (attr) {\n            case attribute.dirX:\n                raycastingRender.dirX = value\n                break\n            case attribute.dirY:\n                raycastingRender.dirY = value\n                break\n            case attribute.fov:\n                if (value < 0) value = 0\n                raycastingRender.fov = value\n                break\n            case attribute.wallZScale:\n                if (value < 0) value = 0\n                raycastingRender.wallZScale = value\n                break\n            default:\n        }\n    }\n\n    /**\n     * Get default FOV (field of view) value\n     * @param viewMode\n     */\n    //% group=\"Basic\"\n    //% block=\"defaultFov\"\n    //% blockId=rcRender_getDefaultFov\n    //% weight=81\n    //% help=github:pxt-raycasting/docs/get-default-fov\n    export function getDefaultFov(): number {\n        return defaultFov\n    }\n\n    /**\n     * Set view angle\n     * @param angle, unit: degree 0~360\n     */\n    //% blockId=rcRender_setViewAngleInDegree block=\"set view angle$angle\"\n    //% angle.min=0 angle.max=360 angle.defl=90\n    //% group=\"Basic\"\n    //% weight=80\n    //% help=github:pxt-raycasting/docs/set-view-angle-in-degree\n    export function setViewAngleInDegree(angle: number) {\n        raycastingRender.viewAngle = angle * Math.PI / 180\n    }\n\n    /**\n     * Set view angle by dirX and dirY\n     * @param dirX\n     * @param dirY\n     */\n    //% blockId=rcRender_setViewAngle block=\"set view angle by dirX%dirX and dirY%dirY\"\n    //% group=\"Basic\"\n    //% weight=79\n    //% help=github:pxt-raycasting/docs/set-view-angle\n    export function setViewAngle(dirX: number, dirY: number) {\n        raycastingRender.viewAngle = Math.atan2(dirY, dirX)\n    }\n\n    /**\n     * Set floating offset height for a sprite at Z direction\n     * @param sprite\n     * @param Zoffset Negative floats down, affirmative goes up\n     * @param duration moving time, 0 for immediately, unit: ms\n     */\n    //% blockId=rcRender_setZOffset block=\"set Sprite %spr=variables_get(mySprite) floating %offset pixels|| duration $duration=timePicker|ms \"\n    //% offset.min=-100 offset.max=100 offset.defl=8\n    //% duration.min=0 duration.max=5000 duration.defl=0\n    //% group=\"Dimension Z\"\n    //% weight=77\n    //% blockHidden\n    //% help=github:pxt-raycasting/docs/set-z-offset\n    export function setZOffset(sprite: Sprite, offset: number, duration?: number) {\n        raycastingRender.setZOffset(sprite, offset, duration)\n    }\n\n    /**\n     * Set arribute of a Sprite\n     * @param spr Sprite\n     * @param attr RCSpriteAttribute\n     */\n    //% group=\"Dimension Z\"\n    //% block=\"set Sprite %spr=variables_get(mySprite) %attribute = %value\"\n    //% blockId=rcRender_setSpriteAttribute\n    //% weight=75\n    //% help=github:pxt-raycasting/docs/set-sprite-attribute\n    export function setSpriteAttribute(spr: Sprite, attr: RCSpriteAttribute, value: number) {\n        switch (attr) {\n            case RCSpriteAttribute.ZOffset:\n                raycastingRender.setZOffset(spr, value, 0)\n                break\n            case RCSpriteAttribute.ZPosition:\n                raycastingRender.getMotionZ(spr).p = Render.tofpx(value)\n                break\n            case RCSpriteAttribute.ZVelocity:\n                raycastingRender.getMotionZ(spr).v = Render.tofpx(value)\n                break\n            case RCSpriteAttribute.ZAcceleration:\n                raycastingRender.getMotionZ(spr).a = Render.tofpx(value)\n                break\n            default:\n        }\n    }\n\n    /**\n     * Get arribute of a Sprite\n     * @param spr Sprite\n     * @param attr RCSpriteAttribute\n     */\n    //% group=\"Dimension Z\"\n    //% block=\"get Sprite %spr=variables_get(mySprite) %attribute\"\n    //% blockId=rcRender_getSpriteAttribute\n    //% weight=74\n    //% help=github:pxt-raycasting/docs/get-sprite-attribute\n    export function getSpriteAttribute(spr:Sprite, attr: RCSpriteAttribute): number {\n        switch (attr) {\n            case RCSpriteAttribute.ZOffset:\n                return raycastingRender.getMotionZ(spr).offset\n            case RCSpriteAttribute.ZPosition:\n                return raycastingRender.getMotionZ(spr).p << Render.fpx\n            case RCSpriteAttribute.ZVelocity:\n                return raycastingRender.getMotionZ(spr).v << Render.fpx\n            case RCSpriteAttribute.ZAcceleration:\n                return raycastingRender.getMotionZ(spr).a << Render.fpx\n            default:\n                return 0\n        }\n    }\n\n    /**\n     * Check if 2 sprites overlaps each another in Z dimension\n     * Best work together with sprites.onOverlap(kind1, kind2)\n     * @param sprite1\n     * @param sprite2\n     */\n    //% blockId=rcRender_isSpritesOverlapZ\n    //% block=\"is sprites $sprite1=variables_get(mySprite) and $sprite2=variables_get(mySprite2) overlaps in Z dimension\"\n    //% group=\"Dimension Z\"\n    //% weight=71\n    //% help=github:pxt-raycasting/docs/is-sprites-overlap-z\n    export function isSpritesOverlapZ(sprite1: Sprite, sprite2: Sprite): boolean {\n        return raycastingRender.isOverlapZ(sprite1, sprite2)\n    }\n\n    /**\n     * Make sprite jump, with specific height and duration\n     * Jump can only happened when sprite is standing, current height = its offset .\n     * @param sprite\n     * @param height jump height in pixel\n     * @param duration hover time span, unit: ms\n     */\n    //% blockId=rcRender_jumpWithHeightAndDuration block=\"Sprite %spr=variables_get(mySprite) jump, with height $height duration $duration=timePicker|ms \"\n    //% height.min=0 height.max=100 height.defl=16\n    //% duration.min=50 duration.max=5000 duration.defl=500\n    //% group=\"Dimension Z\"\n    //% weight=70\n    //% help=github:pxt-raycasting/docs/jump-with-height-and-duration\n    export function jumpWithHeightAndDuration(sprite: Sprite, height: number, duration: number) {\n        raycastingRender.jumpWithHeightAndDuration(sprite, height, duration)\n    }\n\n    /**\n     * Make sprite jump, with specific speed and acceleration\n     * Simular with Move block, but jump can only happened when sprite is standing, current height = its offset.\n     * @param sprite\n     * @param v vetical speed, unit: pixel/s\n     * @param a vetical acceleration, unit: pixel/sÂ²\n     */\n    //% blockId=rcRender_jump block=\"Sprite %spr=variables_get(mySprite) jump||, with speed $v=spriteSpeedPicker acceleration $a\"\n    //% v.min=-100 v.max=100 v.defl=60\n    //% a.min=-1000 a.max=1000 a.defl=-250\n    //% group=\"Dimension Z\"\n    //% weight=68\n    //% help=github:pxt-raycasting/docs/jump\n    export function jump(sprite: Sprite, v?: number, a?: number) {\n        raycastingRender.jump(sprite, v, a)\n    }\n\n    /**\n     * Make sprite jump, with specific speed and acceleration\n     * @param sprite\n     * @param v vetical speed, unit: pixel/s\n     * @param a vetical acceleration, unit: pixel/sÂ²\n     */\n    //% blockId=rcRender_move block=\"Sprite %spr=variables_get(mySprite) move, with speed $v=spriteSpeedPicker|| acceleration $a\"\n    //% v.min=-200 v.max=200 v.defl=60\n    //% a.min=-1000 a.max=1000 a.defl=-250\n    //% group=\"Dimension Z\"\n    //% weight=66\n    //% help=github:pxt-raycasting/docs/move\n    export function move(sprite: Sprite, v?: number, a?: number) {\n        raycastingRender.move(sprite, v, a)\n    }\n\n    /**\n     * Control the self sprite using the direction buttons from the controller. \n     * To stop controlling self sprite, pass 0 for v and va.\n     *\n     * @param v The velocity used for forward/backword movement when up/down is pressed, in pixel/s\n     * @param va The angle velocity used for turn view direction when left/right is pressed, in radian/s.\n     */\n    //% blockId=\"rcRender_moveWithController\" block=\"move with buttons velocity $v|| turn speed $va camera sway$cameraSway pixels\"\n    //% weight=60\n    //% expandableArgumentMode=\"toggle\"\n    //% v.defl=2 va.defl=3\n    //% group=\"Advanced\"\n    //% v.shadow=\"spriteSpeedPicker\"\n    //% va.shadow=\"spriteSpeedPicker\"\n    //% help=github:pxt-raycasting/docs/move-with-controller\n    export function moveWithController(v: number = 2, va: number = 3, cameraSway?:number) {\n        raycastingRender.velocity = v\n        raycastingRender.velocityAngle = va\n        if(cameraSway!=undefined)\n            raycastingRender.cameraSway=cameraSway|0\n    }\n\n    /**\n     * Render takeover all sprites in current scene\n     * Render will call this automatically, but maybe not in time enough.\n     * If you saw sprite draw at its tilemap position on screen, call this just after created the sprite.\n     */\n    //% blockId=rcRender_takeoverSceneSprites \n    //% block=\"takeover sprites in scene\"\n    //% group=\"Advanced\"\n    //% weight=49\n    //% help=github:pxt-raycasting/docs/takeover-scene-sprites\n    export function takeoverSceneSprites() {\n        raycastingRender.takeoverSceneSprites()\n    }\n\n    /**\n     * Run on sprite dirction updated, present view point to Sprite facing dirction, or which angle you see of the sprite.\n     * Just using with other animation extensions, to set proper Image for sprite.\n     * Not required, if you have used the set animations block provided.\n     * @param dir It is a float number, 0~1 corresponds to 0~360Â°, suggest use Math.round(dir*dirAniTotalCount)%dirAniTotalCount to get index of direction\n     */\n    //% blockId=rcRender_registerOnSpriteDirectionUpdateHandler\n    //% block=\"run code when sprite $spr dirction updated to $dir\"\n    //% draggableParameters\n    //% group=\"Advanced\"\n    //% weight=48\n    //% help=github:pxt-raycasting/docs/register-on-sprite-direction-update-handler\n    export function registerOnSpriteDirectionUpdateHandler(handler: (spr: Sprite, dir: number) => void) {\n        raycastingRender.registerOnSpriteDirectionUpdate(handler)\n    }\n}","animation.ts":"//////////////////////// animation.ts contents of previous version, just for test.ts here for convenience /////////////////////\n// file contents:\n// directional animations defines for enging_raycasting.ts\n// for convenience, constructed animations as below, which images are builtin in Arcade, \n// in order from easy to complex\n\n// each are 2D Image array, Image[][]: \n// 1st dimension is direction: \n//    length=1 to any, e.g. 1,2,3,4,...,8,..., engine can automatically arange them to 0~360Â° \n//    order: start from left, then folling with others in CW order\n//    e.g: \n//         2 directions should be [leftAni,RightAni], \n//         4-direction should be [leftAni, frontAni, rightAni, backAni], \n//         8-direction=[l,lf,f,fr,r,rb,b,lb], ...\n//    the reason that directions start from left, is almost all Arcade builtin one side images are facing left, so that would be convient for using.\n// 2nd dimension is animation Images\n//    length=1 to any, e.g. 1,2,3,4,..., engine will automatically loop them by aniInterval(set when create CompactSprite, or use default)\n\n\n//simplest, just one static image, looks the same in all angle of view\n//% whenUsed\nconst texturesDonut = [[sprites.food.smallDonut]]\n//% whenUsed\nconst texturesBigCake = [[sprites.food.bigCake]]\n\n//1-direction, with ani, looks the same Ani in all angle of view\n//% whenUsed\nconst texturesCoin = [[sprites.builtin.coin0, sprites.builtin.coin1, sprites.builtin.coin2, sprites.builtin.coin3, sprites.builtin.coin4, sprites.builtin.coin5]]\n\n//% whenUsed\nconst texturesDog = [[sprites.builtin.dog0, sprites.builtin.dog1, sprites.builtin.dog2]]\n//% whenUsed\nconst texturesDuck = [[sprites.duck.duck1, sprites.duck.duck2, sprites.duck.duck3, sprites.duck.duck4, sprites.duck.duck5, sprites.duck.duck6],\n    [sprites.duck.duck1, sprites.duck.duck2, sprites.duck.duck3, sprites.duck.duck4, sprites.duck.duck5, sprites.duck.duck6]]\nimagesFlipX(texturesDuck[0])\n\n//2-direction, with ani, looks difference from left or right side\n//% whenUsed\nconst texturesPlane = [[sprites.vehicle.plane0, sprites.vehicle.plane1, sprites.vehicle.plane2, sprites.vehicle.plane3, sprites.vehicle.plane4, sprites.vehicle.plane5],\n[sprites.vehicle.plane0, sprites.vehicle.plane1, sprites.vehicle.plane2, sprites.vehicle.plane3, sprites.vehicle.plane4, sprites.vehicle.plane5]]\n//no right side ani images builtin, so make them from lefts, and then flipX\nimagesFlipX(texturesPlane[1])\n\n//% whenUsed\nconst texturesFish = [[sprites.builtin.angelFish0, sprites.builtin.angelFish1, sprites.builtin.angelFish2, sprites.builtin.angelFish3],\n[sprites.builtin.angelFish0, sprites.builtin.angelFish1, sprites.builtin.angelFish2, sprites.builtin.angelFish3]]\nimagesFlipX(texturesFish[1])\n\n//4-direction\n//% whenUsed\nconst texturesHero = [\n    [sprites.castle.heroWalkSideLeft1, sprites.castle.heroWalkSideLeft2, sprites.castle.heroWalkSideLeft3, sprites.castle.heroWalkSideLeft4],\n    [sprites.castle.heroWalkFront1, sprites.castle.heroWalkFront2, sprites.castle.heroWalkFront3, sprites.castle.heroWalkFront4],\n    [sprites.castle.heroWalkSideRight1, sprites.castle.heroWalkSideRight2, sprites.castle.heroWalkSideRight3, sprites.castle.heroWalkSideRight4],\n    [sprites.castle.heroWalkBack1, sprites.castle.heroWalkBack2, sprites.castle.heroWalkBack3, sprites.castle.heroWalkBack4],\n]\n\n//% whenUsed\nconst texturesPrincess2 = [\n    [sprites.castle.princess2Left1, sprites.castle.princess2Left2],\n    [sprites.castle.princess2WalkFront1, sprites.castle.princess2WalkFront2, sprites.castle.princess2WalkFront3, sprites.castle.princess2WalkFront2],\n    [sprites.castle.princess2Right1, sprites.castle.princess2Right2],\n    [sprites.castle.princess2WalkBack1, sprites.castle.princess2WalkBack2, sprites.castle.princess2WalkBack3, sprites.castle.princess2WalkBack2],\n]\n\n//4-direction, but back side has only 1 image, so no ani when looking from back\n//% whenUsed\nconst texturesSkelly = [\n    [sprites.castle.skellyWalkLeft1, sprites.castle.skellyWalkLeft2],\n    [sprites.castle.skellyWalkFront1, sprites.castle.skellyWalkFront2, sprites.castle.skellyWalkFront3],\n    [sprites.castle.skellyWalkRight1, sprites.castle.skellyWalkRight2],\n    [img`\n\t        ........................\n\t        ........................\n\t        ........................\n\t        ........................\n\t        ..........ffff..........\n\t        ........ff1111ff........\n\t        .......fb111111bf.......\n\t        .......f11111111f.......\n\t        ......fd11111111df......\n\t        ......fd11111111df......\n\t        ......fd11111111df......\n\t        ......fb11111111bf......\n\t        ......fcd111111dcf......\n\t        .......fb111111bf.......\n\t        .....ffffdb1bdcfff......\n\t        ....fc111cfbfbc111cf....\n\t        ....f11111ffff11111f....\n\t        ....fbfbfbffffffbfbf....\n\t        .........ffffff.........\n\t        ..........fff...........\n\t        ........................\n\t        ........................\n\t        ........................\n\t        ........................\n\t    `],\n]\n\n//% whenUsed\nconst texturesPrincess = [\n    [sprites.castle.princessLeft0, sprites.castle.princessLeft1, sprites.castle.princessLeft0, sprites.castle.princessLeft2],\n    [sprites.castle.princessFront0, sprites.castle.princessFront1, sprites.castle.princessFront0, sprites.castle.princessFront2],\n    [],\n    [sprites.castle.princessBack0, sprites.castle.princessBack1, sprites.castle.princessBack0, sprites.castle.princessBack2],\n]\ntexturesPrincess[0].forEach((v, i) => {\n    texturesPrincess[2].push(v.clone())\n    texturesPrincess[2][i].flipX()\n}\n)\n\nfunction imagesFlipX(ani: Image[]) {\n    ani.forEach((img, i) => {\n        ani[i] = img.clone() //don't worry memery leak or waste, cause old images are still using by left\n        ani[i].flipX()\n    })\n}\n\n//////////////////////// end of animation.ts contents of previous version //////////////\n\n","docs/get-render-sprite-variable.md":"# get Render Sprite Variable\n\nGet the render Sprite, which create automatically, for physical collisions, and holding the view point.\n\n```sig\nRender.getRenderSpriteVariable()\n```\n\n## ~hint\n* You can consider it as \"myself\", and operate it like a usual sprite, eg.: position, speed, scale, collision, ... \n* But properties relative 3D, eg. ZOffset, ZPosition, viewAngle, and etc. are not in the Sprite class.\n## ~\n\n## Parameters\n\n* none\n\n## Returns\n\n* a game [sprite](/types/sprite) which raycasting render using for view point.\n\n## Example\n\n```blocks\nlet mySprite = Render.getRenderSpriteVariable()\nmySprite.setPosition(100,100)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/get-render-sprite-instance.md":"# get Render Sprite Instance\n\nGet the render Sprite, which create automatically, for physical collisions, and holding the view point.\n\n```sig\nRender.getRenderSpriteInstance()\n```\n\n## ~hint\n* You can consider it as \"myself\", and operate it like a usual sprite, eg.: position, speed, scale, collision, ... \n* But properties relative 3D, eg. ZOffset, ZPosition, viewAngle, and etc. are not in the Sprite class.\n## ~\n\n## Parameters\n\n* none\n\n## Returns\n\n* a game [sprite](/types/sprite) which raycasting render using for view point.\n\n## Example\n\n```blocks\nRender.getRenderSpriteInstance().setPosition(100,100)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/create-animations.md":"# create Animations\n\n * Create a directional image animations, multi animations will applied to one round dirctions averagely, start from the left. \n\n```sig\nRender.createAnimations(100,[sprites.food.smallDonut])\n```\n\n## ~hint\n * The reason that directions start from left, is almost all Arcade out-of-box 1 or 2-dirction images are facing left, so that would be convient for using.\n## ~\n\n## Parameters\n * **frameInterval** the time between changes, eg: 150\n * **frames1** animation, if this is the first of multi animation it will be used as left, others will \n * **frames2** optional, used for 2 or more dirctional\n * **frames3** optional, used for 3 or more dirctional\n * **frames4** optional, used for 4 or more dirctional\n\n## ~hint\n * 4 frames provided, animations would left, front, right, back side in order.\n * 2 frames provided, animations would left, right side in order.\n## ~\n\n\n## Returns\n\n* an Animations object that can be set to [Render.setSpriteAnimations(Animations)](docs/set-sprite-animations.md).\n\n## Example\n\n```blocks\nlet mySprite = Render.getRenderSpriteVariable()\nmySprite.setPosition(100,100)\nlet animations = Render.createAnimations(150, [img`\n    . . . f 4 4 f f f f . . . . . . \n    . . f 4 5 5 4 5 f b f f . . . . \n    . . f 5 5 5 5 4 e 3 3 b f . . . \n    . . f e 4 4 4 e 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e e 3 b e 3 3 3 3 f . . \n    . f 3 3 e e e f f 3 3 3 3 f . . \n    . f 3 e e e f b f b b b b f . . \n    . . f e 4 4 f 1 e b b b b f . . \n    . . . f 4 4 4 4 f b b b b f f . \n    . . . f e e e f f f b b b b f . \n    . . . f d d d e 4 4 f b b f . . \n    . . . f d d d e 4 4 e f f . . . \n    . . f b d b d b e e b f . . . . \n    . . f f 1 d 1 d 1 d f f . . . . \n    . . . . f f b b f f . . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . f 4 4 f f f f . . . . . . \n    . . f 4 5 5 4 5 f b f f . . . . \n    . . f 5 5 5 5 4 e 3 3 b f . . . \n    . . f e 4 4 4 e 3 3 3 3 b f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e e 3 b e 3 3 3 3 f . . \n    . f 3 3 e e e f f 3 3 3 3 f . . \n    . . f e e e f b f b b b b f f . \n    . . . e 4 4 f 1 e b b b b b f . \n    . . . f 4 4 4 4 f b b b b b f . \n    . . . f d d d e 4 4 b b b f . . \n    . . . f d d d e 4 4 f f f . . . \n    . . f d d d b b e e b b f . . . \n    . . f b d 1 d 1 d d b f . . . . \n    . . . f f f b b f f f . . . . . \n    `], [img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f 3 3 f f e e e e f f 3 3 f . \n    . f b b f b f e e f b f b b f . \n    . f b b e 1 f 4 4 f 1 e b b f . \n    f f b b f 4 4 4 4 4 4 f b b f f \n    f b b f f f e e e e f f f b b f \n    . f e e f b d d d d b f e e f . \n    . . e 4 c d d d d d d c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . f f . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . f e 3 3 3 3 3 3 3 3 3 3 e f . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f b 3 f f e e e e f f 3 b f . \n    f f b b f b f e e f b f b b f f \n    f b b b e 1 f 4 4 f 1 e b b b f \n    . f b b e e 4 4 4 4 4 f b b f . \n    . . f 4 4 4 e d d d b f e f . . \n    . . f e 4 4 e d d d d c 4 e . . \n    . . . f e e d d b d b b f e . . \n    . . . f f 1 d 1 d 1 1 f f . . . \n    . . . . . f f f b b f . . . . . \n    `,img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f 3 3 f f e e e e f f 3 3 f . \n    . f b b f b f e e f b f b b f . \n    . f b b e 1 f 4 4 f 1 e b b f . \n    f f b b f 4 4 4 4 4 4 f b b f f \n    f b b f f f e e e e f f f b b f \n    . f e e f b d d d d b f e e f . \n    . . e 4 c d d d d d d c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . f f . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . f e 3 3 3 3 3 3 3 3 3 3 e f . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f b 3 f f e e e e f f 3 b f . \n    f f b b f b f e e f b f b b f f \n    f b b b e 1 f 4 4 f 1 e b b b f \n    . f b b f 4 4 4 4 4 e e b b f . \n    . . f e f b d d d e 4 4 4 f . . \n    . . e 4 c d d d d e 4 4 e f . . \n    . . e f b b d b d d e e f . . . \n    . . . f f 1 1 d 1 d 1 f f . . . \n    . . . . . f b b f f f . . . . . \n    `], [img`\n    . . . . . . f f f f 4 4 f . . . \n    . . . . f f b f 5 4 5 5 4 f . . \n    . . . f b 3 3 e 4 5 5 5 5 f . . \n    . . f b 3 3 3 3 e 4 4 4 e f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . . f 3 3 3 3 e b 3 e e 3 3 f . \n    . . f 3 3 3 3 f f e e e 3 3 f . \n    . . f b b b b f b f e e e 3 f . \n    . . f b b b b e 1 f 4 4 e f . . \n    . f f b b b b f 4 4 4 4 f . . . \n    . f b b b b f f f e e e f . . . \n    . . f b b f 4 4 e d d d f . . . \n    . . . f f e 4 4 e d d d f . . . \n    . . . . f b e e b d b d b f . . \n    . . . . f f d 1 d 1 d 1 f f . . \n    . . . . . . f f b b f f . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . . f f f f 4 4 f . . . \n    . . . . f f b f 5 4 5 5 4 f . . \n    . . . f b 3 3 e 4 5 5 5 5 f . . \n    . . f b 3 3 3 3 e 4 4 4 e f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 3 f . \n    . . f 3 3 3 3 e b 3 e e 3 3 f . \n    . . f 3 3 3 3 f f e e e 3 3 f . \n    . f f b b b b f b f e e e f . . \n    . f b b b b b e 1 f 4 4 e . . . \n    . f b b b b b f 4 4 4 4 f . . . \n    . . f b b b 4 4 e d d d f . . . \n    . . . f f f 4 4 e d d d f . . . \n    . . . f b b e e b b d d d f . . \n    . . . . f b d d 1 d 1 d b f . . \n    . . . . . f f f b b f f f . . . \n    `], [img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 3 f . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b c f \n    f b b b b b b b b b b b b b b f \n    . f c c b b b b b b b b c c f . \n    . . e 4 c f f f f f f c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b f . \n    f b b b b b b b b b b b b c f . \n    f f b b b b b b b b b b c f . . \n    . f c c c f f f f f f f e c . . \n    . . . f b b d b d d e 4 4 e . . \n    . . . f f 1 1 d 1 d e e f . . . \n    . . . . . f b b f f f . . . . . \n    `,img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 3 f . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b c f \n    f b b b b b b b b b b b b b b f \n    . f c c b b b b b b b b c c f . \n    . . e 4 c f f f f f f c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    . f b b b b b b b b b b b b c f \n    . f c b b b b b b b b b b b b f \n    . . f c b b b b b b b b b b f f \n    . . c e f f f f f f f c c c f . \n    . . e 4 4 e d d b d b b f . . . \n    . . . f e e d 1 d 1 1 f f . . . \n    . . . . . f f f b b f . . . . . \n    `])\nRender.setSpriteAnimations(mySprite, animations)\n\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\nanimation\n```","docs/set-sprite-animations.md":"# set Sprite Animations\n\n * Apply a directional animations on a sprite\n\n```sig\nRender.setSpriteAnimations(Sprite, Render.Animations)\n```\n\n## Parameters\n * **sprite** the [sprite](/types/sprite) to animate on\n * **animations** the directional animates, created by [Render.createAnimations](docs/create-animations.md)\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nlet mySprite = Render.getRenderSpriteVariable()\nmySprite.setPosition(100,100)\nlet animations = Render.createAnimations(150, [img`\n    . . . f 4 4 f f f f . . . . . . \n    . . f 4 5 5 4 5 f b f f . . . . \n    . . f 5 5 5 5 4 e 3 3 b f . . . \n    . . f e 4 4 4 e 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e e 3 b e 3 3 3 3 f . . \n    . f 3 3 e e e f f 3 3 3 3 f . . \n    . f 3 e e e f b f b b b b f . . \n    . . f e 4 4 f 1 e b b b b f . . \n    . . . f 4 4 4 4 f b b b b f f . \n    . . . f e e e f f f b b b b f . \n    . . . f d d d e 4 4 f b b f . . \n    . . . f d d d e 4 4 e f f . . . \n    . . f b d b d b e e b f . . . . \n    . . f f 1 d 1 d 1 d f f . . . . \n    . . . . f f b b f f . . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . f 4 4 f f f f . . . . . . \n    . . f 4 5 5 4 5 f b f f . . . . \n    . . f 5 5 5 5 4 e 3 3 b f . . . \n    . . f e 4 4 4 e 3 3 3 3 b f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e e 3 b e 3 3 3 3 f . . \n    . f 3 3 e e e f f 3 3 3 3 f . . \n    . . f e e e f b f b b b b f f . \n    . . . e 4 4 f 1 e b b b b b f . \n    . . . f 4 4 4 4 f b b b b b f . \n    . . . f d d d e 4 4 b b b f . . \n    . . . f d d d e 4 4 f f f . . . \n    . . f d d d b b e e b b f . . . \n    . . f b d 1 d 1 d d b f . . . . \n    . . . f f f b b f f f . . . . . \n    `], [img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f 3 3 f f e e e e f f 3 3 f . \n    . f b b f b f e e f b f b b f . \n    . f b b e 1 f 4 4 f 1 e b b f . \n    f f b b f 4 4 4 4 4 4 f b b f f \n    f b b f f f e e e e f f f b b f \n    . f e e f b d d d d b f e e f . \n    . . e 4 c d d d d d d c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . f f . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . f e 3 3 3 3 3 3 3 3 3 3 e f . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f b 3 f f e e e e f f 3 b f . \n    f f b b f b f e e f b f b b f f \n    f b b b e 1 f 4 4 f 1 e b b b f \n    . f b b e e 4 4 4 4 4 f b b f . \n    . . f 4 4 4 e d d d b f e f . . \n    . . f e 4 4 e d d d d c 4 e . . \n    . . . f e e d d b d b b f e . . \n    . . . f f 1 d 1 d 1 1 f f . . . \n    . . . . . f f f b b f . . . . . \n    `,img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f 3 3 f f e e e e f f 3 3 f . \n    . f b b f b f e e f b f b b f . \n    . f b b e 1 f 4 4 f 1 e b b f . \n    f f b b f 4 4 4 4 4 4 f b b f f \n    f b b f f f e e e e f f f b b f \n    . f e e f b d d d d b f e e f . \n    . . e 4 c d d d d d d c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . f f . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 4 5 5 5 5 4 e f . . . \n    . . f b 3 e 4 4 4 4 e 3 b f . . \n    . f e 3 3 3 3 3 3 3 3 3 3 e f . \n    . f 3 3 e b 3 e e 3 b e 3 3 f . \n    . f b 3 f f e e e e f f 3 b f . \n    f f b b f b f e e f b f b b f f \n    f b b b e 1 f 4 4 f 1 e b b b f \n    . f b b f 4 4 4 4 4 e e b b f . \n    . . f e f b d d d e 4 4 4 f . . \n    . . e 4 c d d d d e 4 4 e f . . \n    . . e f b b d b d d e e f . . . \n    . . . f f 1 1 d 1 d 1 f f . . . \n    . . . . . f b b f f f . . . . . \n    `], [img`\n    . . . . . . f f f f 4 4 f . . . \n    . . . . f f b f 5 4 5 5 4 f . . \n    . . . f b 3 3 e 4 5 5 5 5 f . . \n    . . f b 3 3 3 3 e 4 4 4 e f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . . f 3 3 3 3 e b 3 e e 3 3 f . \n    . . f 3 3 3 3 f f e e e 3 3 f . \n    . . f b b b b f b f e e e 3 f . \n    . . f b b b b e 1 f 4 4 e f . . \n    . f f b b b b f 4 4 4 4 f . . . \n    . f b b b b f f f e e e f . . . \n    . . f b b f 4 4 e d d d f . . . \n    . . . f f e 4 4 e d d d f . . . \n    . . . . f b e e b d b d b f . . \n    . . . . f f d 1 d 1 d 1 f f . . \n    . . . . . . f f b b f f . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . . f f f f 4 4 f . . . \n    . . . . f f b f 5 4 5 5 4 f . . \n    . . . f b 3 3 e 4 5 5 5 5 f . . \n    . . f b 3 3 3 3 e 4 4 4 e f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 3 f . \n    . . f 3 3 3 3 e b 3 e e 3 3 f . \n    . . f 3 3 3 3 f f e e e 3 3 f . \n    . f f b b b b f b f e e e f . . \n    . f b b b b b e 1 f 4 4 e . . . \n    . f b b b b b f 4 4 4 4 f . . . \n    . . f b b b 4 4 e d d d f . . . \n    . . . f f f 4 4 e d d d f . . . \n    . . . f b b e e b b d d d f . . \n    . . . . f b d d 1 d 1 d b f . . \n    . . . . . f f f b b f f f . . . \n    `], [img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 3 f . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b c f \n    f b b b b b b b b b b b b b b f \n    . f c c b b b b b b b b c c f . \n    . . e 4 c f f f f f f c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b f . \n    f b b b b b b b b b b b b c f . \n    f f b b b b b b b b b b c f . . \n    . f c c c f f f f f f f e c . . \n    . . . f b b d b d d e 4 4 e . . \n    . . . f f 1 1 d 1 d e e f . . . \n    . . . . . f b b f f f . . . . . \n    `,img`\n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f 3 3 3 3 3 3 3 3 3 3 3 3 f . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    f c b b b b b b b b b b b b c f \n    f b b b b b b b b b b b b b b f \n    . f c c b b b b b b b b c c f . \n    . . e 4 c f f f f f f c 4 e . . \n    . . e f b d b d b d b b f e . . \n    . . . f f 1 d 1 d 1 d f f . . . \n    . . . . . f f b b f f . . . . . \n    `,img`\n    . . . . . . . . . . . . . . . . \n    . . . . . f f 4 4 f f . . . . . \n    . . . . f 5 4 5 5 4 5 f . . . . \n    . . . f e 3 3 3 3 3 3 e f . . . \n    . . f b 3 3 3 3 3 3 3 3 b f . . \n    . . f 3 3 3 3 3 3 3 3 3 3 f . . \n    . f b 3 3 3 3 3 3 3 3 3 3 b f . \n    . f b b 3 3 3 3 3 3 3 3 b b f . \n    . f b b b b b b b b b b b b f . \n    . f b b b b b b b b b b b b c f \n    . f c b b b b b b b b b b b b f \n    . . f c b b b b b b b b b b f f \n    . . c e f f f f f f f c c c f . \n    . . e 4 4 e d d b d b b f . . . \n    . . . f e e d 1 d 1 1 f f . . . \n    . . . . . f f f b b f . . . . . \n    `])\nRender.setSpriteAnimations(mySprite, animations)\n\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\nanimation\n```","docs/toggle-view-mode.md":"# toggle View Mode\n\n * Toggle current view mode, between tilemapView & raycastingView \n\n```sig\nRender.toggleViewMode()\n```\n\n## ~hint\n * The raycastingView: rendered by raycasting, 3D (or aka 2.5D) \n * The tilemapView: traditional flat tilemap, 2D\n * By default this render working in raycastingView, and can be switch to tilemapView any time, or switch back to raycastingView any time.\n * Could place inside the [on Event of Button](/reference/controller/button/on-event) block, for switch view mode back and forth.\n## ~\n\n## Parameters\n* none\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.toggleViewMode()\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/is-view-mode.md":"# is View Mode\n\n *  Current view mode is the specific one?\n\n```sig\nRender.isViewMode()\n```\n\n## ~hint\n * The raycastingView: rendered by raycasting, 3D (or aka 2.5D) \n * The tilemapView: traditional flat tilemap, 2D\n * By default this render working in raycastingView, and can be switch to tilemapView any time, or switch back to raycastingView any time.\n * According result switch difference background image.\n## ~\n\n## Parameters\n* **viewMode** raycastingView or tilemapView\n\n## Returns\n\n* a [boolean](types/boolean): true if current view mode is specific one.\n\n## Example\n\n```blocks\ncontroller.menu.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.toggleViewMode()\n    if (Render.isViewMode(ViewMode.tilemapView)) {\n        scene.setBackgroundImage(img`\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            `)\n    } else {\n        scene.setBackgroundImage(img`\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            ................................................................................................................................................................\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n            `)\n    }\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-view-mode.md":"# set View Mode\n\n * set current view mode to tilemapView or raycastingView \n\n```sig\nRender.setViewMode()\n```\n\n## ~hint\n * The raycastingView: rendered by raycasting, 3D (or aka 2.5D) \n * The tilemapView: traditional flat tilemap, 2D\n * By default this render working in raycastingView, and can be switch to tilemapView any time, or switch back to raycastingView any time.\n * Could place inside the [on Event of Button](/reference/controller/button/on-event) block, with Pressed/Released, for switch view mode back and forth.\n## ~\n\n## Parameters\n* **viewMode** raycastingView or tilemapView\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\ncontroller.menu.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.setViewMode(ViewMode.tilemapView)\n})\ncontroller.menu.onEvent(ControllerButtonEvent.Released, function () {\n    Render.setViewMode(ViewMode.raycastingView)\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/get-attribute.md":"# get Attribute\n\n * Get render arribute\n\n```sig\nRender.getAttribute()\n```\n\n\n## Parameters\n* **attribute**  dirX,dirY,fov,wallZScale\n## ~hint\n * **dirX**: view direction x\n * **dirY**: view direction y\n * **fov**:  field of view, for zoom in/out, default value can be get by [defaultFov](docs/default-fov.md)\n * **wallZScale**: scale up/down height of walls in z dimension, this is a radio value, default is 1.\n## ~\n\n## Returns\n\n* value according to specific \n\n## Example\n\n```blocks\nlet v=Render.getAttribute(Render.attribute.fov)/2\nRender.SetAttribute(Render.attribute.fov, v)\n)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-attribute.md":"# set Attribute\n\n * Set render arribute\n\n```sig\nRender.setAttribute()\n```\n\n\n## Parameters\n* **attribute**  dirX,dirY,fov,wallZScale\n* **value**\n## ~hint\n * **dirX**: view direction x\n * **dirY**: view direction y\n * **fov**:  field of view, for zoom in/out, default value can be get by [defaultFov](/default-fov)\n * **wallZScale**: scale up/down height of walls in z dimension, this is a radio value, default is 1.\n## ~\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nRender.setAttribute(Render.attribute.fov, Render.getAttribute(Render.attribute.fov)/2)\n)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/get-default-fov.md":"# get Default Fov\n\n * Get default FOV (field of view) value\n\n```sig\nRender.getDefaultFov()\n```\n\n\n## Parameters\n* none\n\n## Returns\n\n* The default fov(field of view) value, is 0.666... (or 2/3)\n\n    ## ~hint\n    * field of view, for zoom in/out\n    * it is a ratio of view plane vector x & y, or \"half view width\" and \"distance to view plane\"\n    * if you facing the wall and 1 wall height a way from it, just seeing wall full fill the screen in vertical direction, the distance=screen.height, so for arcade screen that is: 160/2 /120 = 2/3.\n    * so, half default will zoom in x2, while double default value means very wide( x2 ) field of view\n    ## ~\n\n## Example\n\n```blocks\n\ntiles.setCurrentTilemap(tilemap`level1`)\n\nlet v=Render.getDefaultFov()/2\nRender.SetAttribute(Render.attribute.fov, v)\n)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-view-angle-in-degree.md":"# set View Angle In Degree\n\n * Set view angle\n\n```sig\nRender.setViewAngleInDegree()\n```\n\n## Parameters\n* **angle** angle value 0~360 Â°\n## ~hint\n * angle=0 facing east, 90 facing south; 180 facing west; 270 facing north\n## ~\n\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nRender.setViewAngleInDegree(180)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-view-angle.md":"# set View Angle\n\n * Set view angle\n\n```sig\nRender.setViewAngle()\n```\n\n## Parameters\n* **dirX** facing dirction vector x\n* **dirY** facing dirction vector Y\n## ~hint\n * x=1 y=0 facing east;\n * x=0 y=1 facing south;\n * x=-1 y=0 facing west;\n * x=0 y=-1 facing north\n * dirX/Y values can be any number, not limited in -1,0,1\n * inside, the angle of view = Math.atan2(dirY,dirX)\n## ~\n\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nRender.setViewAngle(0,-1)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-z-offset.md":"# set Z Offset\n\n * Set floating offset height for a sprite at Z direction\n\n```sig\nRender.setZOffset()\n```\n\n\n## Parameters\n* **sprite** the [sprite](/types/sprite) to be set\n* **Zoffset** in pixels, negative floats down, affirmative goes up\n* **duration** moving time, if new value diff from current position at Z dimension. 0 for immediately, unit: ms\n## ~hint\n    * the myself sprite can also be set Z Offset value.\n## ~\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nRender.setZOffset(mySprite, 8)\nRender.setZOffset(Render.getRenderSpriteInstance(), 8)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/is-sprites-overlap-z.md":"# is Sprite Overlap Z\n\n * Check if 2 sprites overlaps each another in Z dimension\n\n```sig\nRender.isSpritesOverlapZ()\n```\n\n\n## Parameters\n* **sprite1** [sprite](/types/sprite) to check with\n* **sprite2** [sprite](/types/sprite) to check with\n## ~hint\n * Best work together with sprites.onOverlap(kind1, kind2), which check overlaping in X&Y dimension\n## ~\n\n## Returns\n\n* a [boolean](types/boolean): true if overlaped at Z dimension, nothing todo with X Y dimension\n\n## Example\n\n```blocks\nsprites.onOverlap(SpriteKind.Enemy, SpriteKind.Projectile, function (sprite, otherSprite) {\n    if (Render.isSpritesOverlapZ(sprite, otherSprite)) {\n        otherSprite.destroy()\n        info.changeScoreBy(1)\n    }\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/jump-with-height-and-duration.md":"# jump With Height And Duration\n\n * Make sprite jump, with specific height and duration\n\n```sig\nRender.jumpWithHeightAndDuration()\n```\n\n\n## Parameters\n* **sprite**\n* **height** jump height in pixel\n* **duration** hover time span, unit: ms\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\ncontroller.B.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.jumpWithHeightAndDuration(Render.getRenderSpriteInstance(), 8, 500)\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/jump.md":"# jump\n\n * Make sprite jump, with specific speed and acceleration\n * Simular with Move block, but jump can only happened when sprite is standing, current height = its offset.\n\n```sig\nRender.jump()\n```\n\n\n## Parameters\n* **sprite**\n* **v** vetical speed, unit: pixel/s\n* **a** vetical acceleration, unit: pixel/sÂ²\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\ncontroller.B.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.jump(mySprite)\n    Render.jump(mySprite, 60, -200)\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/move.md":"# move\n\n * Make sprite jump, with specific speed and acceleration\n * Simular with jump block, but jump can only happened when sprite is standing, current height = its offset.\n\n```sig\nRender.move()\n```\n\n\n## Parameters\n* **sprite**\n* **v** vetical speed, unit: pixel/s\n* **a** vetical acceleration, unit: pixel/sÂ²\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\ncontroller.B.onEvent(ControllerButtonEvent.Pressed, function () {\n    Render.move(mySprite, 60, -200)\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/move-with-controller.md":"# move With Controller\n\n* Control the self sprite using the arrow buttons from the controller. \n* To stop controlling self sprite, pass 0 for v and va.\n\n```sig\nRender.moveWithController()\n```\n\n\n## Parameters\n * **v** The velocity used for forward/backword movement when up/down is pressed, in pixel/s\n * **va** The angle velocity used for turn view direction when left/right is pressed, in radian/s.\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nRender.moveWithController(2, 3)\n```\n\nFor disable moving control inside the extension:\n```blocks\nRender.moveWithController(0, 0)\ncontroller.moveSprite(Render.getRenderSpriteInstance(), 100, 100)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/takeover-scene-sprites.md":"# takeover Scene Sprites\n\n* Render takeover all sprites in current scene\n\n```sig\nRender.takeoverSceneSprites()\n```\n\n## ~hint\n* Render will call this automatically, so not required usually.\n* Call this just after created the sprite, only if you saw sprite draw at its tilemap position on screen\n## ~\n\n## Parameters\n* none\n\n## Returns\n\n* none\n\n## Example\n\n```blocks\nlet mySprite = sprites.create(img`\n    . . . . . . . . . . b 5 b . . . \n    . . . . . . . . . b 5 b . . . . \n    . . . . . . b b b b b b . . . . \n    . . . . . b b 5 5 5 5 5 b . . . \n    . . . . b b 5 d 1 f 5 d 4 c . . \n    . . . . b 5 5 1 f f d d 4 4 4 b \n    . . . . b 5 5 d f b 4 4 4 4 b . \n    . . . b d 5 5 5 5 4 4 4 4 b . . \n    . b b d d d 5 5 5 5 5 5 5 b . . \n    b d d d b b b 5 5 5 5 5 5 5 b . \n    c d d b 5 5 d c 5 5 5 5 5 5 b . \n    c b b d 5 d c d 5 5 5 5 5 5 b . \n    c b 5 5 b c d d 5 5 5 5 5 5 b . \n    b b c c c d d d 5 5 5 5 5 d b . \n    . . . . c c d d d 5 5 5 b b . . \n    . . . . . . c c c c c b b . . . \n    `, SpriteKind.Player)\nRender.takeoverSceneSprites()\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/register-on-sprite-direction-update-handler.md":"# register On Sprite Direction Update Handler\n\n* Run on sprite dirction updated, present view point to Sprite facing dirction, or which angle you see of the sprite.\n\n```sig\nRender.registerOnSpriteDirectionUpdateHandler()\n```\n\n## ~hint\n* Not required, if you have used the set animations block provided.\n* Used for working with other animation extensions, to set proper Image for sprite according to current seeing direction.\n## ~\n\n## Parameters\n  * **dir** It is a float number, 0 ~ 1 corresponds to 0 ~ 360Â°, suggest use Math.round(dir*dirAniTotalCount)%dirAniTotalCount to get index of direction\n## Returns\n\n* none\n\n## Example\n\n```blocks\nlet mySprite = sprites.create(img`\n    . . . . . . . . . . b 5 b . . . \n    . . . . . . . . . b 5 b . . . . \n    . . . . . . b b b b b b . . . . \n    . . . . . b b 5 5 5 5 5 b . . . \n    . . . . b b 5 d 1 f 5 d 4 c . . \n    . . . . b 5 5 1 f f d d 4 4 4 b \n    . . . . b 5 5 d f b 4 4 4 4 b . \n    . . . b d 5 5 5 5 4 4 4 4 b . . \n    . b b d d d 5 5 5 5 5 5 5 b . . \n    b d d d b b b 5 5 5 5 5 5 5 b . \n    c d d b 5 5 d c 5 5 5 5 5 5 b . \n    c b b d 5 d c d 5 5 5 5 5 5 b . \n    c b 5 5 b c d d 5 5 5 5 5 5 b . \n    b b c c c d d d 5 5 5 5 5 d b . \n    . . . . c c d d d 5 5 5 b b . . \n    . . . . . . c c c c c b b . . . \n    `, SpriteKind.Player)\nlet list = [\n    img`\n        . . . . . . f f f f . . . . . . \n        . . . . f f f 2 2 f f f . . . . \n        . . . f f f 2 2 2 2 f f f . . . \n        . . f f f e e e e e e f f f . . \n        . . f f e 2 2 2 2 2 2 e e f . . \n        . . f e 2 f f f f f f 2 e f . . \n        . . f f f f e e e e f f f f . . \n        . f f e f b f 4 4 f b f e f f . \n        . f e e 4 1 f d d f 1 4 e e f . \n        . . f e e d d d d d d e e f . . \n        . . . f e e 4 4 4 4 e e f . . . \n        . . e 4 f 2 2 2 2 2 2 f 4 e . . \n        . . 4 d f 2 2 2 2 2 2 f d 4 . . \n        . . 4 4 f 4 4 5 5 4 4 f 4 4 . . \n        . . . . . f f f f f f . . . . . \n        . . . . . f f . . f f . . . . . \n        `,\n    img`\n        . . . . . . . . . . . . . . . . \n        . . . . . . f f f f . . . . . . \n        . . . . f f f 2 2 f f f . . . . \n        . . . f f f 2 2 2 2 f f f . . . \n        . . f f f e e e e e e f f f . . \n        . . f f e 2 2 2 2 2 2 e e f . . \n        . f f e 2 f f f f f f 2 e f f . \n        . f f f f f e e e e f f f f f . \n        . . f e f b f 4 4 f b f e f . . \n        . . f e 4 1 f d d f 1 4 e f . . \n        . . . f e 4 d d d d 4 e f e . . \n        . . f e f 2 2 2 2 e d d 4 e . . \n        . . e 4 f 2 2 2 2 e d d e . . . \n        . . . . f 4 4 5 5 f e e . . . . \n        . . . . f f f f f f f . . . . . \n        . . . . f f f . . . . . . . . . \n        `,\n    img`\n        . . . . . . f f f f . . . . . . \n        . . . . f f f 2 2 f f f . . . . \n        . . . f f f 2 2 2 2 f f f . . . \n        . . f f f e e e e e e f f f . . \n        . . f f e 2 2 2 2 2 2 e e f . . \n        . . f e 2 f f f f f f 2 e f . . \n        . . f f f f e e e e f f f f . . \n        . f f e f b f 4 4 f b f e f f . \n        . f e e 4 1 f d d f 1 4 e e f . \n        . . f e e d d d d d d e e f . . \n        . . . f e e 4 4 4 4 e e f . . . \n        . . e 4 f 2 2 2 2 2 2 f 4 e . . \n        . . 4 d f 2 2 2 2 2 2 f d 4 . . \n        . . 4 4 f 4 4 5 5 4 4 f 4 4 . . \n        . . . . . f f f f f f . . . . . \n        . . . . . f f . . f f . . . . . \n        `,\n    img`\n        . . . . . . . . . . . . . . . . \n        . . . . . . f f f f . . . . . . \n        . . . . f f f 2 2 f f f . . . . \n        . . . f f f 2 2 2 2 f f f . . . \n        . . f f f e e e e e e f f f . . \n        . . f e e 2 2 2 2 2 2 e f f . . \n        . f f e 2 f f f f f f 2 e f f . \n        . f f f f f e e e e f f f f f . \n        . . f e f b f 4 4 f b f e f . . \n        . . f e 4 1 f d d f 1 4 e f . . \n        . . e f e 4 d d d d 4 e f . . . \n        . . e 4 d d e 2 2 2 2 f e f . . \n        . . . e d d e 2 2 2 2 f 4 e . . \n        . . . . e e f 5 5 4 4 f . . . . \n        . . . . . f f f f f f f . . . . \n        . . . . . . . . . f f f . . . . \n        `\n    ]\nRender.registerOnSpriteDirectionUpdateHandler(function (spr, dir) {\n    let FrameIndex = Math.round(dir * list.length) % list.length\n    mySprite.setImage(list[FrameIndex])\n})\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```\n","docs/get-sprite-attribute.md":"# get Sprite Attribute\n\n * Get arribute of a sprite\n\n```sig\nRender.getSpriteAttribute()\n```\n\n\n## Parameters\n* **RCSpriteAttribute**  \n## ~hint\n * **ZOffset**: make sprite float from ground, unit: pixel\n * **ZPosition**: current position in Z dimension, unit: pixel, modified by move() or jump(). Equal to ZOffset when stand still.\n * **ZVelocity**: Velocity for move/jump\n * **ZAcceleration**: Acceleration for move/jump\n## ~\n\n## Returns\n\n* value according to specific \n\n## Example\n\n```blocks\nlet mySprite=sprites.create(img`0`, SpriteKind.Player)\nlet v=Render.getSpriteAttribute(mySprite, RCSpriteAttribute.ZOffset)/2\nRender.setSpriteAttribute(mySprite, RCSpriteAttribute.ZOffset, v)\n)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","docs/set-sprite-attribute.md":"# set Sprite Attribute\n\n * Set arribute of a sprite\n\n```sig\nRender.setSpriteAttribute()\n```\n\n\n## Parameters\n* **spr**: a Sprite\n* **RCSpriteAttribute**:\n## ~hint\n * **ZOffset**: make sprite float from ground, unit: pixel\n * **ZPosition**: current position in Z dimension, unit: pixel, modified by move() or jump(). Equal to ZOffset when stand still.\n * **ZVelocity**: Velocity for move/jump\n * **ZAcceleration**: Acceleration for move/jump\n## ~\n\n## Returns\n\n* value according to specific \n\n## Example\n\n```blocks\nlet mySprite=sprites.create(img`0`, SpriteKind.Player)\nlet v=Render.getSpriteAttribute(mySprite, RCSpriteAttribute.ZOffset)/2\nRender.setSpriteAttribute(mySprite, RCSpriteAttribute.ZOffset, v)\n)\n```\n\n```package\npxt-raycasting=github:aqeeaqee/pxt-raycasting\n```","pxt.json":"{\n    \"name\": \"Isometric by AqeeAqee\",\n    \"version\": \"0.3.18\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"device\": \"*\"\n    },\n    \"files\": [\n        \"README.md\",\n        \"render_raycasting.ts\",\n        \"render_blocks.ts\",\n        \"animation.ts\",\n        \"docs/get-render-sprite-variable.md\",\n        \"docs/get-render-sprite-instance.md\",\n        \"docs/create-animations.md\",\n        \"docs/set-sprite-animations.md\",\n        \"docs/toggle-view-mode.md\",\n        \"docs/is-view-mode.md\",\n        \"docs/set-view-mode.md\",\n        \"docs/get-attribute.md\",\n        \"docs/set-attribute.md\",\n        \"docs/get-default-fov.md\",\n        \"docs/set-view-angle-in-degree.md\",\n        \"docs/set-view-angle.md\",\n        \"docs/set-z-offset.md\",\n        \"docs/is-sprites-overlap-z.md\",\n        \"docs/jump-with-height-and-duration.md\",\n        \"docs/jump.md\",\n        \"docs/move.md\",\n        \"docs/move-with-controller.md\",\n        \"docs/takeover-scene-sprites.md\",\n        \"docs/register-on-sprite-direction-update-handler.md\",\n        \"docs/get-sprite-attribute.md\",\n        \"docs/set-sprite-attribute.md\"\n    ],\n    \"testFiles\": [\n        \"main.ts\",\n        \"tilemap.g.jres\",\n        \"tilemap.g.ts\",\n        \"images.g.jres\",\n        \"images.g.ts\"\n    ],\n    \"targetVersions\": {\n        \"branch\": \"v0.14.3\",\n        \"tag\": \"v0.14.3\",\n        \"commits\": \"https://github.com/microsoft/pxt-arcade/commits/aef27bb278de89a83ecb6ab02af5319c06d617e2\",\n        \"target\": \"1.12.39\",\n        \"pxt\": \"5.21.6\",\n        \"targetId\": \"arcade\"\n    },\n    \"supportedTargets\": [\n        \"arcade\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n","main.ts":"        \ngame.stats = true\nconst rcRender = Render.raycastingRender\n// Render.moveWithController(1.5,2,1)\n\n// let trans16 = image.create(16, 16)\n\nRender.setSpriteAnimations(rcRender.sprSelf, Render.createAnimations(150, assets.animation`heroWalk`))\n\nconst tm = tiles.createTilemap(hex`200010000304050607010201020102010201020103040506070102010201020102010201010201020102010201020102010201020102010201020102010201020102010202010201020102010201020102010201020102010201020102010201020102010102010201020102010201020102010201020102010201020102010201020102020102010201020102010201020102010201020102010201020102010201020101020102010201020102010201020102010201020102010201020102010201020201020102010201020102010201020102010201020102010201020102010201010201020102010201020102010201020102010201020102010201020102010202010201020102010201020102010201020102010201020102010201020102010102010201020102010201020102010201020102010201020102010201020102020102010201020102010201020102010201020102010201020102010201020101020102010201020102010201020102010201020102010201020102010201020201020102010201020102010201020102010201020102010201020102010201010201020102010201020102010201020102010201020102010201020102010202010201020102010201020102010201020102010201020102010201020102010102010201020102010201020102010201020102010201020102010201020102`, img`\n    ................................\n    ................................\n    ................................\n    ...2222..2222......2222..2222...\n    ...2........2......2........2...\n    ...2........2......2........2...\n    ...2........2......2........2...\n    ................................\n    ................................\n    ...2........2......2........2...\n    ...2........2......2........2...\n    ...2........2......2........2...\n    ...2222..2222......2222..2222...\n    ................................\n    ................................\n    ................................\n`, [myTiles.transparency16,myTiles.tile3,myTiles.tile4,sprites.castle.tileGrass2,sprites.castle.tilePath5,sprites.vehicle.roadVertical,sprites.vehicle.roadHorizontal,sprites.dungeon.chestClosed], TileScale.Sixteen);\n// tiles.setCurrentTilemap(tm)\n// const spawnTile = myTiles.tile4\n\ntiles.setCurrentTilemap(tilemap`level1`)\nconst spawnTile = sprites.castle.tileDarkGrass3\n\nconst tilemapScale = 1 << game.currentScene().tileMap.scale\nconsole.log(tilemapScale)\nrcRender.sprSelf.setPosition(8 * tilemapScale, 8 * tilemapScale)\n\neffects.blizzard.startScreenEffect(Infinity,1023)\n\nlet count = 0\nfunction createSprite(x: number, y: number, vx: number, vy: number, textures: Image[][], kind: number) {\n    const spr = sprites.create(textures[0][0], kind)\n    // rcRender.takeoverSceneSprites()\n    const tilemapScale = 1 << game.currentScene().tileMap.scale\n    spr.setPosition(x * tilemapScale, y * tilemapScale)\n    spr.setVelocity(vx, vy)\n    spr.setBounceOnWall(true)\n    spr.setScale(0.5)\n    // setCharacterAnimationForSprite(spr, textures)\n    Render.setSpriteAnimations(spr, Render.createAnimations(150, textures[0], textures[1], textures[2], textures[3]))\n    // if (kind == SpriteKind.Enemy)\n    //     tiles.placeOnRandomTile(spr, trans16)\n    spr.sayText(spr.id + \" test\\n test\", 9999)\n    // spr.startEffect(effects.fountain,9999)\n\n    return spr\n}\n\n// 0<= dir <1, then may be added by 2 for avoid negative\n// rcRender.registerOnSpriteDirectionUpdate((spr, dir) => {\n//     // character.setCharacterState(spr, character.rule(characterAniDirs[Math.floor(dir * 4 + .5) % 4]))\n// })\n\n// createSprite(8, 7, 6, 10, texturesDuck, SpriteKind.Enemy)\n// createSprite(6, 7, 6, 10, texturesDonut, SpriteKind.Enemy)\n// createSprite(5, 8, 6, 10, texturesDog, SpriteKind.Enemy)\nlet sprPriness2 = createSprite(11, 8, 6, 10, texturesPrincess2, SpriteKind.Enemy)\n// let sprHero = createSprite(10, 8, 6, 10, texturesHero, SpriteKind.Enemy)\nlet sprSkelly = createSprite(9, 9, 6, 10, texturesSkelly, SpriteKind.Enemy)\nlet sprPriness = createSprite(10, 7, 6, 10, texturesPrincess, SpriteKind.Enemy)\nlet sprPlane = createSprite(9, 7, 6, 10, texturesPlane, SpriteKind.Enemy)\n// let cake = createSprite(2, 2, 4, 2, texturesBigCake, SpriteKind.Enemy)\nlet fish = createSprite(7, 9, 0, 0, texturesFish, SpriteKind.Enemy)\n\nsprSkelly.startEffect(effects.fire, 9999999)\n\nRender.setSpriteAttribute(sprSkelly, RCSpriteAttribute.ZOffset, 4)\nRender.setSpriteAttribute(sprPlane, RCSpriteAttribute.ZOffset, 16)\n// Render.setSpriteAttribute(cake, RCSpriteAttribute.ZOffset, 4)\nRender.setSpriteAttribute(fish, RCSpriteAttribute.ZOffset, 8)\n\nfunction createCoin(){\n    let spr=createSprite(4, 7, Math.randomRange(5,10), Math.randomRange(3,10), texturesCoin, SpriteKind.Food)\n    tiles.placeOnRandomTile(spr, spawnTile)\n    rcRender.setZOffset(spr,.25)\n}\n\n//test for RelativeToCamera\n// game.onUpdateInterval(3000, ()=>{\n//     cake.setFlag(SpriteFlag.RelativeToCamera, !(cake.flags&SpriteFlag.RelativeToCamera))\n// })\n\ncontroller.A.onEvent(ControllerButtonEvent.Pressed, () => {\n    music.pewPew.play()\n    let s = sprites.createProjectileFromSprite(sprites.projectile.bubble1, rcRender.sprSelf, rcRender.dirX * 55, rcRender.dirY * 55)\n    s.setScale(0.25)\n    rcRender.setZOffset(s, rcRender.getMotionZPosition(rcRender.sprSelf) + 2)  //todo, use VP height\n})\n\nsprites.onOverlap(SpriteKind.Enemy, SpriteKind.Projectile, function (sprite, otherSprite) {\n    if (!rcRender.isOverlapZ(sprite, otherSprite)) return\n\n    sprite.setVelocity(0, 0)\n    sprite.sayText(\"No!\", 2000)\n    rcRender.move(sprite, 60, -160)\n    // rcRender.setZOffset(sprite, 0)\n    music.baDing.play()\n    // sprite.setKind(SpriteKind.Food)\n    otherSprite.destroy()\n    // Render.setSpriteAnimations(sprite, new Render.Animations(120, texturesCoin))\n    // sprite.setImage(sprites.builtin.coin0)\n    sprite.setScale(.5)\n    sprite.startEffect(effects.fire, 3000)\n    // tiles.placeOnRandomTile(sprite, spawnTile)\n    // sprite.setVelocity(Math.randomRange(4,10), Math.randomRange(4,10))\n    createCoin()\n    // game.showLongText(sprite.id+\" \"+otherSprite.id, DialogLayout.Bottom)\n})\n\nsprites.onOverlap(SpriteKind.Enemy, SpriteKind.Food, function (sprite, otherSprite) {\n    // music.pewPew.play()\n    // otherSprite.destroy()\n})\nsprites.onOverlap(SpriteKind.Enemy, SpriteKind.Enemy, function (sprite, otherSprite) {\n    if (!rcRender.isOverlapZ(sprite, otherSprite)) return\n\n    otherSprite.setVelocity(otherSprite.x - sprite.x, otherSprite.y - sprite.y)\n    sprite.setVelocity(-(otherSprite.x - sprite.x), -(otherSprite.y - sprite.y))\n})\n\nsprites.onOverlap(SpriteKind.Player, SpriteKind.Enemy, function (sprite, otherSprite) {\n    if (!rcRender.isOverlapZ(sprite, otherSprite)) return\n\n})\n\nsprites.onOverlap(SpriteKind.Player, SpriteKind.Food, function (sprite, otherSprite) {\n    if (!rcRender.isOverlapZ(sprite, otherSprite)) return\n\n    music.baDing.play()\n    info.changeScoreBy(1)\n\n    // tiles.placeOnRandomTile(otherSprite, sprites.skillmap.islandTile4)\n    // otherSprite.setVelocity(Math.randomRange(4, 10), Math.randomRange(4, 10))\n    otherSprite.destroy()\n})\n\ncontroller.menu.onEvent(ControllerButtonEvent.Pressed, () => {\n    Render.toggleViewMode()\n})\n\n\n\ncontroller.B.repeatDelay = 0\n\nlet isAdjusting = false\ncontroller.anyButton.onEvent(ControllerButtonEvent.Pressed, () => {\n    if (controller.B.isPressed()) {\n        if (controller.A.isPressed()) {\n            Render.moveWithController(0, 0)\n            isAdjusting = true\n        } else {\n            rcRender.jumpWithHeightAndDuration(rcRender.sprSelf, tilemapScale*2, 5000)\n        }\n    }\n})\ncontroller.B.onEvent(ControllerButtonEvent.Released, () => {\n    isAdjusting = false\n    Render.moveWithController(1.5, 2)\n})\ncontroller.A.onEvent(ControllerButtonEvent.Released, () => {\n    isAdjusting = false\n    Render.moveWithController(1.5, 2)\n})\n\ncontroller.up.onEvent(ControllerButtonEvent.Pressed, () => {\n    if (isAdjusting)\n    Render.changeScaleY(1)\n})\ncontroller.down.onEvent(ControllerButtonEvent.Pressed, () => {\n    if (isAdjusting)\n    Render.changeScaleY(-1)\n})\ncontroller.left.onEvent(ControllerButtonEvent.Pressed, () => {\n    if (isAdjusting)\n    Render.changeScale(-1)\n})\ncontroller.right.onEvent(ControllerButtonEvent.Pressed, () => {\n    if (isAdjusting)\n    Render.changeScale(1)\n})\n\n\nrcRender.wallZScale = 2\n\nlet zOffset = 3// tilemapScale / 2\n// rcRender.setZOffset(rcRender.sprSelf, zOffset, 0)\nlet fov = Render.defaultFov\ngame.onUpdate(() => {\n    if (false&&isAdjusting) {\n        // zOffset -= controller.dy(10)\n        // rcRender.setZOffset(rcRender.sprSelf, zOffset, 0)\n        fov -= controller.dy(1)\n        Render.setAttribute(Render.attribute.fov, fov)\n        info.setScore(zOffset * 100)\n    }\n})\n\n\n// controller.B.onEvent(ControllerButtonEvent.Pressed, () => {\n//     for (let fov = Render.defaultFov; fov > Render.defaultFov - .6; fov -= .06) {\n//         rcRender.fov=fov\n//         pause(20)\n//     }\n// })\n// controller.B.onEvent(ControllerButtonEvent.Released, () => {\n//     for (let fov = Render.defaultFov - .6; fov <= Render.defaultFov; fov += .06) {\n//         rcRender.fov=fov\n//         pause(20)\n//     }\n// })\n\n\n// const characterAniDirs = [Predicate.MovingLeft, Predicate.MovingDown, Predicate.MovingRight, Predicate.MovingUp]\n// function setCharacterAnimationForSprite(spr: Sprite, textures: Image[][]) {\n//     characterAniDirs.forEach((dir, i) => {\n//         character.loopFrames(spr, textures[Math.floor(i * textures.length / characterAniDirs.length)], 150, character.rule(dir))\n//     })\n// }\n// info.setScore(0)\ninfo.setLife(3)\n// let mySprite = sprites.create(sprites.builtin.computer1, SpriteKind.Player)\n// mySprite.setPosition(80,10)\n// mySprite.setFlag(SpriteFlag.RelativeToCamera, true)\n\n\n","tilemap.g.jres":"{\n    \"transparency16\": {\n        \"data\": \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true\n    },\n    \"tile1\": {\n        \"data\": \"hwQQABAAAAAhUyFTIVMhUzIVMhUyFTIVUyFTIVMhUyEVMhUyFTIVMiFTIVMhUyFTMhUyFTIVMhVTIVMhUyFTIRUyFTIVMhUyIVMhUyFTIVMyFTIVMhUyFVMhUyFTIVMhFTIVMhUyFTIhUyFTIVMhUzIVMhUyFTIVUyFTIVMhUyEVMhUyFTIVMg==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"myTile\"\n    },\n    \"tile2\": {\n        \"data\": \"hwQQABAAAADdHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHd0d3R3dHQ==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"myTile0\"\n    },\n    \"tile3\": {\n        \"data\": \"hwQQABAAAABmZmZmZmZmZjYzMzMzMzNjNjMzMzMzM2M2MzMzMzMzYzYzMzMzMzNjNjMzMzMzM2M2MzMzMzMzYzYzMzMzMzNjNjMzMzMzM2M2MzMzMzMzYzYzMzMzMzNjNjMzMzMzM2M2MzMzMzMzYzYzMzMzMzNjNjMzMzMzM2NmZmZmZmZmZg==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"myTile1\"\n    },\n    \"tile4\": {\n        \"data\": \"hwQQABAAAAC7u7u7u7u7u3t3d3d3d3e3e3d3d3d3d7d7d3d3d3d3t3t3d3d3d3e3e3d3d3d3d7d7d3d3d3d3t3t3d3d3d3e3e3d3d3d3d7d7d3d3d3d3t3t3d3d3d3e3e3d3d3d3d7d7d3d3d3d3t3t3d3d3d3e3e3d3d3d3d7e7u7u7u7u7uw==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"myTile2\"\n    },\n    \"tile5\": {\n        \"data\": \"hwQQABAAAAARERERERERkQEAAAAAAACQAQABAAAAAJABEAAAAAAAkAEBAAAAAACQAQAAAAAAAJABAAAAAAAAkAEAAAAAAACQAQAAAAAAAJABAAAAAAAAkAEAAAAAAACQAQAAAAAAAJABAAAAAACQkAEAAAAAAAmQAQAAAAAAAJCZmZmZmZmZmQ==\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"tilemapTile\": true,\n        \"displayName\": \"myTile3\"\n    },\n    \"level1\": {\n        \"id\": \"level1\",\n        \"mimeType\": \"application/mkcd-tilemap\",\n        \"data\": \"MTAyMDAwMTAwMDAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwMTAxMDkwOTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwOTAxMDEwOTA1MDIwMjAyMDIwNDA0MDIwMjAyMDIwNjA5MDEwMTA5MDUwMjAyMDIwMjA0MDQwMjAyMDIwMjA2MDkwMTAxMDkwMzA5MDkwOTA5MDMwMzA5MDkwOTA5MDMwOTAxMDEwOTAzMDkwOTA5MDkwMzAzMDkwOTA5MDkwMzA5MDEwMTA5MDMwOTBiMGIwYjAzMDMwYjBiMGIwOTAzMDkwMTAxMDkwMzA5MGIwYjBiMDMwMzBiMGIwYjA5MDMwOTAxMDEwOTAzMDkwYjA5MDkwMzAzMDkwOTBiMDkwMzA5MDEwMTA5MDMwOTBiMDkwOTAzMDMwOTA5MGIwOTAzMDkwMTAxMDkwMzA5MGIwOTBhMDMwMzBhMDkwYjA5MDMwOTAxMDEwOTAzMDkwYjA5MGEwMzAzMGEwOTBiMDkwMzA5MDEwMTA5MDgwMjAyMDIwMjA3MDgwMjAyMDIwMjA3MDkwMTAxMDkwODAyMDIwMjAyMDcwODAyMDIwMjAyMDcwOTAxMDEwOTA1MDIwMjAyMDIwNjA1MDIwMjAyMDIwNjA5MDEwMTA5MDUwMjAyMDIwMjA2MDUwMjAyMDIwMjA2MDkwMTAxMDkwMzA5MGIwOTBhMDMwMzBhMDkwYjA5MDMwOTAxMDEwOTAzMDkwYjA5MGEwMzAzMGEwOTBiMDkwMzA5MDEwMTA5MDMwOTBiMDkwOTAzMDMwOTA5MGIwOTAzMDkwMTAxMDkwMzA5MGIwOTA5MDMwMzA5MDkwYjA5MDMwOTAxMDEwOTAzMDkwYjBiMGIwMzAzMGIwYjBiMDkwMzA5MDEwMTA5MDMwOTBiMGIwYjAzMDMwYjBiMGIwOTAzMDkwMTAxMDkwMzA5MDkwOTA5MDMwMzA5MDkwOTA5MDMwOTAxMDEwOTAzMDkwOTA5MDkwMzAzMDkwOTA5MDkwMzA5MDEwMTA5MDgwMjAyMDIwMjA3MDgwMjAyMDIwMjA3MDkwMTAxMDkwODAyMDIwMjAyMDcwODAyMDIwMjAyMDcwOTAxMDEwOTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwOTA5MDEwMTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwOTA5MDkwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEwMTAxMDEyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjAyMDAwMDAwMDAwMDAwMjAwMjAwMDAwMDAwMDAwMDIwMDIwMDAwMDAwMDAwMDAyMDAyMDAwMDAwMDAwMDAwMjAwMjAwMDAwMDAwMDAwMDIwMDIwMDAwMDAwMDAwMDAyMDAyMDAyMjAyMjAyMjAwMjAwMjAwMjIwMjIwMjIwMDIwMDIwMDAyMDAwMDIwMDAyMDAyMDAwMjAwMDAyMDAwMjAwMjAwMDIwMjIwMjAwMDIwMDIwMDAyMDIyMDIwMDAyMDAyMDAwMDAwMDAwMDAwMjAwMjAwMDAwMDAwMDAwMDIwMDIwMDAwMDAwMDAwMDAyMDAyMDAwMDAwMDAwMDAwMjAwMjAwMDIwMjIwMjAwMDIwMDIwMDAyMDIyMDIwMDAyMDAyMDAwMjAwMDAyMDAwMjAwMjAwMDIwMDAwMjAwMDIwMDIwMDIyMDIyMDIyMDAyMDAyMDAyMjAyMjAyMjAwMjAwMjAwMDAwMDAwMDAwMDIwMDIwMDAwMDAwMDAwMDAyMDAyMDAwMDAwMDAwMDAwMjAwMjAwMDAwMDAwMDAwMDIwMDIwMDAwMDAwMDAwMDAyMDAyMDAwMDAwMDAwMDAwMjAyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMg==\",\n        \"tileset\": [\n            \"myTiles.transparency16\",\n            \"sprites.builtin.brick\",\n            \"sprites.vehicle.roadHorizontal\",\n            \"sprites.vehicle.roadVertical\",\n            \"sprites.vehicle.roadIntersection3\",\n            \"sprites.vehicle.roadTurn1\",\n            \"sprites.vehicle.roadTurn2\",\n            \"sprites.vehicle.roadTurn4\",\n            \"sprites.vehicle.roadTurn3\",\n            \"sprites.castle.tileDarkGrass3\",\n            \"sprites.castle.shrub\",\n            \"myTiles.tile5\"\n        ],\n        \"displayName\": \"level1\"\n    },\n    \"*\": {\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"dataEncoding\": \"base64\",\n        \"namespace\": \"myTiles\"\n    }\n}","tilemap.g.ts":"// Auto-generated code. Do not edit.\nnamespace myTiles {\n    //% fixedInstance jres blockIdentity=images._tile\n    export const transparency16 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile1 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile2 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile3 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile4 = image.ofBuffer(hex``);\n    //% fixedInstance jres blockIdentity=images._tile\n    export const tile5 = image.ofBuffer(hex``);\n\n    helpers._registerFactory(\"tilemap\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"level1\":\n            case \"level1\":return tiles.createTilemap(hex`200010000101010101010101010101010101010101010101010101010101010101010101010909090909090909090909090909010109090909090909090909090909090101090502020202040402020202060901010905020202020404020202020609010109030909090903030909090903090101090309090909030309090909030901010903090b0b0b03030b0b0b09030901010903090b0b0b03030b0b0b09030901010903090b0909030309090b09030901010903090b0909030309090b09030901010903090b090a03030a090b09030901010903090b090a03030a090b0903090101090802020202070802020202070901010908020202020708020202020709010109050202020206050202020206090101090502020202060502020202060901010903090b090a03030a090b09030901010903090b090a03030a090b09030901010903090b0909030309090b09030901010903090b0909030309090b09030901010903090b0b0b03030b0b0b09030901010903090b0b0b03030b0b0b090309010109030909090903030909090903090101090309090909030309090909030901010908020202020708020202020709010109080202020207080202020207090101090909090909090909090909090901010909090909090909090909090909010101010101010101010101010101010101010101010101010101010101010101`, img`\n22222222222222222222222222222222\n2..............22..............2\n2..............22..............2\n2..............22..............2\n2...222..222...22...222..222...2\n2...2......2...22...2......2...2\n2...2.2..2.2...22...2.2..2.2...2\n2..............22..............2\n2..............22..............2\n2...2.2..2.2...22...2.2..2.2...2\n2...2......2...22...2......2...2\n2...222..222...22...222..222...2\n2..............22..............2\n2..............22..............2\n2..............22..............2\n22222222222222222222222222222222\n`, [myTiles.transparency16,sprites.builtin.brick,sprites.vehicle.roadHorizontal,sprites.vehicle.roadVertical,sprites.vehicle.roadIntersection3,sprites.vehicle.roadTurn1,sprites.vehicle.roadTurn2,sprites.vehicle.roadTurn4,sprites.vehicle.roadTurn3,sprites.castle.tileDarkGrass3,sprites.castle.shrub,myTiles.tile5], TileScale.Sixteen);\n        }\n        return null;\n    })\n\n    helpers._registerFactory(\"tile\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"transparency16\":return transparency16;\n            case \"myTile\":\n            case \"tile1\":return tile1;\n            case \"myTile0\":\n            case \"tile2\":return tile2;\n            case \"myTile1\":\n            case \"tile3\":return tile3;\n            case \"myTile2\":\n            case \"tile4\":return tile4;\n            case \"myTile3\":\n            case \"tile5\":return tile5;\n        }\n        return null;\n    })\n\n}\n// Auto-generated code. Do not edit.\n","images.g.jres":"{\n    \"image1\": {\n        \"data\": \"hwRAACAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAABXBwAAAAAAAAAAAAAAAAAAVwcAAAAAAAAAAAAAAAAAUHd3AAAAAAAAAAAAAAAAAFB3dwAAAAAAAAAAAAAAAABXd3cHAAAAAAAAAAAAAAAAV3d3BwAAAAAAAAAAAAAAcHd3d3cAAAAAAAAAAAAAAHB3d3d3AAAAAAAAAAAAAAB3d3FzcQcAAAAAAAAAAAAAd3dxc3EHAAAAAAAAAAAAcHcXERPRdwAAAAAAAAAAAHB3FxET0XcAAAAAAAAAAAB3dxcRFtF2BwAAAAAAAAAAd3cXERbRdgcAAAAAAAAAcHd3N2F2MXZ3AAAAAAAAAHB3dzdhdjF2dwAAAAAAAAB3d3c3YXcxdncHAAAAAAAAd3d3N2F3MXZ3BwAAAAAAcHd3dxcRF9F2d3cAAAAAAHB3d3cXERfRdnd3AAAAAAB3d3d3Fx0T3Xd3dwcAAAAAd3d3dxcdE913d3cHAAAAcHd3V3d3bWN9dxcXdwAAAHB3d1d3d21jfXcXF3cAAAB3d3dXdXdnZ3d3Fxd2BwAAd3d3V3V3Z2d3dxcXdgcAcBcXd3dld3d3d3cXF3Z3AHAXF3d3ZXd3d3d3Fxd2dwB3Fxd2d2d3d3FxdxcWd3cHdxcXdndnd3dxcXcXFnd3B3cXF3Z3d3d3cWF3d3Z3dwd3Fxd2d3d3d3Fhd3d2d3cHcBcWd3d1dXdxYXd3d3d1AHAXFnd3dXV3cWF3d3d3dQAAd3Z3d1VVd2Fxd3d3dwUAAHd2d3dVVXdhcXd3d3cFAABwd3d3VlZ3Z3d3d3d3AAAAcHd3d1ZWd2d3d3d3dwAAAAB3d3d2dnd3d3d3dwcAAAAAd3d3dnZ3d3d3d3cHAAAAAHB3d3dxc3F3d3d3AAAAAABwd3d3cXNxd3d3dwAAAAAAAHd3FxET0Xd3dwcAAAAAAAB3dxcRE9F3d3cHAAAAAAAAcHcXERbRdnd3AAAAAAAAAHB3FxEW0XZ3dwAAAAAAAAAAdzdhdjF2dwcAAAAAAAAAAHc3YXYxdncHAAAAAAAAAABwN2F3MXZ3AAAAAAAAAAAAcDdhdzF2dwAAAAAAAAAAAAAXERfRdgcAAAAAAAAAAAAAFxEX0XYHAAAAAAAAAAAAABAdE913AAAAAAAAAAAAAAAQHRPddwAAAAAAAAAAAAAAAG1jfQcAAAAAAAAAAAAAAABtY30HAAAAAAAAAAAAAAAAYGd3AAAAAAAAAAAAAAAAAGBndwAAAAAAAAAAAAAAAAAAdwcAAAAAAAAAAAAAAAAAAHcHAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAA\",\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"displayName\": \"shearDoubleX_reference\"\n    },\n    \"anim1\": {\n        \"namespace\": \"myAnimations\",\n        \"id\": \"anim1\",\n        \"mimeType\": \"application/mkcd-animation\",\n        \"data\": \"YzgwMDEwMDAxMDAwMDQwMDAwMDAwMGZmZmYwMDAwMDAwMDAwZmZlZWVlZmYwMDAwMDBmMGVlZmVlZmVlMGYwMDAwZmZmZjJmZjJmZmZmMDAwMGZmMmUyZWUyZTJmZjAwMDBlZmYyZjIyZjJmZmUwMDAwZmYyZmUyMmVmMmZmMDBmMGVmMmZlZmZlZjJmZTBmZjBlZWZmZWVlZWVmZWUwZjAwZWZlZWVlZWVlZWZlMDAwMGYwZWVlZWVlZWUwZjAwMDA0ZWZmZmZmZmZmZTQwMDAwZDQyZjIyMjJmMjRkMDAwMDQ0NGY0NDQ0ZjQ0NDAwMDAwMGYwZmZmZjBmMDAwMDAwMDBmMDBmZjAwZjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwZmZmZjAwMDAwMDAwMDBmZmVlZWVmZjAwMDAwMGYwZWVmZWVmZWUwZjAwMDBmMGZmMmZmMmZmMGYwMDAwZmYyZTJlZTJlMmZmMDAwMGVmZjJmMmZmZjJmZTAwMDBmZjJmZWYyZWYyZmYwMDAwZWZmMmVmMmVlZmZlMDBmMGVmZmZlZWZlZWVmZTBmZjBlZmVlZWVlZWVlZmUwZjAwZjBlZWVlZWVlZTBmMDAwMGUwZmZmZmZmZmZlNDAwMDA0MDJmMjIyMmRlNGQwMDAwZTBmZmZmZmZlZTA0MDAwMDAwZmYwZjAwMDAwMDAwMDAwMDAwZmZmZjAwMDAwMDAwMDBmZmVlZWVmZjAwMDAwMGYwZWVmZWVmZWUwZjAwMDBmZmZmMmZmMmZmZmYwMDAwZmYyZTJlZTJlMmZmMDAwMGVmZjJmMjJmMmZmZTAwMDBmZjJmZTIyZWYyZmYwMGYwZWYyZmVmZmVmMmZlMGZmMGVlZmZlZWVlZWZlZTBmMDBlZmVlZWVlZWVlZmUwMDAwZjBlZWVlZWVlZTBmMDAwMDRlZmZmZmZmZmZlNDAwMDBkNDJmMjIyMmYyNGQwMDAwNDQ0ZjQ0NDRmNDQ0MDAwMDAwZjBmZmZmMGYwMDAwMDAwMGYwMGZmMDBmMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBmZmZmMDAwMDAwMDAwMGZmZWVlZWZmMDAwMDAwZjBlZWZlZWZlZTBmMDAwMGYwZmYyZmYyZmYwZjAwMDBmZjJlMmVlMmUyZmYwMDAwZWYyZmZmMmYyZmZlMDAwMGZmMmZlMmZlZjJmZjAwMDBlZmZlZTJmZTJmZmUwMGYwZWZlZWVmZWVmZmZlMGZmMGVmZWVlZWVlZWVmZTBmMDBmMGVlZWVlZWVlMGYwMDAwNGVmZmZmZmZmZjBlMDAwMGQ0ZWQyMjIyZjIwNDAwMDA0MGVlZmZmZmZmMGUwMDAwMDAwMDAwZjBmZjAwMDA=\",\n        \"displayName\": \"heroWalk\"\n    },\n    \"*\": {\n        \"mimeType\": \"image/x-mkcd-f4\",\n        \"dataEncoding\": \"base64\",\n        \"namespace\": \"myImages\"\n    }\n}","images.g.ts":"// Auto-generated code. Do not edit.\nnamespace myImages {\n\n    helpers._registerFactory(\"image\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"image1\":\n            case \"shearDoubleX_reference\":return img`\n..............................7777..............................\n............................77777777............................\n..........................777777777777..........................\n........................7777111111117777........................\n......................77777777777766667777......................\n....................777777771111111177777777....................\n..................7777777777776666777777777777..................\n................77777777777777777777777777777777................\n..............777777777777777777777777777777777777..............\n............7777777777775555777777777777777777777777............\n..........77777777777777775555777755556666777777777777..........\n........777777777777777777776666777755557777111133331111........\n......777777777777777777777777777755556666111111111111dddd......\n....55557777111133331111777777777777555577771111666611116666....\n..77777777111111111111dddd777777777777777733336666777733337777..\n5555777777771111666611116666777777777777777711117777111166667777\n..7777777733336666777733337777111111117777111111111111dddd7777..\n....7777777711117777111166667777777766667777dddd3333dddd7777....\n......7777111111111111dddd77771111111177777777666666667777......\n........7777dddd3333dddd77777777666677777777777777777777........\n..........77776666666677777777777777777777777777777777..........\n............7777777777777777777777777777777777777777............\n..............777777777777777777777777777777777777..............\n................77777777111111117777777777777777................\n..................7777777777776666777777777777..................\n....................777711111111777777777777....................\n......................77776666777777777777......................\n........................7777777777777777........................\n..........................777777775555..........................\n............................77777777............................\n..............................7777..............................\n................................................................\n`;\n        }\n        return null;\n    })\n\n    helpers._registerFactory(\"animation\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n            case \"heroWalk\":\n            case \"anim1\":return [img`\n. . . . . . f f f f . . . . . . \n. . . . f f e e e e f f . . . . \n. . . f e e e f f e e e f . . . \n. . f f f f f 2 2 f f f f f . . \n. . f f e 2 e 2 2 e 2 e f f . . \n. . f e 2 f 2 f f 2 f 2 e f . . \n. . f f f 2 2 e e 2 2 f f f . . \n. f f e f 2 f e e f 2 f e f f . \n. f e e f f e e e e f e e e f . \n. . f e e e e e e e e e e f . . \n. . . f e e e e e e e e f . . . \n. . e 4 f f f f f f f f 4 e . . \n. . 4 d f 2 2 2 2 2 2 f d 4 . . \n. . 4 4 f 4 4 4 4 4 4 f 4 4 . . \n. . . . . f f f f f f . . . . . \n. . . . . f f . . f f . . . . . \n`, img`\n. . . . . . . . . . . . . . . . \n. . . . . . f f f f . . . . . . \n. . . . f f e e e e f f . . . . \n. . . f e e e f f e e e f . . . \n. . . f f f f 2 2 f f f f . . . \n. . f f e 2 e 2 2 e 2 e f f . . \n. . f e 2 f 2 f f f 2 f e f . . \n. . f f f 2 f e e 2 2 f f f . . \n. . f e 2 f f e e 2 f e e f . . \n. f f e f f e e e f e e e f f . \n. f f e e e e e e e e e e f f . \n. . . f e e e e e e e e f . . . \n. . . e f f f f f f f f 4 e . . \n. . . 4 f 2 2 2 2 2 e d d 4 . . \n. . . e f f f f f f e e 4 . . . \n. . . . f f f . . . . . . . . . \n`, img`\n. . . . . . f f f f . . . . . . \n. . . . f f e e e e f f . . . . \n. . . f e e e f f e e e f . . . \n. . f f f f f 2 2 f f f f f . . \n. . f f e 2 e 2 2 e 2 e f f . . \n. . f e 2 f 2 f f 2 f 2 e f . . \n. . f f f 2 2 e e 2 2 f f f . . \n. f f e f 2 f e e f 2 f e f f . \n. f e e f f e e e e f e e e f . \n. . f e e e e e e e e e e f . . \n. . . f e e e e e e e e f . . . \n. . e 4 f f f f f f f f 4 e . . \n. . 4 d f 2 2 2 2 2 2 f d 4 . . \n. . 4 4 f 4 4 4 4 4 4 f 4 4 . . \n. . . . . f f f f f f . . . . . \n. . . . . f f . . f f . . . . . \n`, img`\n. . . . . . . . . . . . . . . . \n. . . . . . f f f f . . . . . . \n. . . . f f e e e e f f . . . . \n. . . f e e e f f e e e f . . . \n. . . f f f f 2 2 f f f f . . . \n. . f f e 2 e 2 2 e 2 e f f . . \n. . f e f 2 f f f 2 f 2 e f . . \n. . f f f 2 2 e e f 2 f f f . . \n. . f e e f 2 e e f f 2 e f . . \n. f f e e e f e e e f f e f f . \n. f f e e e e e e e e e e f f . \n. . . f e e e e e e e e f . . . \n. . e 4 f f f f f f f f e . . . \n. . 4 d d e 2 2 2 2 2 f 4 . . . \n. . . 4 e e f f f f f f e . . . \n. . . . . . . . . f f f . . . . \n`];\n        }\n        return null;\n    })\n\n    helpers._registerFactory(\"song\", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n\n        }\n        return null;\n    })\n\n}\n// Auto-generated code. Do not edit.\n"}}],"shares":[{"id":"22373-56334-00183-45617","timestamp":1762280614624}],"lastSaveTime":1762282934647}